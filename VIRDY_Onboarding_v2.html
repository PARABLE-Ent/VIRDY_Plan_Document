<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIRDY 기획 문서</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.7;
            color: #2c3e50;
            background: #f8f9fa;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* 좌측 사이드바 */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #1a252f 0%, #2c3e50 100%);
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .sidebar-header {
            padding: 30px 25px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header h1 {
            font-size: 23px;
            font-weight: 800;
            color: #3498db;
            margin-bottom: 5px;
        }

        .sidebar-header .subtitle {
            font-size: 14px;
            color: #95a5a6;
        }

        .sidebar-header .meta {
            margin-top: 15px;
            font-size: 12px;
            color: #7f8c8d;
        }

        /* 검색창 스타일 */
        .search-container {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .search-input-wrapper {
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 12px 15px 12px 40px;
            border: none;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.2s;
        }

        .search-input::placeholder {
            color: #95a5a6;
        }

        .search-input:focus {
            background: rgba(255,255,255,0.15);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.5);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #95a5a6;
            font-size: 16px;
        }

        .search-clear {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            font-size: 16px;
            display: none;
        }

        .search-clear:hover {
            color: #fff;
        }

        /* 검색 결과 스타일 */
        .search-results {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 10px;
            display: none;
        }

        .search-results.active {
            display: block;
        }

        .search-result-item {
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 4px;
        }

        .search-result-item:hover {
            background: rgba(52, 152, 219, 0.2);
        }

        .search-result-title {
            color: #3498db;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .search-result-preview {
            color: #bdc3c7;
            font-size: 12px;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .search-result-preview mark {
            background: rgba(52, 152, 219, 0.4);
            color: white;
            padding: 0 2px;
            border-radius: 2px;
        }

        .search-no-results {
            color: #95a5a6;
            font-size: 13px;
            padding: 15px;
            text-align: center;
        }

        .search-result-count {
            color: #7f8c8d;
            font-size: 12px;
            padding: 8px 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 5px;
        }

        .nav-category {
            padding: 18px 25px 8px;
            font-weight: 700;
            font-size: 13px;
            color: #ecf0f1;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-list {
            list-style: none;
            padding: 0 15px 15px;
        }

        .nav-list li {
            margin: 2px 0;
        }

        .nav-list a {
            display: block;
            padding: 10px 15px;
            color: #bdc3c7;
            text-decoration: none;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.2s ease;
        }

        .nav-list a:hover {
            background: rgba(52, 152, 219, 0.2);
            color: #fff;
            padding-left: 20px;
        }

        .nav-list a.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            font-weight: 600;
        }

        /* 메인 콘텐츠 영역 */
        .main-wrapper {
            flex: 1;
            margin-left: 280px;
            display: flex;
            justify-content: center;
        }

        .content-area {
            display: flex;
            width: 100%;
            max-width: 1200px;
            padding: 40px 30px;
            gap: 30px;
        }

        .main-content {
            flex: 1;
            min-width: 0;
            max-width: 850px;
        }

        /* 우측 TOC */
        .toc-wrapper {
            width: 220px;
            flex-shrink: 0;
        }

        .toc {
            position: sticky;
            top: 30px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            max-height: calc(100vh - 60px);
            overflow-y: auto;
        }

        .toc-title {
            font-size: 14px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .toc ul {
            list-style: none;
            padding: 0;
        }

        .toc li {
            margin: 6px 0;
        }

        .toc a {
            color: #7f8c8d;
            text-decoration: none;
            font-size: 14px;
            display: block;
            padding: 6px 10px;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .toc a:hover {
            background: #f8f9fa;
            color: #3498db;
        }

        /* 페이지 콘텐츠 */
        .page-content {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .page-content.active {
            display: block;
        }

        /* 섹션 헤더 */
        .section-header {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 18px 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .section-header h2 {
            font-size: 21px;
            font-weight: 700;
            margin: 0;
            border: none;
            padding: 0;
            color: white;
        }

        /* 제목 스타일 */
        h1 {
            font-size: 29px;
            font-weight: 800;
            margin: 25px 0 15px;
            color: #1a252f;
        }

        h2 {
            font-size: 21px;
            font-weight: 700;
            margin: 35px 0 15px;
            color: #2c3e50;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            scroll-margin-top: 20px;
        }

        h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 28px 0 12px;
            color: #34495e;
        }

        h4 {
            font-size: 16px;
            font-weight: 600;
            margin: 22px 0 10px;
            color: #555;
        }

        p {
            margin: 12px 0;
            color: #555;
            font-size: 16px;
        }

        /* 테이블 */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.06);
        }

        th {
            background: #f8f9fa;
            color: #2c3e50;
            padding: 14px 15px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e9ecef;
        }

        td {
            padding: 13px 15px;
            border-bottom: 1px solid #e9ecef;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* 코드 */
        code {
            background: #f1f2f6;
            padding: 3px 8px;
            border-radius: 5px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            color: #e74c3c;
        }

        pre {
            background: #1a252f;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            margin: 20px 0;
            font-size: 14px;
            line-height: 1.5;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        /* 리스트 */
        ul, ol {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 10px 0;
            color: #555;
            font-size: 15px;
        }

        /* 중첩 리스트 */
        ul ul, ol ul {
            margin: 8px 0;
            padding-left: 22px;
        }

        ul ul li, ol ul li {
            margin: 6px 0;
            font-size: 14px;
        }

        /* 구분선 */
        hr {
            border: none;
            border-top: 2px solid #e9ecef;
            margin: 35px 0;
        }

        /* 강조 */
        strong {
            color: #2c3e50;
            font-weight: 600;
        }

        em {
            color: #555;
        }

        /* 인용구 (info-box 스타일) */
        blockquote {
            background: #e8f4fd;
            border-left: 4px solid #3498db;
            padding: 18px 22px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
            font-size: 15px;
        }

        blockquote strong {
            color: #2c3e50;
        }

        /* 뱃지 스타일 (상태 표시용) */
        .badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        /* 반응형 */
        @media (max-width: 1200px) {
            .toc-wrapper {
                display: none;
            }

            .content-area {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }

            .main-wrapper {
                margin-left: 0;
            }

            .content-area {
                padding: 20px 15px;
            }

            .page-content {
                padding: 25px 20px;
            }
        }

        /* 스크롤바 스타일 */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a1a1a1;
        }

        /* 프린트 스타일 */
        @media print {
            .sidebar, .toc-wrapper {
                display: none;
            }
            .main-wrapper {
                margin-left: 0;
            }
            .page-content {
                box-shadow: none;
            }
        }
    </style>
    <script>
        // 현재 활성 페이지 추적
        let currentPage = '';
        let documentData = [{"id": "updates", "title": "최근 4주 업데이트", "sections": [{"title": "2026년 2월 1주차 (02.03 - 02.04)", "id": "2026년-2월-1주차-0203---0204"}, {"title": "2026년 1월 5주차 (01.30 - 02.02)", "id": "2026년-1월-5주차-0130---0202"}, {"title": "2026년 1월 4주차 (01.23 - 01.29)", "id": "2026년-1월-4주차-0123---0129"}, {"title": "업데이트 확인 방법", "id": "업데이트-확인-방법"}], "searchText": "📋 최신 업데이트 최근 4주간의 주요 변경사항을 확인할 수 있습니다. 전체 변경 이력은 CHANGELOG.md를 참고하세요. 2026년 2월 1주차 (02.03 - 02.04) 🔧 서버 개발자 회의 2차 내용 반영 플랜 구조 확정 및 Actor 개념 정립 5단계 티어 체계 확정 (Free/Starter/Pro/Studio/Enterprise) \"방 최대 인원\" → \"세션 최대 Actor\"로 용어 변경 개인 Actor 수와 세션 최대 Actor 구분 명확화 Actor 수 확정: Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+ Manager 및 Free/Starter 정책 확정 Manager도 1 Actor로 계산 (아바타 없이 참여해도 세션 Actor 수에 포함) Free/Starter 세션 참가 제한: 멀티플레이어 세션에서 Manager로만 참여 가능 세션 권한 이전 정책: Creator/Manager 역할 무관, Pro 이상 플랜이면 세션 유지 저장 및 용량 정책 아바타 슬롯 50개, 200MB/개 제한 명시 월드 용량 제한: Starter 300MB, Pro 이상 800MB 서버 전용 저장 정책 명시 (로컬 저장 제거) 📄 API 명세 문서 신규 작성 현행 Firebase Functions API 정리 전환 검토 중인 Spring Boot REST API (인증, 아바타, 세션, Webhook) Signed URL 보안 정책, 에러 응답 형식 🔧 서버 개발자 회의 1차 내용 반영 서버 아키텍처 전환 검토 (Spring Boot 4.0 + PostgreSQL + Cloudflare R2) 인증 흐름 전환 검토 (Steam OAuth → Firebase Auth → JWT) 테넌트 내 권한 체계 검토 (Owner/Admin/Member) Photon Custom Authentication 및 Webhook 흐름 추가 2026년 1월 5주차 (01.30 - 02.02) 📝 문서 시스템 개선 CHANGELOG.md 추가: 전체 변경 이력 추적 UPDATES.md 추가: 최근 4주 업데이트 요약 `_updates/` 폴더: 주간 상세 리포트 HTML 온보딩 문서 자동 생성 시스템 (`generate_onboarding.py`) 통합 HTML 문서 뷰어 (`VIRDY_Onboarding.html`) 💰 비용 분석 문서 신규 작성 사용자별 월간 원가 산출 (Light/Heavy/Worst Case) 플랜별 마진 분석 (Starter 96%, Pro 56%) 손익분기점(BEP) 분석 (서버 비용 기준 56명) 5단계 비용 방어 체계 상세 명세 Photon/GCP/R2 비용 구성 요소 상세 분석 🔄 용어 통일 \"Photon Fusion 2\" → \"Photon Fusion\" 전체 문서 용어 통일 2026년 1월 4주차 (01.23 - 01.29) 📄 초기 문서 작성 완료 17개 기획 문서 초안 완성 5개 카테고리별 구조화 (Product, Features, Operations, Design, Technical) 표준 문서 형식 확립 (개요, 핵심 기획, 설계 고려사항, 엣지 케이스, 향후 확장) 문서 버전, 최종 수정일, 작성자 메타데이터 포함 업데이트 확인 방법 📌 빠른 확인 이 파일에서 최근 4주간의 주요 변경사항을 확인하세요. 📚 상세 확인 `_updates/YYYY-MM-weekX.md` 파일에서 주간 회의 내용과 상세 변경 이유를 확인하세요. 📖 전체 이력 CHANGELOG.md에서 프로젝트 전체 변경 이력을 확인하세요. 🌐 HTML 뷰어 `VIRDY_Onboarding_v2.html`을 열면 사이드바에서 최신 업데이트를 확인할 수 있습니다. 마지막 업데이트 : 2026.02.04"}, {"id": "changelog", "title": "전체 변경 이력", "sections": [{"title": "[미배포] - 2026-02-03", "id": "미배포---2026-02-03"}, {"title": "[미배포] - 2026-02-02", "id": "미배포---2026-02-02"}, {"title": "[1.0.0] - 2026-01-30", "id": "100---2026-01-30"}, {"title": "범례", "id": "범례"}], "searchText": "변경 이력 모든 주요 변경사항이 이 파일에 기록됩니다. 형식은 Keep a Changelog를 따르며, 이 프로젝트는 Semantic Versioning을 준수합니다. [미배포] - 2026-02-03 추가됨 05_Technical/03_API_Specification.md : API 명세 문서 신규 작성 현행 Firebase Functions API 정리 전환 검토 중인 Spring Boot REST API (인증, 아바타, 세션, Webhook) Signed URL 보안 정책, 에러 응답 형식 향후 추가 예정 API 영역 정리 수정됨 (서버 개발자 회의 2차 내용 반영) 03_Operations/02_License_System.md (v1.1 → v1.2): 플랜 구조 확정 및 제한 정책 구체화 5단계 티어 체계 확정 (Free/Starter/Pro/Studio/Enterprise) 아바타 슬롯 50개, 200MB/개 제한 명시 월드 용량 제한 명시 (Starter 300MB, Pro 이상 800MB) Actor 수 확정 (Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+) 동시 방 보유 1개 정책 확정 (Pro/Studio) Free → Starter 전환 유도 전략 섹션 추가 (워터마크/시간제한/기능잠금 옵션) Studio 조직 시트(Organization Sheet) 검토 중 표기 서버 전용 저장 정책 명시 (로컬 저장 제거) Actor 개념 정립 : \"방 최대 인원\" → \"세션 최대 Actor\"로 용어 변경, 개인 Actor 수와 세션 최대 Actor 구분 명확화 Manager도 1 Actor로 계산 : 아바타 없이 참여해도 세션 Actor 수에 포함 Free/Starter 세션 참가 제한 : 멀티플레이어 세션에서 Manager로만 참여 가능 세션 권한 이전 정책 : Creator/Manager 역할 무관, Pro 이상 플랜이면 세션 유지 03_Operations/01_User_Roles.md (v1.1 → v1.2): 플랜별 역할 제한 반영 Manager도 1 Actor로 계산됨 명시 플랜별 역할 제한 테이블 추가 (Free/Starter는 세션에서 Manager로만 참여) 02_Features/01_Avatar_System.md (v1.1 → v1.2): 저장 정책 구체화 아바타 슬롯 50개, 200MB/개 제한 테이블 추가 Actor 수 라이선스 체계와 동기화 (Studio 4개, Enterprise 6개+) Actor 개념 설명 추가 (1명이 여러 Actor 운용 가능, 세션은 Actor 수로 제한) 서버 전용 저장 정책 명시 (로컬 저장 제거) 엣지 케이스에 슬롯/용량 초과 대응 추가 02_Features/04_World_System.md (v1.0 → v1.1): 업로드 제한 구체화 월드 용량 제한 테이블 추가 (Starter 300MB, Pro 이상 800MB) 서버 전용 저장 정책 명시 (로컬 저장 제거) 업로드 흐름에 용량 검증 단계 추가 02_Features/05_Network_System.md (v1.1 → v1.2): Actor 기반 세션 제한 개념 반영 최대 플레이어 100명 → n명 (검토 중)으로 변경 플레이어 vs Actor 개념 구분 설명 추가 세션 최대 Actor (호스트 플랜 기준) 개념 명시 01_Product/01_Product_Overview.md (v1.0 → v1.1): 5티어 플랜 및 Actor 개념 반영 라이선스 항목에 Starter 플랜 추가 \"최대 100명\" → \"플랜별 세션 최대 Actor 제한\"으로 변경 01_Product/02_User_Flow.md (v1.1 → v1.2): Actor 기반 제한 반영 월드 참가 시 \"인원 확인\" → \"세션 Actor 수 확인\"으로 변경 엣지 케이스 \"100명 초과\" → \"세션 최대 Actor 초과\"로 변경 수정됨 (서버 개발자 회의 1차 내용 반영) 05_Technical/01_Architecture.md : 서버 아키텍처 전환 검토 섹션 추가 (2.7절) Spring Boot 4.0 + PostgreSQL + Cloudflare R2 전환 검토안 JWT 토큰 구조, 데이터 흐름 정리 미확정 사항 (Refresh Token 기간, Firebase 유지 범위 등) 03_Operations/06_Account_System.md : 인증 흐름 전환 검토 섹션 추가 (2.5절) Steam OAuth → Firebase Auth → JWT 흐름 Tenant 개념 도입, 계정 복구 흐름 03_Operations/03_Security.md : 보안 아키텍처 전환 검토 섹션 추가 (2.8절) JWT 기반 인증 보안, Photon Custom Auth Photon Webhook Secret 검증, R2 Signed URL 보안 02_Features/01_Avatar_System.md : 아바타 저장/관리 전환 검토 내용 추가 R2 Signed URL 기반 업로드/다운로드 흐름 fileHash 캐시 검증, Resolve API 검토 02_Features/05_Network_System.md : 세션 관리 전환 검토 섹션 추가 (2.16절) Backend 경유 세션 생성/종료 흐름 Photon Webhook 이벤트, 세션 데이터 모델 Photon Custom Authentication 03_Operations/01_User_Roles.md : 테넌트 내 권한 체계 검토 섹션 추가 (2.6절) Owner/Admin/Member 관리 권한과 Creator/Manager 프로덕션 역할 분리 03_Operations/02_License_System.md : Actor/Seat 개념 섹션 추가 (2.5절) 플랜별 Actor 수 제한 확정 (서버 측 검증) Seat 기반 멤버 초대 개념 (검토 중) 01_Product/02_User_Flow.md : 로그인/로비 흐름 전환 검토 추가 Steam 주 인증 전환 흐름 (2.2.4절) 로비 데이터 로딩 전략 (Pre-load/Lazy Load) (2.3.2절) [미배포] - 2026-02-02 추가됨 03_Operations/07_Cost_Analysis.md : 비용 분석 및 수익성 문서 신규 작성 사용자별 월간 원가 산출 (Light/Heavy/Worst Case) 플랜별 마진 분석 (Starter 96%, Pro 56%) 손익분기점(BEP) 분석 (서버 비용 기준 56명) 5단계 비용 방어 체계 상세 명세 시나리오별 비용 시뮬레이션 (정상/헤비/악용 패턴) Photon/GCP/R2 비용 구성 요소 상세 분석 CHANGELOG.md: 전체 변경 이력 추적 시스템 도입 HTML 온보딩 문서 생성기 (`generate_onboarding.py`) 통합 HTML 문서 뷰어 (`VIRDY_Onboarding.html`) 수정됨 02_License_System.md : 비용 분석 문서 링크 추가 (3.1절) 05_Risk_Management.md : 비용 분석 문서 링크 추가 (R1 리스크) 전체 문서 : \"Photon Fusion 2\" → \"Photon Fusion\" 용어 통일 [1.0.0] - 2026-01-30 추가됨 초기 기획 문서 17개 작성 완료 01_Product: 제품 개요, 사용자 플로우 02_Features: 아바타, 트래커, 카메라, 월드, 네트워크, SDK 03_Operations: 사용자 역할, 라이선스, 보안, 데이터 생명주기, 리스크 관리, 계정 04_Design: UI 기획 05_Technical: 아키텍처, 개발 현황 문서 형식 모든 문서는 표준 구조를 따름 (개요, 핵심 기획, 설계 고려사항, 엣지 케이스, 향후 확장) 문서 버전, 최종 수정일, 작성자 메타데이터 포함 범례 `추가됨`: 새로운 기능, 문서, 섹션 `수정됨`: 기존 기능/문서의 변경 `제거됨`: 삭제된 기능/문서 `수정 예정`: 향후 변경 예정 사항 `보안`: 보안 관련 변경사항"}, {"id": "01_Product_01_Product_Overview", "title": "제품 개요", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "제품 개요 1. 개요 VIRDY 는 버추얼 크리에이터를 위한 올인원 모션캡처 라이브 스트리밍 솔루션이다. 하나의 프로그램 안에서 아바타 설정, 다종 모션캡처 장비 연동, 가상 카메라 운영, 커스텀 월드 업로드, 실시간 멀티유저 협업까지 모두 수행할 수 있다. 개인 VTuber부터 프로덕션 스튜디오까지, Motioncapture 기반 라이브 콘텐츠 제작에 필요한 전 과정을 단일 프로그램으로 통합하는 것이 VIRDY의 핵심 가치이다. 2. 핵심 기획 2.1 제품 비전 \"Mocap 라이브 콘텐츠 제작의 진입 장벽을 낮추고, 개인부터 스튜디오까지 하나의 도구로 커버한다.\" 기존 모캡 라이브 제작 환경은 여러 프로그램을 조합해야 하고, 멀티유저 협업이 어려우며, 각 장비별 별도 솔루션이 필요했다. VIRDY는 이를 하나로 통합한다. 2.2 핵심 가치 가치 설명 올인원 아바타 + 모캡 + 카메라 + 월드 + 서버를 단일 프로그램에서 제공 다종 장비 지원 Facial 5종, Body 5종, Hand 4종 등 14종 이상의 모캡 장비를 지원 실시간 멀티 환경 플랜별 세션 최대 Actor 제한 내에서 역할 분담 협업 가능 커스텀 월드 사용자가 직접 제작한 3D 월드를 업로드하고 방송 / 촬영에 사용 크리에이터 생태계 SDK를 통해 월드/아바타를 제작하고 공유하는 생태계 구축 2.3 타겟 사용자 주력 타겟: 개인 VTuber / 크리에이터 혼자 또는 소규모로 방송하는 개인 크리에이터 저가~중가 모캡 장비 사용 (SteamVR, iFacialMocap, Leap Motion, WebCam 등) 간편한 설정과 빠른 방송 시작을 원함 커스텀 월드 및 기능 세팅으로 차별화된 방송 환경 구축 니즈 주력 타겟 2: 프로덕션 스튜디오 전문 장비를 갖춘 방송/콘텐츠 제작 스튜디오 고가 모캡 장비 사용 (Vicon, Manus, StretchSense 등) 다수 스탭이 역할 분담하여 동시 작업 PD가 여러 카메라맨의 화면을 받아 실시간 스위칭 2.4 제품 정보 항목 내용 개발사 *VIRDY Studio 플랫폼 Windows 전용 엔진 Unity 2022.3.62f3 (URP 14.0.12) 배포 Steam (주력) 수익 모델 SaaS 구독 (영구 라이선스 검토 중) 개발 상태 개발 / 내부 테스트 단계 2.5 핵심 기능 요약 기능 설명 상태 아바타 시스템 VRM 아바타 로딩, ARKit Facial, 암호화 저장, 자체 확장자 계획 ✅ / 📋 확장자 트래커 시스템 Facial 5종 + Body 5종 + Hand 4종 연동, 캘리브레이션 ✅ 카메라 시스템 10채널 가상 카메라, 4가지 View 모드, Channel Link ✅ 월드 시스템 AssetBundle 커스텀 월드, Public/Private 공유, 라이팅 제어 ✅ 네트워크 Photon Fusion 기반, 플랜별 세션 Actor 제한, 데이터 압축 동기화 ✅ 채팅 월드 내 텍스트 채팅 ✅ 친구 시스템 Firebase 기반 친구 목록, Algolia 검색, Invite / Join 기능 ✅ SDK 월드/아바타 빌드, 인터랙티브 기능, 외부 배포 예정 🚧 라이선스 SaaS 티어 (Free/Starter/Pro/Studio/Enterprise) 📋 음성 채팅 세션 내 음성 채팅 📋 로컬 모드 서버 없이 혼자 사용 📋 런처 자동 업데이트 + 인증 런처 📋 세션 녹화 모션 데이터 녹화 및 재생 📋 3. 설계 시 고려사항 3.1 단일 프로그램 통합의 트레이드오프 VIRDY는 모든 기능을 하나의 프로그램에 통합한다. 이는 사용성 측면에서 장점이지만, 메모리/성능 관리에 주의가 필요하다. 3.2 개인 사용자와 스튜디오의 동시 지원 두 타겟 사이에 요구사항 차이가 크다. 항목 개인 크리에이터 프로덕션 스튜디오 설정 복잡도 최소화 세밀한 컨트롤 필요 동시 접속 1~3명 5명 이상 장비 가격대 저가~중가 고가 전문 장비 워크플로우 혼자 또는 소규모 역할 분담 (PD, 카메라맨, 출연자) 세팅에 대한 온보딩을 제공하여 'Simple Setup', 'Advanced Setup' 같은 빠른 세팅 가이드를 제공하는 것 고려 필요. 3.3 Steam 배포 고려 Steam을 주력 배포 채널로 사용할 경우: Steam DRM / 인증 연동 필요 Steam Workshop을 월드/아바타/에셋 공유에 활용 가능성 검토 Steam 리뷰 / 커뮤니티 관리 필요 가격 정책이 SaaS 구독과 Steam 구매 모델 사이에서 충돌할 수 있음 상용화 기획 페이지에서 상세 다룰 예정 4. 엣지 케이스 및 예외 처리 상황 대응 월드 참여 중 네트워크 끊김 로컬 상태 유지, 재접속 시 복구 시도 지원하지 않는 VRM 버전 업로드 오류 메시지와 함께 지원 버전 안내 무료 티어 기능 한도 초과 업그레이드 안내 팝업, 기능 차단 (데이터 손실 없이) 5. 향후 확장 가능성 항목 방향 우선순위 자체 아바타 확장자 애니메이션/스크립트 내장 포맷 높음 로컬 모드 네트워크 없이 단독 사용 높음 세션 녹화/재생 모션 데이터 녹화 및 재생 중간 배포(Steam, 자체) 자동 업데이트 + 토큰 인증 중간 NDI 출력 방송 장비 연동 출력 낮음 음성 채팅 세션 내 실시간 음성 통화 낮음 에셋 마켓플레이스 월드/아바타 공유 및 거래 (+ Steam Workshop) 장기 엔터프라이즈 라이선스 대규모 스튜디오용 커스텀 계약 장기 관련 문서 사용자 플로우 아바타 시스템 라이선스 체계 개발 현황"}, {"id": "01_Product_02_User_Flow", "title": "사용자 플로우", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 플로우", "id": "2-핵심-플로우"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 예외 처리", "id": "4-예외-처리"}, {"title": "5. 상태 정의", "id": "5-상태-정의"}, {"title": "6. 향후 확장 가능성", "id": "6-향후-확장-가능성"}, {"title": "7. 관련 문서", "id": "7-관련-문서"}], "searchText": "사용자 플로우 1. 개요 이 문서는 VIRDY의 전체 사용자 플로우를 정의한다. 개발자가 앱 흐름을 이해하고, QA가 테스트 케이스를 도출하며, 기획자가 UX를 검증하는 데 활용된다. 1.1 Scene 구조 VIRDY는 인증 → 로비 → 월드 3단계로 구성되며, 각 단계는 Unity Scene과 1:1 대응된다. Scene Build Index 역할 주요 기능 SIGN 0 인증 로그인, 회원가입, 비밀번호 리셋 LOBBY 1 준비 아바타/트래커/월드 설정, 월드 생성/참가 WORLD 2 실시간 프로덕션 모션캡처, 카메라, 방송 송출 1.2 사용자 역할 역할 대상 권한 Creator 크리에이터, 출연자 모든 기능 사용 가능 (아바타, 트래커, 월드 생성) Manager PD, 카메라맨, 스태프 제한적 기능 (카메라/조명만, 아바타/모션캡처 사용 불가) 2. 핵심 플로우 2.1 전체 서비스 플로우 flowchart TD Start([프로그램 실행]) --> CheckToken{자동 로그인 토큰 존재?} CheckToken -->|Yes| ValidateToken[\"토큰 유효성 검증\"] CheckToken -->|No| SignScene[\"Sign Scene 로드\"] ValidateToken --> TokenValid{토큰 유효?} TokenValid -->|Yes| LobbyScene[\"Lobby Scene 진입\"] TokenValid -->|No| SignScene SignScene --> Auth[\"인증 플로우\"] Auth --> AuthSuccess{인증 성공?} AuthSuccess -->|Yes| LobbyScene AuthSuccess -->|No| SignScene LobbyScene --> LobbyFlow[\"로비 플로우\"] LobbyFlow --> WorldEntry{월드 진입} WorldEntry -->|월드 생성| CreateSession[\"월드 생성\"] WorldEntry -->|월드 참가| JoinSession[\"월드 참가\"] WorldEntry -->|로그아웃| SignScene CreateSession --> WorldScene[\"World Scene 진입\"] JoinSession --> WorldScene WorldScene --> WorldFlow[\"월드 내 활동\"] WorldFlow --> ExitWorld{월드 나가기} ExitWorld -->|Yes| Disconnect[\"월드 종료\"] ExitWorld -->|No| WorldFlow Disconnect --> LobbyScene style Start fill:#e1f5e1 style SignScene fill:#fff4e6 style LobbyScene fill:#e3f2fd style WorldScene fill:#f3e5f5 2.2 인증 플로우 (Sign Scene) 2.2.1 로그인 단계 동작 성공 시 실패 시 1 이메일/비밀번호 입력 다음 단계 입력 오류 표시 2 Firebase Auth 로그인 API 호출 다음 단계 오류 표시 (잘못된 비밀번호/계정 없음/네트워크 오류) 3 이메일 인증 확인 다음 단계 경고 + 인증 메일 재발송 옵션 4 자동 로그인 토큰 저장 다음 단계 - 5 Firestore에서 사용자 정보 로드 Lobby Scene 전환 재시도 또는 로그아웃 2.2.2 회원가입 단계 동작 성공 시 실패 시 1 이용약관 동의 다음 단계 로그인 화면으로 2 이메일, 비밀번호, 닉네임 다음 단계 폼 검증 오류 표시 3 Firebase Auth 계정 생성 다음 단계 이메일 중복/네트워크 오류 4 Firestore에 사용자 정보 저장 다음 단계 계정 삭제 후 로그인 화면으로 5 인증 메일 발송 로그인 화면으로 경고 표시 (재발송 가능) 필수 입력 필드: 이메일 (유효한 형식) 비밀번호 (8자 이상, 영문+숫자 조합) 닉네임 (필수) 2.2.3 비밀번호 리셋 이메일 입력 → Firebase Auth 비밀번호 리셋 API 호출 → 리셋 메일 발송 완료 → 로그인 화면으로 2.2.4 인증 흐름 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시, Steam 로그인이 주 인증 방식이 되고 이메일/비밀번호는 보조 수단으로 전환된다. 전환 후 로그인 흐름 (검토 중) 단계 동작 성공 시 실패 시 1 Steam SDK로 로그인 Steam Token 획득 Steam 오류 안내 2 Firebase Custom Auth 요청 Firebase Token 수신 Firebase 오류 안내 3 Backend `/api/v1/auth/login` 호출 JWT 수신 서버 오류 안내 4 JWT 로컬 저장 Lobby Scene 전환 - 전환 후 자동 로그인 항목 설명 저장 위치 Refresh Token → 로컬 안전 저장소 유효 기간 Refresh Token 만료 (7~30일, 미확정) 검증 방식 프로그램 시작 시 `/api/v1/auth/refresh` 호출 만료 시 동작 Steam 재로그인 → JWT 재발급 2.3 로비 플로우 (Lobby Scene) 2.3.1 Creator 로비 기능 기능 설명 액터 설정 최대 6개 슬롯, 각 슬롯에 아바타 1개 + 트래커 (Facial/Body/Hand 각 1개) 할당 아바타 설정 VRM 업로드/선택, BlendShape 설정, 민감도 조절 트래커 설정 Facial/Body/Hand 장비 연결, 캘리브레이션 월드 설정 월드 검색/업로드, 공유 설정 환경설정 그래픽, 사운드, 키바인딩, 언어 월드 생성 월드 생성 플로우 시작 월드 참가 월드 참가 플로우 시작 로그아웃 Sign Scene으로 전환 2.3.2 로비 데이터 로딩 전략 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 전환 시 로비 진입 시 데이터를 효율적으로 로딩하기 위한 전략이 도입된다. 데이터 로딩 시점 이유 아바타 목록 로비 진입 시 즉시 (Pre-load) 파일 크기가 커서 미리 다운로드 필요 아바타 파일 목록 수신 후 즉시 (캐시 미스분만) 백그라운드 다운로드 친구 목록 메뉴 진입 시 (Lazy Load) 데이터 작음, 필요 시 로드 Actor 설정 메뉴 진입 시 (Lazy Load) 로컬 설정 우선, 서버는 백업 구독 상세 구독 메뉴 진입 시 (Lazy Load) 기본 정보는 JWT에 포함 월드 목록 미정 기획 확정 후 결정 2.3.3 Manager 로비 기능 Manager는 아래 기능을 사용할 수 있다: 기능 설명 월드 설정 월드 검색/업로드, 공유 설정 환경설정 그래픽, 사운드, 키바인딩, 언어 월드 생성 월드 생성 플로우 시작 월드 참가 월드 참가 플로우 시작 로그아웃 Sign Scene으로 전환 Manager 제약: 아바타/트래커 설정 불가 (카메라/조명 전용 역할) 2.3.3 호스트와 월드 관리 용어: 사용자에게는 \"세션\"이라는 기술 용어 대신 \"월드\"와 \"호스트\"를 사용한다. 호스트 (Host): 월드를 연 사용자가 해당 월드의 호스트 가 됨 플레이어 목록에서 👑 왕관 아이콘으로 표시 호스트가 나가면 남은 유료 사용자에게 자동 이전 (10분 유예 후) 호스트 이전 시나리오: 상황 동작 호스트 퇴장 (팅김/나감) 10분 유예 → 유예 내 복귀 시 호스트 유지 유예 후 미복귀 남은 유료 사용자에게 호스트 자동 이전 호스트가 새 월드 열기 기존 월드의 호스트를 다른 유저에게 이전 후 새 월드 생성 유료 사용자 0명 10분 유예 후 월드 자동 종료 참고: 호스트 이전 및 월드 생명주기 상세 정책은 데이터 생명주기 참조 참고: 활성 월드 관리 UI는 검토 중. UI 기획 참조 2.4 월드 진입 플로우 2.4.1 월드 생성 개발자 참고: 내부적으로 Photon Fusion \"세션\"을 생성하는 플로우이다. 단계 동작 성공 시 실패 시 1 구독 플랜 확인 다음 단계 Free 플랜이면 월드 생성 불가 안내 2 월드 선택 확인 다음 단계 \"월드를 선택하세요\" 경고 3 4자리 랜덤 월드 코드 생성 다음 단계 중복 시 재생성 4 Photon Fusion 세션 생성 월드 로딩 시작 네트워크/서버 오류 참고: Creator/Manager 역할과 무관하게 월드 생성 가능. Free 플랜만 월드 생성 제한. 2.4.2 월드 참가 개발자 참고: 내부적으로 Photon Fusion \"세션\"에 참가하는 플로우이다. 참가 방법: 1. 월드 코드 입력: 4자리 영숫자 직접 입력 2. 친구 초대 수락: Chat으로 받은 초대 메시지에서 코드 추출 3. 따라가기: 친구 목록에서 접속 중인 친구의 월드로 이동 단계 동작 성공 시 실패 시 1 월드 코드 입력/추출 다음 단계 형식 오류 표시 2 Photon 세션 검색 다음 단계 \"월드를 찾을 수 없습니다\" 3 세션 Actor 수 확인 다음 단계 \"세션이 가득 찼습니다\" (호스트 플랜 기준 초과) 4 Photon Fusion 세션 참가 월드 로딩 시작 네트워크/타임아웃 오류 2.4.3 월드 로딩 단계 표시 메시지 동작 1 \"월드 정보 불러오는 중...\" Firebase Storage에서 메타데이터 다운로드 2 \"월드 데이터 다운로드 중... (XX%)\" AssetBundle 다운로드 (캐시 확인 후) 3 \"씬 로딩 중...\" Unity Scene 로드 4 \"월드 접속 중...\" Photon Chat 구독, NetworkGame 초기화 대기 (30초 타임아웃) 캐싱: 월드 AssetBundle은 로컬에 캐시 (`Application.persistentDataPath/WorldCache/`) 메타데이터의 버전 해시로 유효성 검증 캐시 유효 시 다운로드 단계 생략 2.5 월드 내 활동 2.5.1 Creator 활동 기능 설명 모션캡처 연결된 트래커로 실시간 아바타 구동 카메라 조작 10채널 카메라 전환/이동/설정 아바타 이동 선택한 액터의 WASD로 아바타 이동 (위치/회전 네트워크 동기화) 채팅 전체/팀 채팅 메시지 전송 방송 출력 Spout/윈도우 캡처로 OBS 연동 조명 제어 Directional Light 강도/방향 조절 포스트 프로세싱 Bloom/Color 파라미터 조절 Channel Link 카메라 송출/수신 초대 친구에게 월드 초대 2.5.2 Manager 활동 기능 설명 카메라 조작 10채널 카메라 전환/이동/설정 Channel Link 카메라 송출/수신 (PD 워크플로우) 아바타 이동 선택한 액터의 WASD로 아바타 이동 (위치/회전 네트워크 동기화) 조명 제어 Directional Light 강도/방향 조절 포스트 프로세싱 Bloom/Color 파라미터 조절 채팅 전체/팀 채팅 메시지 전송 2.5.3 멀티유저 프로덕션 (PD 워크플로우) 대규모 프로덕션에서 다수 Manager가 협업하는 구조: 역할 동작 카메라맨 B, C, D 각자 CAM 1~3 촬영 → PD의 고정 카메라에 Channel Link PD (A) 모든 카메라맨의 화면 수신 → R+1~9 키로 실시간 스위칭 Creator PD의 Main Screen 수신 → Spout/윈도우 캡처로 방송 송출 Creator와 Manager의 조작 차이는 Actor의 존재 유무일뿐, 그외에 시스템적으로 사용을 제한하는 기능은 없다. 2.6 월드 퇴장 단계 동작 비고 1 확인 팝업 표시 \"월드에서 나가시겠습니까?\" 2 Photon Chat 채널 구독 해제 실패 시 경고 후 계속 3 NetworkRunner 종료 5초 타임아웃 후 강제 종료 4 월드 AssetBundle 언로드 메모리 해제 5 Lobby Scene 로드 실패 시 프로그램 재시작 필요 2.7 소셜 기능 2.7.1 친구 추가 단계 동작 1 친구 검색 UI 열기 2 검색어 입력 (닉네임 또는 이메일, 2자 이상) 3 Algolia 검색 API 호출 4 검색 결과에서 사용자 선택 5 Firebase에 친구 추가 요청 2.7.2 친구 초대 월드 접속 중일 때, 온라인 친구에게 Photon Chat으로 초대 메시지 전송 (`/invite {worldCode}`) 2.7.3 따라가기 로비에서 친구 목록 조회 → 월드 접속 중인 친구 선택 → 해당 월드로 자동 참가 3. 설계 시 고려사항 3.1 Scene 전환 전환 조건 정리 작업 SIGN → LOBBY 인증 성공 - LOBBY → WORLD 월드 생성/참가 성공 - WORLD → LOBBY 월드 퇴장 NetworkRunner 종료, AssetBundle 언로드 LOBBY/WORLD → SIGN 로그아웃 FusionService 정리 3.2 자동 로그인 항목 설명 저장 위치 PlayerPrefs 또는 로컬 파일 유효 기간 Firebase 기본 설정 (1시간 ~ 7일) 검증 방식 프로그램 시작 시 Firebase Auth 토큰 검증 만료 시 동작 Sign Scene 로드, 재로그인 요구 3.3 네트워크 재연결 전략 서비스 재연결 전략 타임아웃 실패 시 동작 Photon Fusion 자동 재연결 시도 30초 강제 종료, 로비 복귀 Photon Chat 지수 백오프 (5초 → 60초) 무제한 채팅만 비활성화, 세션 유지 Firebase 즉시 실패, 재시도 없음 - 오류 표시, 사용자 재시도 유도 3.4 역할 기반 UI 제어 역할 로비 UI 월드 UI Creator 액터/아바타/트래커/월드 패널 전체 모든 기능 Manager 설정 패널만 카메라/조명 제어만 3.5 캐싱 전략 항목 설명 캐시 위치 `Application.persistentDataPath/WorldCache/` 버전 관리 메타데이터의 버전 해시로 유효성 검증 캐시 삭제 조건 버전 불일치, Scene 로드 실패 최대 캐시 크기 5GB (향후 설정 가능) 4. 예외 처리 4.1 인증 단계 상황 대응 이메일 인증 미완료 상태에서 로그인 경고 표시, 인증 메일 재발송 옵션 회원가입 중 네트워크 중단 재시도 옵션, 계정 생성 실패 시 Firebase 데이터 롤백 자동 로그인 토큰 만료 Sign Scene 로드, 재로그인 요구 4.2 로비 단계 상황 대응 Free 플랜에서 월드 생성 시도 UI에서 버튼 비활성화, 업그레이드 안내 Manager가 아바타/트래커 설정 시도 UI에서 패널 비활성화, 툴팁으로 제약 안내 아바타 파일 업로드 실패 오류 메시지, 지원 형식 안내 (VRM) 트래커 연결 실패 장비별 연결 가이드 표시, 재시도 버튼 월드 코드 입력 오류 \"월드를 찾을 수 없습니다\" 오류 동시 월드 제한 초과 새 월드 열기 차단, 기존 월드 닫기 유도 호스트가 새 월드 열기 시도 기존 월드 닫기 확인 팝업 → 남은 유저에게 호스트 이전 4.3 월드 진입 상황 대응 세션 최대 Actor 초과 \"세션이 가득 찼습니다\" 오류, 로비 복귀 (호스트 플랜 기준) 월드 다운로드 중 네트워크 끊김 타임아웃 후 재시도 옵션, 실패 시 로비 복귀 AssetBundle 손상 캐시 삭제 후 재시도 유도 초기화 타임아웃 (30초) 자동 연결 해제, 로비 복귀 접속한 월드가 삭제된 상태 \"월드가 삭제되었습니다\" 오류, 로비 복귀 4.4 월드 내 활동 상황 대응 네트워크 연결 끊김 30초 재연결 시도, 실패 시 강제 퇴장 Chat 연결 끊김 백그라운드 재연결, 세션은 유지 Channel Link 이중 연결 시도 (A→B→C) \"이중 공유는 불가능합니다\" 경고 Creator가 아바타 없이 월드 진입 빈 액터 상태로 참가 4.5 소셜 기능 상황 대응 오프라인 친구에게 초대 시도 \"친구가 오프라인 상태입니다\" 알림 친구가 없는 월드로 따라가기 시도 \"친구가 월드에 없습니다\" 오류 검색 결과 없음 \"다른 검색어를 시도하세요\" 안내 5. 상태 정의 5.1 Scene 상태 Scene 상태 설명 SIGN Idle 로그인 화면 표시 중 SIGN Authenticating Firebase Auth API 호출 중 LOBBY Idle 로비 화면 표시 중 LOBBY CreatingSession 세션 생성 API 호출 중 LOBBY JoiningSession 세션 참가 API 호출 중 WORLD Loading 월드 로딩 중 WORLD Active 월드 활동 중 WORLD Disconnecting 세션 종료 처리 중 5.2 네트워크 상태 상태 설명 Disconnected 세션 연결 안 됨 (로비에서 모든 기능 사용 가능) Connecting 세션 연결 시도 중 (로딩 화면) Connected 세션 연결됨 (월드 활동 가능) Reconnecting 재연결 시도 중 (제한적 활동) Failed 연결 실패 (로비로 강제 복귀) 6. 향후 확장 가능성 항목 현재 향후 우선순위 소셜 로그인 이메일/비밀번호만 Google, Steam, Discord 높음 런처 없음 자동 업데이트 + 토큰 인증 높음 로컬 모드 미지원 네트워크 없이 단독 사용 중간 튜토리얼 없음 최초 실행 시 온보딩 가이드 중간 음성 채팅 미지원 월드 내 실시간 음성 낮음 월드 녹화 미지원 모션 데이터 녹화 및 재생 장기 7. 관련 문서 제품 개요 사용자 역할 아바타 시스템 트래커 시스템 카메라 시스템 월드 시스템 네트워크 시스템 라이선스 체계 UI 기획"}, {"id": "02_Features_01_Avatar_System", "title": "아바타 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "아바타 시스템 1. 개요 아바타 시스템은 사용자가 자신의 3D 캐릭터를 VIRDY에 가져와 실시간으로 구동하는 기능이다. VRM 포맷 아바타를 업로드하여 Actor에 불러오고, 트래커와 연결하여 실시간 모션캡처 아바타로 동작한다. 2. 핵심 기획 2.1 지원 아바타 포맷 포맷 상태 설명 VRM 0.x ✅ 현재 주력 지원 포맷. VRoid Studio, Blender 등에서 제작 가능 VRM 1.0 📋 차세대 VRM 포맷, 지원은 되나 검증 X VSF 📋 VSeeFace 포맷, 지원중이나 일부 VSF 스크립트는 테스트 필요 자체 확장자 📋 애니메이션/스크립트 내장 포맷, 배포 할 VIRDY SDK에서 빌드 2.2 아바타 로딩 파이프라인 단계 동작 설명 1 파일 선택 로컬 VRM 파일 업로드 / 리스트 내 선택 2 VRM 파싱 UniVRM으로 VRM 파일 로드 및 메타데이터 추출 3 머티리얼 변환 MToon 셰이더 → URP Toon Lit 셰이더로 자동 변환 4 본 매핑 Humanoid 본 자동 매핑 + IK 설정 5 표정 설정 BlendShapeProxy 기반 52종 ARKit BlendShape 매핑 6 Puppet 생성 트래커 데이터를 아바타에 연결하는 중간 계층 생성 7 씬 배치 아바타를 Scene에 불러오기 2.3 아바타 저장 및 관리 🚧 모든 아바타 데이터는 서버(클라우드)에만 저장 되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용하고, 로컬 캐시는 성능 최적화 목적으로만 사용한다. 저장 정책 항목 값 비고 아바타 슬롯 수 최대 50개 Pro/Studio 기준, 사용자에게 제한 미노출 아바타 용량 제한 200MB/개 모든 플랜 동일 저장 위치 서버 (클라우드) 로컬 저장 미지원 로컬 캐시 성능 최적화용 원본은 서버에만 존재 아바타 목록 관리 (현행 - Firebase Storage) 항목 설명 업로드 로컬 VRM → Firebase Storage 암호화 업로드 다운로드 Firebase → 로컬 캐시 저장 삭제 Firebase 삭제 + 로컬 캐시 삭제 캐시 이미 다운로드한 아바타는 로컬 캐시에서 바로 로드 아바타 저장/관리 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시 아바타 업로드/다운로드 흐름이 Cloudflare R2 Signed URL 방식으로 변경된다. 업로드 흐름 (검토 중) 단계 동작 1 클라이언트가 Backend에 업로드 요청 (파일명, 크기) 2 Backend가 R2 Signed URL 생성 (Upload용) → 클라이언트에 반환 3 클라이언트가 R2에 직접 파일 업로드 (Egress 비용 0원) 4 업로드 완료 후 Backend에 완료 알림 → 메타데이터 DB 저장 다운로드 흐름 (검토 중) 단계 동작 1 로비 진입 시 Backend에 아바타 목록 요청 2 응답에 이름, 크기, fileHash, 수정일 포함 3 로컬 캐시와 hash 비교 → 캐시 일치 시 다운로드 생략 4 다운로드 필요한 아바타만 Backend에 Signed URL 요청 5 R2에서 직접 다운로드 (병렬, Egress 비용 0원) 6 로컬 캐시 저장 → VRM에서 썸네일 파싱하여 표시 캐시 최적화 (검토 중) 아바타 목록 API 응답에 fileHash를 포함하여, 클라이언트가 로컬 캐시의 유효성을 빠르게 판단할 수 있다. 향후 Resolve API를 도입하여, 클라이언트가 보유한 캐시 hash 목록을 서버에 한 번에 전송하고, 변경된 아바타만 Signed URL을 받는 최적화도 검토 중이다. 결정 사항 (검토 중) 항목 방향 썸네일 서버에서 별도 저장하지 않고, 클라이언트가 VRM 파일에서 직접 파싱 캐시 검증 fileHash를 통해 캐시 유효성 검증 → 불필요한 다운로드 방지 다운로드 시점 로비 진입 시 즉시 Pre-load (아바타는 파일 크기가 크므로 선행 로드) 2.4 표정 시스템 VIRDY는 ARKit 호환 52종 BlendShape를 지원한다. BlendShape 카테고리 카테고리 주요 항목 눈 (Eyes) 깜빡임, 시선 방향, 찡그림, 크게뜨기 눈썹 (Brows) 내리기, 올리기 (안쪽/바깥쪽) 입/턱 (Mouth/Jaw) 미소, 찡그림, 오므리기, 벌리기, 좌우 이동 볼/코/혀 볼 부풀리기, 코 찡그림, 혀 내밀기 민감도 조절 사용자가 부위별로 트래킹 민감도를 조절할 수 있다. 파라미터 범위 설명 시선 강도 (Gaze) 0~1 눈동자 움직임 반영 정도 눈썹 강도 (Eyebrow) 0~1 눈썹 움직임 반영 정도 입/볼 강도 (Mouth) 0~1 입과 볼 움직임 반영 정도 Facial Blendshape Config 세부 조절 ARKit 52 Blendshape를 개별 세부 조절할 수 있다. e.g. 움직임을 0.4 정도만 움직여도 0.8로 Output이 나오게 하는 기능. 2.5 아바타 블렌드셰이프 커스텀 설정 기본 표정 외에 사용자가 추가 BlendShape를 설정할 수 있다. 기능 설명 BlendShape 목록 조회 VRM에 포함된 모든 BlendShape 표시 커스텀 표정 매핑 특정 키/트리거에 BlendShape 조합 할당 GameObject 연동 BlendShape와 연계하여 오브젝트 활성화/비활성화 2.6 액터(Actor) 구조 Actor 는 아바타 + 트래커 조합의 단위이다. 1명의 사용자가 여러 Actor를 동시에 운용할 수 있으며, 세션의 수용량은 플레이어 수가 아닌 총 Actor 수 로 제한된다. 항목 설명 개인 Actor 수 플랜별 상이 (Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+) 구성 아바타 1개 + Facial 트래커 1개 + Body 트래커 1개 + Hand 트래커 1개 저장 슬롯별 설정이 서버에 저장됨 (로컬은 캐시 용도) Actor 수 제한은 서버 측에서 검증한다. 상세 내용은 라이선스 체계 참조. 3. 설계 시 고려사항 3.1 암호화 및 저작권 보호 VRM 파일은 업로드/캐시 시 암호화 적용 로컬 캐시에서도 암호화 상태로 저장되어 직접 파일 추출 방지 VRM 메타데이터의 저작권 정보 존중 (AllowedUser, ViolentUsage 등) 3.2 메모리 관리 아바타 텍스처는 메모리 사용의 주요 원인 월드 진입 시 아바타 + 월드가 동시에 로드되므로 메모리 예산 관리 필요 다수 아바타 동시 로드 시 (멀티유저) LOD 또는 품질 조절 검토 VIRDY-SDK를 통한 Avatar Build 시, Analysis 분석 및 자동 최적화 기능 개발 예정 3.4 네트워크 동기화 대상 아바타의 네트워크 동기화 데이터: 데이터 수량 설명 본 회전 22개 Hips ~ Toes 손가락 포즈 40개 양손 각 20개 표정 값 100개 BlendShape 값 위치 3개 Hip + 손 오프셋 4. 엣지 케이스 및 예외 처리 상황 대응 지원하지 않는 VRM 버전 업로드 오류 메시지 + 지원 버전 안내 VRM 본 매핑 불완전 (필수 본 누락) 경고 표시, 누락 본은 기본 포즈 아바타 파일 손상 로드 실패 → 재업로드 안내 아바타 슬롯 초과 (50개) 업로드 실패 안내, 기존 아바타 정리 권유 아바타 용량 초과 (200MB) 업로드 실패 안내, 파일 최적화 권유 로컬 캐시 손상 자동 재다운로드 동일 아바타를 중복 업로드 기존 아바타 덮어쓰기 안내. 중복 감지는 파일명, VRM 버전 5. 향후 확장 가능성 항목 설명 우선순위 VRM 1.0 차세대 VRM 포맷 지원 높음 자체 확장자 애니메이션/스크립트 내장 아바타 포맷, SDK에서 빌드 높음 관련 문서 트래커 시스템 SDK 네트워크 시스템 사용자 플로우"}, {"id": "02_Features_02_Tracker_System", "title": "트래커 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "트래커 시스템 1. 개요 트래커 시스템은 다양한 모션캡처 장비를 VIRDY에 연결하여 실시간으로 아바타를 구동하는 핵심 기능이다. Facial(얼굴), Body(바디), Hand(핸드) 3개 카테고리로 총 14종 이상의 장비를 지원하며, 개인 크리에이터의 저가 장비부터 프로덕션 스튜디오의 전문 장비까지 폭넓게 대응한다. 2. 핵심 기획 2.1 트래커 데이터 파이프라인 트래커 데이터는 아래 단계를 거쳐 아바타에 적용된다. 단계 동작 설명 1 장비 입력 물리 장비로부터 실시간 데이터 수신 2 TrackerData 변환 장비별 데이터를 통일된 구조로 변환 3 Puppet 생성 트래커별 중간 본 계층 구조 생성 4 리타게팅 본 매핑 및 IK 계산을 통해 아바타 본에 맞춤 5 아바타 적용 최종 아바타 본에 포즈 적용 6 네트워크 동기화 적용된 포즈를 네트워크로 전송 2.2 액터와 트래커 관계 하나의 Actor(액터)에는 아래 트래커가 각 1개씩 할당된다. 트래커 역할 필수 여부 Facial Tracker 얼굴 표정 (52종 BlendShape) 선택 Motion Tracker 신체 움직임 (본 회전) 선택 Hand Tracker 손가락 움직임 (30개 본) 선택 모든 트래커는 선택 사항이다. 연결하지 않은 트래커의 해당 부위는 기본 포즈를 유지한다. 일부 Motion Tracker는 Facial/Hand 또한 움직일 수 있다. 2.3 Facial Tracker (얼굴 트래킹) 지원 장비 장비 연결 방식 설명 iFacialMocap WiFi/UDP iPhone 기반, 가장 보편적 VTube Studio 로컬 API 기존 VTS 사용자 대상 Facemotion3D WiFi/UDP iPhone 기반, iFacial과 VIRDY 내부 기능 차이 없음 OpenSeeFace 로컬 무료, 웹캠 기반 OSC Protocol OSC 범용 프로토콜, 커스텀 연동 페이셜 민감도 설정 사용자가 부위별로 트래킹 반영 정도를 조절할 수 있다. 파라미터 범위 설명 시선 강도 (Gaze) 0~1 눈동자 움직임 반영 정도 눈썹 강도 (Eyebrow) 0~1 눈썹 움직임 반영 정도 입/볼 강도 (Mouth) 0~1 입과 볼 움직임 반영 정도 Facial Blendshape Config를 통해 더욱 상세한 설정이 가능하다. Spine 연동 페이셜 트래킹만 사용할 때, 머리 방향에 따라 상체(Spine)가 자연스럽게 따라 움직이는 기능이다. 파라미터 설명 Scale Spine 회전 크기 조절 Lerp Spine 회전 보간 속도 조절 2.4 Motion Tracker (바디 트래킹) 지원 장비 장비 연결 방식 가격대 대상 설명 SteamVR SteamVR API 중저가 개인 크리에이터 컨트롤러 + 트래커 조합 VMC Protocol UDP/OSC 무료 개인 크리에이터 다른 모캡 앱과 연동 Xsens 전용 SDK 고가 개인/기업 크리에이터 관성 센서 기반 MOVIN 전용 SDK 고가 개인/기업 크리에이터 관성 센서 기반 Vicon DataStream SDK 최고가 전문 스튜디오 광학 기반, 최고 품질 SteamVR 트래커 할당 SteamVR 사용 시, 물리 장치를 신체 부위에 할당한다. 부위 장치 예시 머리 Tracker 1 혹은 HMD 왼손 Controller L 오른손 Controller R 허리 Tracker 2 왼발 Tracker 3 오른발 Tracker 4 추가 옵션: 화면에 SteamVR 트래커 위치 시각화 모션 미러링 (좌우 반전) 캘리브레이션 포즈: T Pose, I Pose 지원 Vicon 특이사항 항목 설명 리타게팅 별도의 고급 리타게팅 처리 사용 미러링 Vicon 자체 미러링 방식 적용 (일반 미러링과 분리) Prop 트래킹 소품(Props) 트래킹 지원 — 물체를 별도로 트래킹하며 Hand와 세밀한 인터랙션 2.5 Hand Tracker (핸드 트래킹) 지원 장비 장비 연결 방식 특징 대상 Leap Motion USB/전용 SDK 책상 위 센서, 저렴 개인 크리에이터 Mollisen 전용 SDK 장갑형 개인 크리에이터 Manus 전용 SDK 장갑형, 고품질 전문가 StretchSense 전용 SDK 장갑형 전문가 손가락 본 구조 구분 본 수 설명 왼손 15개 엄지~새끼 각 3관절 오른손 15개 엄지~새끼 각 3관절 합계 30개 네트워크 동기화 시 40개 muscle 값으로 전송 Leap Motion 설정 파라미터 설명 모션 강도 손가락 움직임 반영 정도 위치 오프셋 (X/Y/Z) 센서 위치 보정 회전 오프셋 (X/Y/Z) 센서 방향 보정 Mollisen 캘리브레이션 Mollisen 장갑은 2단계 캘리브레이션이 필요하다. 단계 포즈 동작 1단계 (MIN) 보자기 (손 최대 펴기) 최소값 기준점 설정 2단계 (MAX) 주먹 (손 최대 쥐기) 최대값 기준점 설정 캘리브레이션 모드: 양손 / 왼손만 / 오른손만 선택 가능 2.6 SteamVR 캘리브레이션 시스템 캘리브레이션 모드 모드 포즈 용도 T-Pose 양팔 수평 펴기 바디 트래킹 기본 캘리브레이션 I-Pose 차렷 자세 대체 캘리브레이션 캘리브레이션 플로우 단계 동작 1 캘리브레이션 포즈 선택 및 시작 버튼 클릭 2 T-Pose 또는 I-Pose 실루엣, 캘리 안내 메시지 표시 3 카운트다운 (초 단위) 4 포즈 캡처 및 기준점 설정 5 캘리브레이션 완료 → 정상 트래킹 시작 3. 설계 시 고려사항 3.1 장비별 연결 방식 차이 각 장비마다 연결 프로토콜이 다르므로, 통일된 TrackerData 인터페이스로 추상화해야 한다. 연결 유형 해당 장비 고려사항 WiFi/UDP iFacialMocap, Facemotion3D 네트워크 지연, 방화벽 로컬 API VTube Studio, OpenSeeFace 포트 충돌 가능 OSC OSC Protocol, VMC 표준 프로토콜, 설정 유연 전용 SDK SteamVR, Vicon, Xsens, MOVIN, Manus, Mollisen, StretchSense, Leap Motion SDK 버전 관리, 라이선스 3.2 다중 트래커 우선순위 Facial + Motion + Hand가 동시에 활성화될 때 본 충돌을 방지해야 한다. Eye 본은 Facial 전용으로 처리 (Motion에서 제외) 손가락 본은 Hand 전용으로 처리 (Motion에서 제외) 나머지 본은 Motion이 우선 3.3 Vicon 예외 처리 Vicon은 다른 장비와 처리 방식이 다르다. 별도 리타게팅 컴포넌트 사용 미러링 로직 분리 세밀한 Prop 트래킹 추가 지원 4. 엣지 케이스 및 예외 처리 상황 대응 트래커 연결 중 장비 연결 해제 마지막 포즈 프리징 (혹은 장비 Timeout용 대기 모션 재생), 재연결 안내 WiFi 트래커 네트워크 지연 프레임 보간으로 끊김 방지 SteamVR 트래커 할당 충돌 (동일 장치 중복) 경고 표시, 재할당 유도 캘리브레이션 미 진행 상태로 월드 진입 시도 캘리브레이션/리타게팅 안내 Facial만 연결 시 Spine은 기본 연동, 추후 Facial Pendulum Tracking 지원 5. 향후 확장 가능성 항목 설명 우선순위 웹캠 페이셜 XRAnimator, WebCam Motioncapture 등 웹캠 기반 얼굴 트래킹 추가 높음 트래커 프리셋 자주 쓰는 장비 조합을 프리셋으로 저장 중간 MotionBuilder 연동 Autodesk MotionBuilder 실시간 스트리밍 낮음 Optitrack 광학 모캡 추가 지원 낮음 자동 장비 감지 연결된 장비 자동 인식 및 설정 제안 장기 관련 문서 아바타 시스템 네트워크 시스템 UI 기획 사용자 플로우"}, {"id": "02_Features_03_Camera_System", "title": "카메라 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "카메라 시스템 1. 개요 카메라 시스템은 VIRDY의 가상 방송 환경에서 촬영, 모니터링, 방송 출력을 담당한다. 10개 채널의 가상 카메라를 운영하며, 4가지 View 모드와 Channel Link를 통해 개인 크리에이터부터 프로덕션 스튜디오까지 다양한 워크플로우를 지원한다. 2. 핵심 기획 2.1 10채널 가상 카메라 구조 채널 이름 타입 설명 0 Free CAM 자유 카메라 WASD + 마우스로 자유 이동, 프리셋 저장 불가 1~9 CAM 01 ~ CAM 09 고정 카메라 Transform 프리셋 저장 가능, Channel Link 가능 카메라별 저장 데이터 데이터 설명 Position 카메라 위치 (3D 좌표) Rotation 카메라 회전 (Euler 각도) Focal Length 초점 거리 (줌) 카메라 설정 DOF, Follow, LookAt 등 2.2 카메라 모드 FreeCam (자유 카메라) 조작 키 설명 기본 이동 W / A / S / D 카메라 앞/뒤/좌/우 이동 상승/하강 Q / E 카메라 상하 이동 빠른 이동 Shift 카메라 이동 속도 증가 시점 회전 마우스 우클릭 드래그 카메라 방향 변경 줌 마우스 휠 Focal Length 조절 조절 가능한 설정: 설정 설명 카메라 속도 이동 속도 줌 속도 마우스 휠 민감도 회전 민감도 마우스 드래그 민감도 Fixed Camera (고정 카메라) 기능 설명 카메라 위치 저장/로드 Transform을 저장하고 불러오기 Channel Link 다른 유저에게 카메라 뷰 공유 Spectator 미리보기 9개 카메라 동시 미리보기 전체 카메라 저장/로드 모든 카메라 로컬 저장 및 불러오기 (월드 재접속, 변경시 사용) 2.3 View 모드 4가지 View 모드를 제공하여 다양한 상황에 맞는 화면 구성을 지원한다. 모드 화면 구성 용도 Default Main Screen만 표시 일반 방송 (개인 크리에이터, 화면녹화) Manager Main + Sub + Spectator (9분할) 제작/매니저 모드 Studio 9분할 모니터링 화면 스튜디오 모니터링 Spout Spout 텍스처 출력 OBS 연동 방송 송출 Default 모드 Main Screen 단일 화면 가장 기본적인 방송 화면 구성 Manager 모드 영역 설명 Main Screen 메인 송출 화면 Spectator View CAM 01~09의 9분할 미리보기 Manager CAM 자유롭게 조작하는 FreeCam Studio 모드 9분할 화면으로 CAM 01~09를 동시 모니터링 스튜디오 환경에서 다수 카메라를 한 눈에 확인 메모리/GPU 최적화: 모니터링 카메라 해상도 / 프레임 다운그레이드 기능 제공 Spout 모드 항목 설명 출력 경로 VIRDY → Spout Sender → OBS (Spout2 Source) 출력 내용 Main Screen만 전송 (UI 제외) 장점 GPU 메모리 직접 공유로 저지연, 채팅 등 UI가 방송에 포함되지 않음 해상도 설정에 따라 조절 가능 2.4 Channel Link 시스템 Channel Link는 멀티유저 환경에서 다른 유저의 카메라 뷰를 주고받는 기능이다. 연결 모드 모드 설명 없음 (None) Channel Link 미사용 송출 (Sending) 내 카메라 뷰를 다른 유저에게 전송 수신 (Receiving) 다른 유저의 카메라 뷰를 수신 연결 제약 항목 제한 최대 송출 대상 제한 없음 이중 공유 불가 (A→B→C 형태 차단) PD 워크플로우 (프로덕션) Channel Link를 활용한 전형적인 프로덕션 구성: 역할 동작 카메라맨 B CAM 1~3 촬영 → PD의 1~3 고정 카메라에 Send 카메라맨 C CAM 1~3 촬영 → PD의 4~6 고정 카메라에 Send 카메라맨 D CAM 1~3 촬영 → PD의 7~9 고정 카메라에 Send PD (A) 9개 채널 Receive → Main Screen에 카메라 스위칭 (R+1~9) 방송 송출 PD의 Main Screen → Creator의 Main Screen으로 Send → Creator의 Main Screen을 방송 송출 (OBS Game Capture 혹은 Spout2) 2.5 카메라 설정 기본 설정 항목 설명 카메라 속도 FreeCam 이동 속도 줌 속도 마우스 휠 민감도 및 Z, C 세기 회전 민감도 마우스 드래그 민감도 렌즈 설정 항목 범위 설명 초점 거리 (Focal Length) 20~200mm 줌 레벨 조리개 (Aperture) 조절 가능 배경 흐림 정도 영향 포커스 설정 (DoF) 항목 설명 포커스 사용 피사계 심도 활성화/비활성화 포커스 심도 DoF 블러 강도 자동 포커스 대상 특정 Actor를 선택하여 자동 초점 Follow / LookAt 설정 항목 설명 Follow 대상 카메라가 따라가는 대상 Actor LookAt 대상 카메라가 바라보는 대상 Actor LookAt Offset Y 바라보기 대상의 Y축 오프셋 (높이 조절) 2.6 카메라 단축키 키 동작 1~9 해당 번호 카메라로 Main Screen 전환 R FreeCam으로 전환 W/A/S/D FreeCam 전후좌우 이동 Q/E FreeCam 상승/하강 Shift FreeCam 빠른 이동 마우스 드래그 시점 회전 마우스 휠 줌 인/아웃 V 장면 크로스페이드 On/Off (전환 애니메이션) 2.7 카메라 전환 및 블렌딩 카메라 전환 시 크로스페이드 블렌딩을 지원한다. 항목 설명 전환 옵션 사용 V (On/Off) 블렌딩 부드러운 카메라 전환 애니메이션 2.8 네트워크 동기화 카메라 데이터는 네트워크를 통해 다른 유저에게 동기화된다. 동기화 대상 설명 Position 카메라 위치 Rotation 카메라 회전 Focal Length 초점 거리 Bool 설정 (3개) DOF 등 On/Off 설정 Float 설정 (6개) 민감도, 오프셋 등 수치 설정 네트워크 보간(Interpolation)을 통해 카메라 움직임이 부드럽게 전달된다. 3. 설계 시 고려사항 3.1 Spout 출력 성능 Spout은 GPU 메모리를 직접 공유하므로 CPU 부하가 낮음 해상도가 높아질수록 VRAM 사용량 증가 OBS 측 Spout2 Source 플러그인 설치 필요 Spout 출력할 UI 별도 문서 항목으로 분류 필요 3.2 Channel Link 네트워크 대역폭 Channel Link는 카메라 Transform만 동기화 (영상 스트리밍이 아님) 데이터 동기화에 대한 최적화 및 압축 등 필요 (변화가 없는데도 계속 업데이트 하면 안 됨) 3.3 카메라 데이터 압축 Position 및 Rotation 데이터 압축 네트워크 대역폭 최소화를 위한 R&D 지속 필요 3.4 Cinemachine 통합 Unity Cinemachine을 활용하여 카메라 블렌딩 및 DoF 처리 CinemachineVirtualCamera: 각 채널의 가상 카메라 CinemachineBrain: 카메라 전환/블렌딩 제어 CinemachineAutoDoFFocus: 자동 피사계 심도 포커스 4. 엣지 케이스 및 예외 처리 상황 대응 이중 Channel Link 시도 (A→B→C) \"이중 공유는 불가능합니다\" 경고, 시스템 차단 Channel Link 송출 중 상대방 퇴장 송출 자동 해제, 알림 표시 Channel Link 수신 중 송출자 퇴장 수신 자동 해제, 내 카메라 시점으로 복귀 Spout 출력 중 OBS 미실행 송출 데이터 무시, VIRDY 내부 동작에 영향 없음 카메라 프리셋 저장 후 월드 변경 프리셋은 어느 월드에서든 로드 가능. 단, 월드 구조에 따라 프리셋 불러올 시 정상적인 카메라 위치가 아닐 수 있음. 5. 향후 확장 가능성 항목 설명 우선순위 NDI 출력 방송 장비 연동용 NDI 프로토콜 지원 낮음 카메라 애니메이션 카메라 이동 경로를 사전 설정하여 자동 재생, 인게임 시퀀스 기능 낮음 카메라 프리셋 공유 다른 유저와 카메라 프리셋 공유 장기 렌즈 효과 확장 필름 그레인, 비네팅 등 시네마 효과 추가 장기 관련 문서 사용자 플로우 네트워크 시스템 사용자 역할 UI 기획"}, {"id": "02_Features_04_World_System", "title": "월드 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "월드 시스템 1. 개요 월드(World)는 VIRDY에서 사용자들이 실시간으로 모여 방송하고 협업하는 가상 공간이다. 사용자는 VIRDY SDK로 Unity 씬을 월드로 빌드하여 업로드하고, 다른 사용자와 공유할 수 있다. 월드는 AssetBundle로 패키징되어 서버(클라우드)에 저장되며, Photon 세션을 통해 멀티유저 환경을 제공한다. 🚧 모든 월드 데이터는 서버(클라우드)에만 저장 되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용하고, 로컬 캐시는 성능 최적화 목적으로만 사용한다. 2. 핵심 기획 2.1 월드 구성요소 구성요소 설명 WorldData 월드 메타데이터 (제목, 설명, 공개설정, 버전 등) AssetBundle Unity 씬이 패키징된 번들 파일 VIRDYWorldDescriptor 월드 설정 컴포넌트 (스폰 포인트, 라이팅, 렌더러) Photon Session 실시간 멀티유저 세션 2.2 월드 데이터 구조 기본 정보 필드 설명 worldId 고유 식별자 (형식: vw_{GUID}) title 월드 이름 author 제작자 이름 authorId 제작자 사용자 ID description 월드 설명 sceneName AssetBundle 내 씬 경로 fileSize 파일 크기 (표시용) 버전 및 통계 필드 설명 version 버전 번호 (업데이트 시 증가) create 생성 시간 update 수정 시간 visits 방문 횟수 썸네일 항목 설명 개수 3장 포맷 png, jpg 등 저장 Firebase Storage 2.3 월드 공개 설정 유형 설명 접근 가능 사용자 Public 모든 사용자에게 공개 전체 Private 제작자만 접근 가능 제작자 Private+ 제작자 + 지정 사용자 제작자 + 공유 대상 2.4 월드 로딩 파이프라인 단계 동작 설명 1 메타데이터 다운로드 Firebase Functions로 월드 데이터 요청 2 AssetBundle 다운로드 Firebase Storage에서 다운로드 (또는 로컬 캐시 사용) 3 AssetBundle 로드 메모리에 번들 로드 4 씬 로드 월드 씬 로드 5 렌더링 설정 월드 렌더러 Feature 병합, 필수 기능(NiloToon, ToonLit 등) 보장 7 SDK 컴포넌트 초기화 VIRDYBehaviour, VIRDYNetworkBehaviour 초기화 호출 씬 초기화 시 자동 처리 항목 동작 EventSystem 자동 비활성화 (VIRDY 메인 EventSystem과 충돌 방지) Camera 자동 비활성화 (VIRDY 카메라 시스템 사용) AudioListener 자동 비활성화 (메인 AudioListener 사용) 레이어 > 29 자동 재설정 (예약 레이어) 오디오 소스 AudioMixer \"Master/World\" 연결 2.6 월드 업로드 및 관리 업로드 제한 항목 값 비고 월드 용량 제한 Starter: 300MB / Pro 이상: 800MB 플랜별 상이 저장 위치 서버 (클라우드) 로컬 저장 미지원 로컬 캐시 성능 최적화용 원본은 서버에만 존재 Free 플랜은 월드 업로드가 불가능하다. 상세 내용은 라이선스 체계 참조. 신규 월드 업로드 단계 동작 1 파일 다이얼로그로 AssetBundle 파일 선택 2 씬 경로 및 파일 크기 추출 3 용량 검증 (플랜별 제한 초과 시 업로드 실패) 4 썸네일 3장 업로드 5 AssetBundle을 서버 Storage에 업로드 6 DB에 월드 메타데이터 저장 7 버전 번호 초기화 (version = 1) 월드 업데이트 변경 사항 동작 메타데이터만 변경 (제목, 설명, 공개설정) Firestore 직접 업데이트 파일 변경 썸네일/AssetBundle 재업로드 + version 증가 공유 대상 변경 shared 관련 DB Collection만 업데이트 월드 삭제 Firestore 메타데이터 + Storage 파일 + 로컬 캐시(?)를 모두 삭제한다. 2.7 월드 목록 관리 목록 설명 전체 공개 월드 worlds_public 컬렉션의 모든 월드 내 월드 내가 제작한 월드 공유받은 월드 다른 사용자가 나에게 공유한 월드 즐겨찾기 월드 즐겨찾기에 추가한 월드 정렬 옵션 옵션 기준 최신순 update 내림차순 오래된순 update 오름차순 인기순 visits 내림차순 비인기순 visits 오름차순 2.8 VIRDYWorldDescriptor 월드 씬에 필수적인 SDK 컴포넌트로, 아래 설정을 포함한다. 항목 설명 SpawnPoint 플레이어 스폰 위치 (미설정 시 Descriptor 위치 사용) RendererData 월드 전용 렌더러 설정 (오버라이드 가능) GlobalVolume 포스트 프로세싱 볼륨 CustomDirectionalLight 월드 방향광 (선택) UnityVersion / URPVersion 빌드 환경 버전 정보 렌더러 오버라이드 시, VIRDY는 월드의 렌더러 기능을 적용하되 NiloToon/ToonLit(아바타 렌더링)과 HighlightPlus(하이라이트)는 반드시 보장한다. 2.9 런타임 커스터마이징 월드 진입 후 실시간으로 조절할 수 있는 항목이다. 세션 내 모든 유저가 Slider UI를 통해 조작할 수 있으며, 변경 사항은 세션 전체에 실시간으로 동기화된다. 방향광(Directional Light) 제어 파라미터 범위 UI 설명 Intensity 0~10 Slider 광원 강도 Rotation X 0°~360° Slider 수직 회전 (태양 고도) Rotation Y 0°~360° Slider 수평 회전 (태양 방위) 포스트 프로세싱 제어 효과 조절 항목 UI Bloom Threshold, Intensity, Scatter, Enable Slider + Toggle Color Adjustments Post Exposure, Contrast, Saturation, Enable Slider + Toggle 멀티유저 동기화 플로우 세션 내 Light/PostProcess 값은 모든 유저에게 공유되는 단일 상태 이다. 누구든 값을 변경하면 세션 전체에 즉시 반영된다. 단계 동작 설명 1 유저가 Slider를 조작 방향광 Intensity, Rotation 또는 PostProcess 파라미터 변경 2 로컬에 즉시 적용 조작한 유저의 화면에 변경값이 즉시 반영 3 RPC로 전체 전파 StateAuthority → 모든 Proxy에 Reliable RPC 전송 4 전체 유저에게 적용 세션 내 모든 유저의 화면에 동일한 값이 반영 시나리오 예시: 유저 A, B, C, D가 같은 세션에 접속해 있다. 1. 유저 A가 Directional Light의 Intensity를 5로 조절한다 → A, B, C, D 모두 Intensity 5가 적용된다. 2. 이후 유저 C가 Light의 Rotation X를 45°로 변경한다 → A, B, C, D 모두 Rotation X 45°가 적용된다. 3. 유저 B가 Bloom의 Intensity를 높인다 → A, B, C, D 모두 동일한 Bloom Intensity가 적용된다. 즉, 마지막으로 조작한 유저의 값이 세션 전체의 현재 상태 가 된다. 동기화 특성 항목 설명 제어 권한 세션 내 모든 유저가 조작 가능 (역할 제한 없음) 동기화 방식 RPC (StateAuthority → Proxies, Reliable) 적용 범위 세션 전체 (모든 접속자에게 동일하게 반영) 충돌 처리 마지막 조작값이 최종값 후속 참가자 세션 참가 시 현재 상태값을 수신하여 동기화 2.10 세션 관리 세션 생성 유저가 월드를 선택하고 \"월드 생성\" 버튼을 누르면 본인은 세션으로 이동, 4자리 숫자 세션 코드가 생성된다. 세션 참가 방법 설명 세션 코드 입력 4자리 코드를 입력하여 참가 친구 초대/따라가기 소셜 기능을 통해 참가 2.11 월드 언로드 월드에서 나갈 때 데이터 및 메모리 정리에 대한 순서가 필요할지 개발팀 문의 예정. 2.12 월드 제작 가이드라인 필수 구성요소 구성요소 필수 여부 설명 VIRDYWorldDescriptor 필수 월드 설정 앵커 Spawn Point Transform 필수 플레이어 스폰 위치 Directional Light 권장 주 광원 Volume (Post Processing) 권장 포스트 프로세싱 성능 권장사항 항목 권장 값 Draw Calls 300 미만 폴리곤 수 50만 미만 텍스처 메모리 개별 텍스처 2048 미만 사용 권장 실시간 광원 4개 미만 라이트맵 사용 권장 제작 시 주의사항 항목 설명 Cinemachine Camera 추가 금지 VIRDY 카메라 시스템과 충돌 AudioListener 추가 금지 메인 AudioListener와 충돌 레이어 30 이상 사용 자제 예약된 레이어 오디오 소스 AudioMixer \"Master/World\" 사용 3. 설계 시 고려사항 3.1 AssetBundle 호환성 월드 AssetBundle은 Streamed Scene AssetBundle이어야 함 (1개 씬) Unity 버전 및 URP 버전이 VIRDY 클라이언트와 호환되어야 함 VIRDYWorldDescriptor에 빌드 환경 버전 정보를 기록하여 호환성 추적 3.2 메모리 관리 AssetBundle 로드 시 메모리 급증 가능 (특히 텍스처가 많은 월드) 언로드 시 `Unload(true)`로 완전 해제 필수 월드 + 아바타가 동시에 로드되므로 총 메모리 예산 관리 필요 3.3 렌더러 병합 시 필수 기능 보장 월드가 커스텀 렌더러를 사용할 경우에도 NiloToon/ToonLit(아바타 셰이더)와 HighlightPlus(상호작용 하이라이트)가 반드시 포함되어야 한다. 3.4 네트워크 동기화 범위 메인 라이트 및 포스트 프로세싱 설정 변경은 RPC를 통해 모든 접속자에게 동기화된다. 세션 내 어떤 유저든 Slider를 조작하면 모든 참가자에게 동일하게 적용된다. 동기화 대상 : Directional Light (Intensity, Rotation X/Y) + PostProcess (Bloom, Color Adjustments) 동기화 단위 : 세션 전체 (개별 유저 단위가 아님) 충돌 정책 : Last-Write-Wins — 여러 유저가 동시에 조작할 경우 마지막 RPC가 최종값이 됨 늦은 참가자 처리 : 세션에 나중에 참가한 유저도 현재 Light/PostProcess 상태를 수신받아 동기화된 상태로 시작 Local 상태 on/off? : 월드 내 유저들과 동기화되지 않고, 혼자 Local로 전환하여 쓸 수 있는 상태를 만들 것인가? 고민 4. 엣지 케이스 및 예외 처리 상황 대응 AssetBundle이 Streamed Scene이 아닌 경우 업로드 시 검증 실패, 오류 안내 VIRDYWorldDescriptor가 누락된 월드 기본값으로 동작 (스폰 포인트 = 원점) 월드 다운로드 중 네트워크 끊김 타임아웃 후 오류 표시, 로비 복귀 캐시된 월드의 버전이 서버와 불일치 서버 버전 다운로드 후 캐시 갱신 월드 언로드 시 메모리 누수 Unload(true)로 강제 해제, 이후 GC 호출 삭제된 월드에 접속 시도 \"월드를 찾을 수 없습니다\" 오류, 로비 복귀 공유 권한이 취소된 월드 접근 Firestore 보안 규칙으로 차단, 목록에서 자동 제거 동일 월드 중복 업로드 기존 월드 업데이트로 처리 (version 증가) 월드 내 EventSystem/Camera 존재 자동 비활성화 처리 5. 향후 확장 가능성 항목 설명 우선순위 Steam Workshop 연동 Steam Workshop을 통한 월드 배포 중간 월드 태그/카테고리 월드 검색을 위한 태그 시스템 중간 월드 버전 관리 이전 버전 롤백 기능 낮음 월드 마켓플레이스 커뮤니티 월드 공유/판매 플랫폼 장기 관련 문서 카메라 시스템 네트워크 시스템 SDK 사용자 플로우 기술 아키텍처"}, {"id": "02_Features_05_Network_System", "title": "네트워크 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "네트워크 시스템 1. 개요 네트워크 시스템은 Photon Fusion Shared Mode를 기반으로 VIRDY의 실시간 멀티유저 협업을 지원한다. 플랜에 따라 세션당 최대 Actor 수가 제한되며, 아바타, 카메라, 채팅을 실시간으로 동기화한다. 데이터 압축과 보간 기술로 네트워크 대역폭을 최적화한다. 2. 핵심 기획 2.1 네트워크 구성요소 구성요소 역할 FusionService 세션 수명주기 관리 (생성, 참가, 종료) FusionLobby 로비 연결 및 세션 검색 NetworkGame 세션 루트 오브젝트 (플레이어, 채널, 액터 관리) NetworkPlayer 플레이어별 인증 정보 및 위치 동기화 NetworkActor 아바타 본/표정/손가락 동기화 NetworkChannel 카메라 위치/설정/Channel Link 동기화 ChatService Photon Chat 기반 텍스트 채팅 및 초대 시스템 2.2 기본 설정 항목 값 비고 게임 모드 Photon Fusion Shared Mode - 최대 플레이어 (기술적 한계) n명 (검토 중) Photon 설정 세션 최대 Actor (비즈니스 제한) 플랜별 상이 호스트 플랜 기준 (Pro 3, Studio 6, Enterprise 10+) 로비 유형 Custom - 로비 이름 VIRDY.{버전} - 세션 코드 4자리 영숫자 (예: A1B2) - 플레이어 vs Actor : 플레이어는 접속한 사용자 수이고, Actor는 세션 내 아바타 수이다. 1명의 플레이어가 여러 Actor를 운용할 수 있으므로, 세션 수용량은 Actor 수 로 제한한다. 상세 내용은 라이선스 체계 참조. 2.3 세션 생성 및 참가 세션 생성 단계 동작 1 사용자가 월드를 선택하고 \"세션 생성\" 클릭 (Free 플랜 제외) 2 4자리 랜덤 세션 코드 생성 3 세션 속성에 worldId 포함 4 Photon 세션 생성 → 월드 로딩 → 접속 완료 세션 참가 방법 설명 세션 코드 입력 4자리 코드를 입력하여 세션에 참가 친구 초대 수락 Chat으로 받은 초대를 수락하여 참가 따라가기 친구가 있는 세션에 참가 요청 2.4 세션 연결 플로우 연결 과정 단계 동작 상태 표시 1 로비 Runner 종료 \"초기화 중...\" 2 Firebase Storage에서 월드 다운로드 \"월드 데이터 다운로드 중... (XX%)\" 3 AssetBundle 로드 \"씬 로딩 중...\" 4 NetworkRunner 생성 및 세션 참가 \"세션 접속 중...\" 5 연결 대기 (30초 타임아웃) - 6 Photon Chat 채널 구독 - 7 WorldScene 로드 대기 - 8 NetworkGame 초기화 완료 로딩 해제 연결 해제 과정 단계 동작 1 채팅 구독 해제 2 NetworkRunner 종료 3 월드 언로드 (AssetBundle 메모리 해제) 4 로비 복귀 2.5 네트워크 오브젝트 계층 세션에 접속하면 아래 오브젝트가 플레이어별로 생성된다. 오브젝트 수량 설명 NetworkGame 1개 (세션당) 모든 플레이어/채널/액터를 관리하는 루트 NetworkPlayer 1개 (플레이어당) 사용자 정보, 아바타 위치 NetworkChannel 1개 (플레이어당) 10개 카메라 + Channel Link NetworkActor 플랜별 상이 (플레이어당) 아바타별 본/표정/손가락. 개인 Actor 수는 플랜에 따라 1~6개+ 2.6 아바타 동기화 데이터 데이터 수량 설명 본 회전 22개 Hips ~ Toes (Quaternion) 손가락 포즈 40개 양손 각 20개 (muscle 값) 표정(BlendShape) 100개 ARKit 52종 + 확장 위치 3개 Hip 위치 + 손 오프셋 동기화 본 목록 (22개) 부위 본 몸통 Hips, Spine, Chest, UpperChest, Neck, Head 왼팔 LeftShoulder, LeftUpperArm, LeftLowerArm, LeftHand 오른팔 RightShoulder, RightUpperArm, RightLowerArm, RightHand 왼다리 LeftUpperLeg, LeftLowerLeg, LeftFoot, LeftToes 오른다리 RightUpperLeg, RightLowerLeg, RightFoot, RightToes 2.7 FPS 모드 동기화 아바타를 월드 내에서 WASD로 이동할 때의 동기화 데이터: 데이터 설명 IsFPSMode FPS 모드 활성화 여부 FPSPosition FPS 위치 FPSRotation FPS 회전 FPSSpeed 이동 속도 FPSAnimationState 애니메이션 상태 (Idle/Walk/Jump/Run) 2.8 Props 동기화 Vicon 등 전문 장비에서 소품(Props) 트래킹 시 동기화: 항목 설명 최대 수량 20개 동기화 데이터 이름, 위치, 회전 2.9 Sync 모드 (동기화 품질) 네트워크 동기화 품질은 Live 와 Ultra 두 가지 모드로 구분되며, 구독 플랜에 따라 제공 범위가 달라진다. 모드 대상 플랜 특징 용도 Live Sync 모든 플랜 경량 모션 데이터, 비용 효율적 일반 방송, 개인 사용 Ultra Sync Enterprise 전용 고품질 모션 데이터, 높은 대역폭 공연, 특수 연출, 전문 프로덕션 Live Sync 항목 설명 대상 모든 구독 플랜 (무료 포함) 데이터 전송량 경량화된 모션 데이터 비용 효율 높음 품질 일반 사용에 충분한 수준 Ultra Sync 항목 설명 대상 Enterprise 플랜 전용 데이터 전송량 고용량 모션 데이터 비용 효율 낮음 (대역폭 비용 높음) 품질 전문 프로덕션 수준 조건 네트워크 품질 기준 충족 필요 Sync 모드 설계 원칙 Sync 품질은 기술 옵션이 아닌 비용 및 계약 개념 으로 관리 현재 사용 중인 고용량 모션 데이터는 일반 사용에 부적합 Live Sync 전용으로 최적화된 경량 모션 데이터 개발 필요 Ultra Sync 네트워크 조건 미달 시 Live로 자동 전환 Sync 모드별 구독 플랜은 라이선스 체계 참조 2.10 데이터 압축 네트워크 대역폭 절감을 위해 다양한 압축 기법을 적용한다. 데이터 유형 원본 크기 압축 후 절감률 Quaternion (본 회전) 16 bytes 8 bytes (short×4) 50% BlendShape (표정) 4 bytes 1 byte (sbyte) 75% Position (위치) Accuracy(0.1f) 양자화 가변 가변 추가 최적화: 변경 감지: 유의미한 변경이 있는 데이터만 전송 분산 액터 업데이트: 프레임당 최대 3명의 액터만 서버에 업데이트 (라운드 로빈) 2.11 보간 시스템 원격 플레이어의 움직임을 부드럽게 표시하기 위한 보간 처리: 항목 설명 히스토리 버퍼 2프레임 히스토리 본 회전 Quaternion Slerp 보간 위치 선형 보간 업데이트 주기 StateAuthority: FixedUpdate / Proxy: Render 2.12 채팅 시스템 Photon Chat을 활용한 텍스트 채팅 및 소셜 기능: 채팅 기능 기능 설명 전체 채팅 세션 내 모든 사용자에게 메시지 전송 팀 채팅 팀원에게만 메시지 전송 소셜 명령 명령 기능 설명 /invite 초대 친구에게 현재 세션 참가 요청 /follow 따라가기 친구가 있는 세션에 참가 요청 /bring 데려오기 친구를 내 세션으로 이동 재연결 전략 시도 대기 시간 1~6회 5초 7회 이상 60초 최대 시도 초과 연결 실패 알림 2.13 RPC 사용 패턴 주요 데이터 동기화에 사용되는 RPC 패턴: 용도 방향 채널 플레이어 초기화 StateAuthority → All Reliable 채팅 메시지 All → All Reliable 라이팅 동기화 StateAuthority → Proxies Reliable Channel Link 요청 All → StateAuthority Reliable 스폰포인트 제어 All → StateAuthority Reliable 2.14 Light / PostProcess 네트워크 동기화 세션 내 Directional Light와 PostProcess 파라미터는 모든 유저에게 공유되는 세션 전역 상태이다. 어떤 유저든 Slider UI를 통해 값을 변경하면 RPC로 전체 세션에 전파된다. 동기화 대상 기능 파라미터 설명 Directional Light Intensity 광원 강도 (0~10) Directional Light Rotation X 수직 회전 / 태양 고도 (0°~360°) Directional Light Rotation Y 수평 회전 / 태양 방위 (0°~360°) Bloom Threshold, Intensity, Scatter, Enable 블룸 효과 파라미터 Color Adjustments Post Exposure, Contrast, Saturation, Enable 색감 보정 파라미터 동기화 플로우 단계 동작 1 유저가 Slider UI로 Light 또는 PostProcess 파라미터를 변경 2 로컬에 즉시 적용 (조작자 화면에 바로 반영) 3 StateAuthority → 모든 Proxy로 Reliable RPC 전송 4 수신한 모든 유저의 화면에 동일한 값 적용 동기화 특성 항목 설명 방향 StateAuthority → Proxies 채널 Reliable 제어 권한 세션 내 모든 유저가 조작 가능 충돌 정책 Last-Write-Wins (마지막 RPC가 최종값) 후속 참가자 세션 참가 시 현재 상태값을 수신하여 동기화 상태로 시작 2.15 스폰포인트 네트워크 제어 월드의 스폰포인트 위치를 네트워크를 통해 제어할 수 있다. 항목 설명 위치/회전 네트워크로 동기화 제어권 한 번에 1명만 스폰포인트 제어 가능 요청 방식 RPC로 StateAuthority에 제어권 요청 2.16 세션 관리 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시, 세션 생성/종료가 Backend를 경유하고 Photon Webhook으로 상태를 동기화하는 구조로 변경된다. 전환 후 세션 생성 흐름 (검토 중) 단계 동작 1 Client(A)가 Backend에 세션 생성 요청 2 Backend에서 세션 정보 생성 + 8자리 joinCode 발급 3 Client(A)가 Photon Room 생성 4 Photon → Backend Webhook: Room Created → photonRoomId 매핑 저장 5 다른 Client(B, C)가 joinCode로 참가 6 Photon → Backend Webhook: Player Joined → currentParticipants 증가 전환 후 세션 종료 흐름 (검토 중) 단계 동작 1 Host가 Backend에 세션 종료 요청 2 Backend → Photon Server API: Close Room 명령 3 Photon → Backend Webhook: Room Closed 4 Backend에서 세션 상태 CLOSED 업데이트, closedAt 기록 Photon Webhook 이벤트 (검토 중) 이벤트 발생 시점 Backend 처리 PathCreate Room 생성 시 photonRoomId 저장, 세션 상태 ACTIVE PathJoin 플레이어 입장 시 currentParticipants 증가, 참가자 기록 PathLeave 플레이어 퇴장 시 currentParticipants 감소 PathClose Room 종료 시 세션 상태 CLOSED, closedAt 기록 세션 데이터 모델 (검토 중) Backend에서 관리하는 세션 데이터 구조: 필드 타입 설명 id Long 세션 고유 ID tenantId Long 소속 테넌트 worldId Long 사용 중인 월드 joinCode String (8자리) 참가 코드 (고유) photonRoomId String Photon에서 부여한 Room ID status Enum WAITING / ACTIVE / CLOSED maxParticipants Integer 최대 인원 (플랜에 따라) currentParticipants Integer 현재 인원 hostUserId Long 방장 Photon Custom Authentication (검토 중) Photon 접속 시 Backend를 통한 인증을 필수로 설정하여, AppID 탈취로 인한 무단 사용을 방지한다. 클라이언트는 Photon 연결 시 JWT를 전달하고, Photon은 Backend에 인증을 위임한다. 미확정 사항 항목 상태 비고 호스트 이탈 시 처리 📋 논의 필요 호스트 마이그레이션 vs 세션 종료 비정상 종료 감지 📋 논의 필요 Heartbeat + Timeout으로 좀비 세션 정리 joinCode 길이 📋 미확정 현행 4자리 → 8자리로 변경 검토 3. 설계 시 고려사항 3.1 Shared Mode 특성 Photon Fusion Shared Mode를 사용하므로: 각 플레이어가 자신의 오브젝트에 대한 StateAuthority를 가짐 서버가 아닌 클라이언트가 자신의 데이터를 직접 업데이트 호스트 없이 모든 클라이언트가 동등한 권한 3.2 대역폭 관리 다수의 Actor가 동시 접속 시 데이터 양이 급증하므로: 프레임당 최대 3명의 액터만 서버 업데이트 (분산 처리) Quaternion 50% 압축 + BlendShape 75% 압축 유의미한 변경만 전송 (변경 감지) 위치 데이터 양자화 3.3 버전 호환성 로비 이름에 버전을 포함 (VIRDY.{버전})하여 서로 다른 버전의 클라이언트가 같은 세션에 접속하는 것을 방지한다. 3.4 세션 속성 세션에 worldId를 포함시켜 참가자가 올바른 월드를 다운로드하도록 보장한다. 4. 엣지 케이스 및 예외 처리 상황 대응 세션 코드 오류 (존재하지 않는 코드) \"세션을 찾을 수 없습니다\" 오류 표시 연결 대기 타임아웃 (30초) 자동 연결 해제, 오류 알림, 로비 복귀 월드 다운로드 실패 연결 해제, 오류 알림 예기치 않은 연결 끊김 자동 연결 해제, 로비 복귀 Chat 연결 끊김 지수 백오프 자동 재연결 (5초 → 60초) Chat 재연결 최대 시도 초과 연결 실패 알림 표시 이중 Channel Link 시도 \"이중 공유는 불가능합니다\" 경고 스폰포인트 제어 충돌 이미 다른 사용자가 제어 중이면 요청 거부 세션 최대 Actor 초과 참가 거부, 안내 메시지 (호스트 플랜 기준) 5. 향후 확장 가능성 항목 설명 우선순위 음성 채팅 세션 내 실시간 음성 통화 중간 세션 녹화/재생 모션 데이터 녹화 및 재생 중간 로컬 모드 네트워크 없이 단독 사용 중간 서버 리전 선택 사용자가 가까운 서버 선택 낮음 관전 모드 참가하지 않고 세션 관전 장기 관련 문서 월드 시스템 카메라 시스템 사용자 플로우 기술 아키텍처 라이선스 체계 리스크 관리 보안 시스템"}, {"id": "02_Features_06_SDK", "title": "SDK", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "SDK 1. 개요 VIRDY SDK는 월드 및 아바타 크리에이터가 커스텀 인터랙티브 콘텐츠를 제작할 수 있도록 제공하는 Unity 패키지이다. SDK를 사용하면 3D 월드를 AssetBundle로 빌드하고, 네트워크 동기화가 가능한 인터랙티브 오브젝트를 추가하며, 자체 확장자 아바타를 빌드할 수 있다. 2. 핵심 기획 2.1 SDK 패키지 정보 항목 내용 패키지 이름 com.parable.virdy-sdk 표시 이름 VIRDY SDK 지원 Unity 2022.3 LTS 의존성 Cinemachine 2.9.7 배포 상태 🚧 개발 중 (외부 배포 예정) 2.2 SDK 구성 폴더 내용 Editor/ 에디터 전용 도구 (빌드, 인스펙터) Runtime/ 핵심 SDK 컴포넌트 Runtime/ShaderController/ 셰이더 및 비주얼 제어 컴포넌트 Runtime/EX/ 확장 기능 (PostIt 등) Plugins/uWindowCapture/ 윈도우 캡처 통합 Samples/ 예제 씬 및 프리팹 Resources/Settings/ 기본 설정 2.3 베이스 클래스 SDK의 모든 인터랙티브 컴포넌트는 아래 2개 베이스 클래스 중 하나를 상속한다. VIRDYBehaviour (비네트워크) 항목 설명 용도 네트워크 동기화가 필요 없는 인터랙티브 컴포넌트 생명주기 Initialize (월드 로드 시) → DeInitialize (월드 언로드 시) 기능 Transform 위치/회전 원본 저장 및 복원 사용 예시 애니메이션, UI, 조명 효과, 시각 전용 오브젝트 VIRDYNetworkBehaviour (네트워크) 항목 설명 용도 네트워크 동기화가 필요한 인터랙티브 컴포넌트 상속 Photon Fusion의 NetworkBehaviour 생명주기 Initialize → DeInitialize (VIRDYBehaviour와 동일) 필수 요구 NetworkObject 컴포넌트 필요 기능 Networked 속성, RPC 메서드 사용 가능 사용 예시 문, 스위치, 동기화 오브젝트, 공유 UI 2.4 VIRDYWorldDescriptor 월드 씬에 필수적인 싱글톤 컴포넌트로, 월드 설정과 초기화를 관리한다. 설정 설명 SpawnPoint 아바타 스폰 위치 RendererData URP 렌더러 설정 (오버라이드 가능) GlobalVolume 포스트 프로세싱 볼륨 CustomDirectionalLight 방향광 설정 UnityVersion / URPVersion 빌드 환경 버전 정보 초기화 시 씬 내 모든 VIRDYBehaviour 및 VIRDYNetworkBehaviour를 탐색하여 Initialize를 호출한다. 에디터 생성: Hierarchy 우클릭 → GameObject/VIRDY/VIRDYWorldDescriptor 2.5 인터랙티브 컴포넌트 VIRDYObjectActivator 항목 설명 기능 이름으로 오브젝트 그룹 활성화/비활성화 네트워크 불필요 사용 예시 버튼으로 조명/파티클 그룹 토글 VIRDYGlobalFunction (네트워크) 항목 설명 기능 키 기반 함수를 모든 플레이어에게 브로드캐스트 네트워크 필요 (RPC) 지원 인자 없음 / int / string 사용 예시 특수 효과 활성화, 애니메이션 트리거, 이벤트 전파 VIRDYMultiObjectControl 항목 설명 기능 오브젝트 배열을 순차적으로 활성화/비활성화 네트워크 불필요 사용 예시 갤러리 이전/다음, 캐러셀 디스플레이 VIRDYVideoPlayer 항목 설명 기능 비디오 클립 재생, 페이드 전환, RenderTexture 출력 네트워크 불필요 구성 VideoClip + RenderTexture + FadeUI 1:1 매핑 VIRDYRoulette (네트워크) 항목 설명 기능 이징 커브 기반 회전 룰렛 네트워크 필요 (동기화된 랜덤 결과) 사용 예시 복권, 스핀 게임, 랜덤 결과 표시 VIRDYInputFieldSync (네트워크) 항목 설명 기능 텍스트 입력을 여러 UI에 네트워크 브로드캐스트 네트워크 필요 사용 예시 자막 디스플레이, 공유 채팅 2.6 조명 제어 컴포넌트 VIRDYLightController 항목 설명 기능 포인트 라이트 프리셋 전환, 파티클 효과 토글 라이트 수 최대 3개 포인트 라이트 프리셋 색상(3개), 강도, 범위 조합 전환 부드러운 색상 전환 (Lerp) VIRDYMirrorBall 항목 설명 기능 HSV 색상 순환 + 회전 + 밝기 제어 제어 MusicStart / MusicStop (페이드아웃) 2.7 셰이더 및 VFX 컴포넌트 VIRDYMaterialController (네트워크) 항목 설명 기능 머티리얼 셰이더 속성을 네트워크로 동기화 입력 UI 슬라이더(VIRDYMaterialSlider) 또는 직접 float 값 사용 예시 조명 색상/강도 제어, 투명도, 셰이더 파라미터 VIRDYVFXController (네트워크) 항목 설명 기능 Visual Effect Graph 파라미터를 네트워크로 제어 지원 속성 Float, Slider(0~1), Vector2, Gradient(색상 프리셋) EmissionController 항목 설명 기능 이름 매칭으로 머티리얼 발광 강도 제어 사용 예시 캐릭터 머티리얼 발광, 네온 효과 2.8 UI 컴포넌트 VIRDYWorldUI 항목 설명 기능 World Space Canvas를 VIRDY 이벤트 카메라에 자동 연결 설정 컴포넌트 추가만으로 자동 설정 카메라 전환 카메라 변경 시 자동 업데이트 VIRDYScreenUI 항목 설명 기능 Screen Space Camera Canvas 자동 설정 설정 렌더 모드, 레이어, Z-오더 자동 관리 VIRDYFadeUI 항목 설명 기능 UI 페이드 인/아웃 + 선택적 위치 이동 애니메이션 DOTween 기반 (조건부 컴파일: VIRDY_DOTWEEN) 설정 Duration, Ease In/Out, 위치 시작/끝 VIRDYCinemachineTrack 항목 설명 기능 Timeline 재생을 활성 카메라 Brain에 자동 바인딩 사용 예시 플레이어 카메라 변경에 적응하는 시네마틱 시퀀스 2.9 확장 컴포넌트 BlendShapeManager 항목 설명 기능 VRM 아바타 BlendShape + 연계 GameObject 제어 설정 대상 인덱스, VRM 메타 타이틀, BlendShape 경로/이름 사용 예시 아바타 커스텀 표정, 바디 모프 VIRDYPostItController 항목 설명 기능 물리 기반 포스트잇 부착/분리 시스템 구성 PostItStickyController (개별) + VIRDYPaperAero (종이비행기) 연동 NetworkActor.WriteBuffer에서 틱 호출 VIRDYVelocity (네트워크) 항목 설명 기능 네트워크 동기화 물리 힘 (선형 속도 + 토크) 필수 NetworkObject + NetworkRigidbody + Rigidbody 사용 예시 물리 오브젝트, 공, 인터랙티브 소품 VIRDYTimer 항목 설명 기능 경과 시간 또는 현재 시간 표시 출력 시/분/초/밀리초 별도 TextMeshPro 제어 Start / Stop / Reset / GetCurrentTime OSCReceiver 항목 설명 기능 외부 OSC 메시지를 VIRDYGlobalFunction으로 라우팅 연동 VSeeFace, Resolume 등 OSC 앱 지원 인자 없음, int, string 메시지 2.10 에디터 도구 VIRDYWorldDescriptorEditor 기능 설명 렌더러 상태 표시 URP 기능 목록 (SSAO, HBAO, Volumetric 등) 월드 빌더 출력 경로 설정 + 원클릭 AssetBundle 빌드 빌드 방식 ChunkBasedCompression, 매니페스트 정리 컴포넌트별 에디터 에디터 기능 VIRDYFadeUIEditor 에디터에서 페이드 애니메이션 테스트 VIRDYVideoPlayerEditor 비디오 클립 재생 테스트 VIRDYLightTransitionEditor 라이트 프리셋 전환 테스트 2.11 샘플 프리팹 프리팹 설명 VIRDYWorld.prefab Descriptor 사전 설정된 템플릿 월드 VIRDYMaterialController.prefab 셰이더 제어 설정 예제 VIRDYUwc.prefab 윈도우 캡처 통합 예제 uWC Window List Item.prefab 윈도우 선택 UI 2.12 조건부 컴파일 심볼 심볼 설명 VIRDY_CORE 프레임워크 빌드 (Context 접근 가능) VIRDY_DOTWEEN DOTween 애니메이션 활성화 VIRDY_HORIZONBASEDAMBIENTOCCLUSION HBAO 렌더러 VIRDY_OCCASOFTWARE_ALTOS Altos 렌더러 VIRDY_VOLUMETRICLIGHTS 볼류메트릭 라이트 VIRDY_VOLUMETRICFOGANDMIST2 볼류메트릭 포그 2.13 월드 빌드 워크플로우 단계 동작 1 Unity 씬 생성, VIRDYWorldDescriptor 추가 2 스폰 포인트, Directional Light, GlobalVolume 설정 3 인터랙티브 컴포넌트 추가 (VIRDYBehaviour/VIRDYNetworkBehaviour 상속) 4 에디터에서 테스트 5 VIRDYWorldDescriptorEditor의 \"Build\" 클릭 → AssetBundle 생성 6 VIRDY 로비에서 AssetBundle 업로드 3. 설계 시 고려사항 3.1 SDK 외부 배포 SDK는 외부 크리에이터에게 웹사이트/문서를 통해 배포 예정 월드 빌드 + 아바타 빌드(자체 확장자) 기능 포함 외부 배포 시 VIRDY_CORE 심볼 없이 사용 가능해야 함 3.2 네트워크 컴포넌트의 NetworkObject 요구 VIRDYNetworkBehaviour를 사용하는 모든 오브젝트는 NetworkObject 컴포넌트가 필수이다. 이를 누락하면 네트워크 동기화가 작동하지 않으므로, RequireComponent 어트리뷰트로 강제한다. 3.3 월드 내 충돌 방지 월드 AssetBundle에 포함된 EventSystem, Camera, AudioListener는 VIRDY 메인 시스템과 충돌하므로 자동 비활성화된다. SDK 사용자에게 이 제약을 명확히 안내해야 한다. 3.4 프레임워크 통합 포인트 SDK 컴포넌트는 VIRDY 프레임워크와 아래 지점에서 연결된다: 연결 설명 카메라 이벤트 VIRDYWorldUI, VIRDYCinemachineTrack이 카메라 전환을 감지 생명주기 VIRDYWorldDescriptor가 월드 로드/언로드 시 모든 컴포넌트 초기화/정리 네트워크 VIRDYNetworkBehaviour가 Photon Fusion 세션에 자동 참여 PostIt VIRDYPostItController가 NetworkActor.WriteBuffer에서 틱 호출 4. 엣지 케이스 및 예외 처리 상황 대응 VIRDYWorldDescriptor 누락 월드 기본값으로 동작 (스폰 포인트 = 원점) NetworkObject 없이 VIRDYNetworkBehaviour 사용 RequireComponent로 자동 추가 강제 월드에 EventSystem/Camera/AudioListener 포함 자동 비활성화 SDK 버전과 클라이언트 버전 불일치 VIRDYWorldDescriptor의 UnityVersion/URPVersion으로 감지 DOTween 미설치 상태에서 FadeUI 사용 VIRDY_DOTWEEN 심볼 미정의 시 DOTween 코드 비활성화 다수의 VIRDYWorldDescriptor 존재 싱글톤으로 하나만 유지 OSC 포트 충돌 사용자에게 포트 변경 안내 5. 향후 확장 가능성 항목 설명 우선순위 외부 SDK 배포 웹사이트/문서를 통한 외부 크리에이터 배포 높음 자체 아바타 확장자 애니메이션/스크립트 내장 아바타 빌드 기능 높음 SDK 문서화 API 레퍼런스, 튜토리얼, 예제 프로젝트 높음 커스텀 컴포넌트 추가 투표, 리더보드, 미니게임 등 중간 비주얼 스크립팅 코드 없이 인터랙션 설정 장기 월드/아바타 마켓플레이스 커뮤니티 콘텐츠 공유/판매 장기 관련 문서 월드 시스템 네트워크 시스템 아바타 시스템"}, {"id": "03_Operations_01_User_Roles", "title": "사용자 역할", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "사용자 역할 1. 개요 VIRDY는 Creator와 Manager 두 가지 역할을 제공하여 프로덕션급 워크플로우를 지원한다. Creator는 아바타와 모션캡처를 포함한 전체 기능을 사용하며, Manager는 카메라/조명 등 프로덕션 지원에 집중한다. 역할은 회원가입 시 선택되며 계정에 고정된다. 2. 핵심 기획 2.1 역할 정의 구분 Creator Manager 핵심 정의 아바타 + 모캡을 갖춘 전체 기능 사용자 프로덕션 제어에 집중하는 지원 사용자 리소스 사용 높음 (아바타, 애니메이션, 모캡 처리) 낮음 (아바타/모캡 없음) 세션 Actor 계산 1 Actor로 계산 1 Actor로 계산 (아바타 없어도 동일) 주 사용 대상 콘텐츠 크리에이터, VTuber, 출연자 카메라맨, PD, 조명 기술자 중요 : Manager도 세션 최대 Actor 수에 포함된다. 아바타 없이 참여하더라도 1 Actor로 계산되어 세션 자원을 점유한다. 이는 네트워크 부하 계산과 세션 관리를 일관되게 하기 위함이다. 2.2 역할별 기능 권한 기능 Creator Manager 비고 아바타 인스턴스화 ✅ ❌ 핵심 차이점 모션캡처 장비 연결 ✅ ❌ Facial/Body/Hand FreeCam 카메라 ✅ ✅ 고정 카메라 (1~9) ✅ ✅ Channel Link 송신/수신 ✅ ✅ 조명 제어 ✅ ✅ 방향광 포스트 프로세싱 제어 ✅ ✅ Bloom, Color 세션 생성 ✅ ✅ Pro 이상 플랜만 (역할 무관) 월드 참가 ✅ ✅ 세션 코드로 참가 아바타 설정 패널 ✅ ❌ 트래커 설정 패널 ✅ ❌ 전체 채팅 ✅ ✅ 팀 채팅 ✅ ✅ 역할별 분리 2.3 플랜별 역할 제한 플랜 로컬 사용 세션 참가 시 역할 세션 생성 Free ✅ Manager로만 참가 ❌ Starter ✅ Manager로만 참가 ❌ Pro 이상 ✅ Creator/Manager 선택 가능 ✅ Free/Starter 플랜 제한 : 로컬에서는 Creator로 아바타/모캡 사용 가능 멀티플레이어 세션에 초대받아 참가 할 때는 Manager로만 참여 세션에서 Creator(아바타 있음)로 참여하려면 Pro 이상 플랜 필요 2.3 역할 선택 및 저장 선택 시점 회원가입 시 Creator 또는 Manager를 선택한다. 상호 배타적이며, 선택 후 계정에 고정된다. 저장 구조 위치 저장 방식 Firebase Firestore users/{userId}/isCreator (boolean) 로컬 캐시 UserData.IsCreator 네트워크 동기화 NetworkPlayer.IsCreator (RPC) 네트워크 동기화 월드 입장 시 RPC를 통해 모든 접속자에게 역할이 전파된다. 이를 통해: 플레이어 목록에서 역할별 색상 표시 팀 채팅 라우팅 UI 기능 접근 제어 2.4 팀 채팅 시스템 역할 기반으로 팀 채팅이 분리된다. 채팅 모드 수신 대상 설명 전체 채팅 [All] 모든 접속자 역할 무관 Creator 팀 [Creator] Creator만 Creator 역할 사용자에게만 전송 Manager 팀 [Manager] Manager만 Manager 역할 사용자에게만 전송 시각적 구분 항목 설명 플레이어 목록 색상 Creator/Manager 별도 색상 채팅 메시지 접두사 팀 채팅 시 (Creator) 또는 (Manager) 표시 채팅 입력 모드 표시 [All] / [Creator] / [Manager] 2.5 프로덕션 워크플로우 가상 방송 스튜디오 시나리오 역할 담당자 주요 업무 Creator 출연자 아바타 연기, 모션캡처 수행 Manager PD 카메라 스위칭, 방송 송출 결정 Manager 카메라맨 A CAM 1~3 촬영 Manager 카메라맨 B CAM 4~6 촬영 Manager 카메라맨 C CAM 7~9 촬영 Manager 조명 기술자 방향광, 포스트 프로세싱 조절 2.6 테넌트 내 권한 체계 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시, 기존 Creator/Manager 역할 외에 테넌트 내 관리 권한 체계 가 추가된다. Creator/Manager는 프로덕션 워크플로우 역할이고, Owner/Admin/Member는 테넌트 내 에셋/멤버 관리 권한이다. 테넌트 관리 권한 (검토 중) 권한 설명 주요 기능 Owner 테넌트 소유자 (최초 생성자) 모든 권한 + 테넌트 삭제 + 멤버 관리 Admin 관리자 에셋 관리 + 멤버 초대 (Owner 제외) Member 일반 멤버 에셋 사용 + 세션 참여 역할 체계 관계 차원 역할 용도 프로덕션 워크플로우 Creator / Manager 월드 내 기능 접근 (아바타, 카메라, 모캡) 테넌트 관리 Owner / Admin / Member 에셋/멤버/구독 관리 권한 한 사용자는 두 차원의 역할을 동시에 갖는다. 예: Creator이면서 Admin, Manager이면서 Member 등. 3. 설계 시 고려사항 3.1 역할 고정 정책 역할은 회원가입 시 1회 선택하며 변경 불가. 이는 역할 기반 리소스 할당과 UI 구성을 단순화하기 위함이다. 향후 역할 변경 기능 추가를 고려할 수 있다. 3.2 리소스 최적화 Manager는 아바타/모캡 없이 동작하므로 PC 리소스 사용이 상대적으로 낮다. 프로덕션 환경에서 카메라맨/PD 용도의 PC에 최적화된 구성이 가능하다. 3.3 Channel Link와 역할 Channel Link는 역할에 관계없이 동등한 기능을 제공한다. Creator와 Manager 모두 카메라 송출/수신이 가능하다. 4. 엣지 케이스 및 예외 처리 상황 대응 Free 플랜에서 세션 생성 시도 UI에서 버튼 비활성화, 업그레이드 안내 Manager가 아바타 설정 접근 로비에서 아바타/트래커 패널 숨김 Creator 없이 Manager만 세션에 존재 정상 동작 (카메라 조작만 가능) 역할 변경 요청 현재 미지원, 새 계정 생성 안내 팀 채팅에서 상대 역할 메시지 확인 팀 채팅은 같은 역할에게만 전송 5. 향후 확장 가능성 항목 설명 우선순위 역할 변경 프로필에서 역할 변경 기능 낮음 관전자 역할 방송 관전만 가능한 역할 장기 커스텀 역할 프로덕션팀별 세밀한 권한 설정 장기 역할별 라이선스 Creator/Manager 별도 가격 정책 중간 관련 문서 제품 개요 사용자 플로우 카메라 시스템 UI 기획"}, {"id": "03_Operations_02_License_System", "title": "라이선스 체계", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 미결정 쟁점", "id": "5-미결정-쟁점"}, {"title": "6. 향후 확장 가능성", "id": "6-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "라이선스 체계 1. 개요 VIRDY의 라이선스 체계는 SaaS 구독 모델을 기반으로 설계된다. Free / Starter / Pro / Studio / Enterprise 5단계 티어로 구성되며, 각 티어는 사용자 세그먼트(체험자, 입문자, 개인 크리에이터, 프로덕션 스튜디오, 기업)별 차별화된 기능과 비용 구조를 제공한다. 🚧 모든 아바타/월드 데이터는 서버에 저장 되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용한다. 2. 핵심 기획 2.1 구독 플랜 티어 항목 Free Starter Pro Studio Enterprise 대상 체험자 입문자 개인 크리에이터 중규모 팀 / 스튜디오 기업/대규모 프로덕션 방 생성 ❌ ❌ ✅ ✅ ✅ 세션 최대 Actor - - 3 6 10+ 동시 방 보유 0개 0개 1개 1개 협의 매니저 모드 수정중 (RPC 리스트업) Sync 모드 Live Live Live Live Live / Ultra 아바타 슬롯 3개 10개 50개 50개 협의 아바타 용량 제한 200MB/개 200MB/개 200MB/개 200MB/개 협의 월드 용량 제한 - 300MB 800MB 800MB 협의 상업적 사용 제한적 허용 동시 방 보유 정책 : 비용 및 운영 복잡도를 고려하여, 모든 개인 플랜(Starter/Pro/Studio)의 동시 방 보유 수는 1개로 고정 한다. 기존 세션이 있는 상태에서 새 세션 생성 시, 기존 세션 종료 후 생성하도록 안내한다. 상업적 사용 정책 : 상업적 사용이라 함은 콘서트, MV, 영상물 등 기업에서 상업적 사용을 목적으로 할 때에 제한적으로 둔다. 대체로 허용되는 수준이오나 특정 구간, 콘텐츠에서의 상업 제한이 필요할지는 검토 필요 2.2 Sync 모드 네트워크 동기화 품질은 Live 와 Ultra 두 가지 모드로 구분된다. 모드 대상 플랜 특징 용도 Live 모든 플랜 경량 모션 데이터, 비용 효율적 일반 방송, 개인 사용 Ultra Enterprise 전용 고품질 모션 데이터, 높은 대역폭 공연, 특수 연출, 전문 프로덕션 Sync 모드 설계 원칙: Sync 품질은 기술 옵션이 아닌 비용 및 계약 개념 으로 관리 현재 사용 중인 고용량 모션 데이터는 일반 사용에 부적합 Live Sync 전용으로 최적화된 경량 모션 데이터 개발 필요 2.3 스토리지 정책 모든 아바타/월드 데이터는 서버(클라우드)에만 저장 되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 로비 진입 시 서버에서 데이터를 다운로드하여 사용한다. 아바타 슬롯 수 제한은 사용자에게 직접 노출하지 않고, 내부적으로만 관리한다. 실질적으로 제한이 없는 수준(50개)으로 설정하여 사용자 경험을 해치지 않는다. 티어 아바타 보관 아바타 용량 월드 용량 비고 Free 3개 200MB/개 - 체험용, 월드 업로드 불가 Starter 10개 200MB/개 300MB 입문자용 Pro 50개 200MB/개 800MB 사실상 무제한 Studio 50개 200MB/개 800MB 팀 사용 지원 Enterprise 협의 협의 협의 맞춤 계약 2.4 Studio / Enterprise 플랜 Studio와 Enterprise 플랜은 팀 또는 기업 단위 사용을 고려한 플랜이다. 항목 Studio Enterprise 대상 규모 있는 개인 크리에이터, 소규모 팀 기업, 대규모 프로덕션 조직 관리 📋 검토 중 ✅ 조직 시트 기반 Ultra Sync ❌ ✅ (공연, 특수 연출) 맞춤 계약 ❌ ✅ Enterprise 조직 시트 : 관리자가 멤버를 이메일로 초대하여 시트 할당 어드민 페이지에서 멤버 추가/제거/권한 관리 시트별 권한 할당 가능 Studio 조직 시트 검토 사항 : Studio는 기업뿐 아니라 개인 크리에이터도 사용 가능 개인 방송인에게 조직 관리 기능 제공이 불필요할 수 있음 조직 시트 제공 여부 추가 논의 필요 2.5 Actor 및 Seat 개념 플랜별 Actor 수 제한은 서버 측에서 검증되며, 유료 테넌트에는 Seat(멤버 초대 가능 수) 개념이 도입된다. Actor 개념 Actor 는 아바타 + 트래커 조합의 단위이다. 1명의 사용자가 여러 개의 Actor를 동시에 운용할 수 있다. 용어 설명 개인 Actor 수 한 사용자가 자신의 PC에서 동시에 운용할 수 있는 Actor 수 (플랜별 상이) 세션 최대 Actor 한 세션(방)에 동시에 입장할 수 있는 총 Actor 수 (호스트 플랜 기준) 매니저(Manager)도 1 Actor로 계산 : 아바타 없이 매니저로 참여하는 사용자도 세션 최대 Actor 수에 포함된다. 이는 세션 자원 관리를 단순화하고, 네트워크 부하 계산을 일관되게 하기 위함이다. 시나리오 예시 : Pro 플랜 호스트가 세션을 생성 (세션 최대 Actor: 3) 호스트가 Actor 2개를 사용 → 남은 슬롯 1개 다른 사용자가 Creator(아바타 있음)로 참여 시: 1 Actor 차지 → 세션 가득 참 다른 사용자가 Manager(아바타 없음)로 참여 시: 동일하게 1 Actor 차지 → 세션 가득 참 플랜별 개인 Actor 수 플랜 개인 Actor 수 비고 Free 1개 단일 사용자 Starter 1개 단일 사용자 Pro 2개 권장 사양 (1 PC 기준 최적 성능) Studio 4개 고사양 PC 필요 Enterprise 6개+ 고사양 PC, 상황에 따라 워크스테이션 필요 Seat 개념 (검토 중) 항목 설명 정의 유료 테넌트의 멤버 초대 가능 수 적용 범위 유료 플랜 (Enterprise 중심) 관리 테넌트 Owner/Admin이 Seat 할당 및 초대 2.6 방 생성 및 세션 제한 비용 및 운영 복잡도를 고려하여, 계정당 방 보유 수는 1개로 고정 한다. 제한 항목 Free Starter Pro Studio Enterprise 동시 세션 생성 0 0 1 1 협의 세션 최대 Actor - - 3 6 10+ 세션 유지 조건: Pro 이상 플랜 사용자 가 최소 1명 이상 접속 중일 때만 세션 유지 Free/Starter 사용자만 남은 세션은 \"0명\" 취급 → 10분 유예 후 파기 세션 소유자 퇴장 시 남은 Pro 이상 플랜 사용자 에게 소유권 자동 이전 Creator/Manager 역할 구분 없이 플랜 등급만 확인 Pro 플랜 Manager도 세션 소유권 이전 대상에 포함됨 세션 권한 이전 시나리오 : Pro Creator 2명 + Pro Manager 1명이 세션에 참가 중 Pro Creator 2명이 모두 퇴장 → Pro Manager에게 세션 소유권 이전 Pro Manager는 Pro 플랜이므로 세션 유지 (10분 유예 적용 안 됨) 이후 Pro Manager도 퇴장하면 → Free/Starter만 남으면 10분 유예 후 세션 종료 세션 관리 기능: 유료 플랜 사용자는 로비에서 \"내 세션\" 패널을 통해 활성 세션 관리 세션 리스트 조회, 재접속, 강제 종료 가능 기존 세션이 있는 상태에서 새 월드 생성 시 : 기존 세션 강제 종료 안내 → 확인 후 새 세션 생성 세션 생명주기 상세 정책은 데이터 생명주기 참조 2.7 Free / Starter 플랜 설계 원칙 Free 플랜 은 체험용으로, 기능 및 사용성에 제한을 두어 유료 전환을 유도한다. Starter 플랜 은 월 구독 중 가장 저렴한 옵션으로, 편안하게 사용할 수 있는 입문 버전이다. 항목 Free Starter 방 생성 ❌ ❌ 세션 참가 ✅ (매니저로만) ✅ (매니저로만) 세션 참가 시 역할 Manager 전용 Manager 전용 로컬 사용 ✅ ✅ 아바타 슬롯 3개 10개 월드 업로드 ❌ ✅ 트래커 사용 ✅ (로컬) ✅ (로컬) 채팅 참여 ✅ ✅ 상업적 사용 ❌ ❌ Free / Starter 세션 참가 제한 : Free/Starter 사용자는 로컬에서만 Creator(아바타 있음)로 사용 가능 멀티플레이어 세션에 초대받아 참가할 때는 Manager(아바타 없음)로만 참여 가능 Manager로 참여해도 1 Actor로 계산 되어 세션 최대 Actor에 포함됨 세션 내에서 카메라 조작, 채팅 등 Manager 기능은 모두 사용 가능 Free → Starter/Pro 전환 유도 전략 (검토 중) : Free 플랜에서 충분히 기능을 체험할 수 있지만, 다음과 같은 제한으로 유료 전환을 유도한다: 제한 방식 설명 장점 단점 방 생성 불가 초대받아서만 참여 가능 명확한 차별점 멀티가 필요없는 유저라면 제한이 아님 워터마크 화면에 VIRDY 로고 표시 바이럴 효과 사용자 불편 기능 잠금 일부 고급 기능 잠금 (예: 조명 제어) 핵심 기능은 체험 가능 제한 기준 설정 어려움 📋 각 플랜의 구체적인 제한 범위는 추가 논의가 필요하다. 2.8 가격 정책 (검토 중) 모델 설명 상태 SaaS 구독 월간/연간 구독 📋 주력 검토 3. 설계 시 고려사항 3.1 비용 산정 원칙 비용 산정은 항상 최악의 경우(Worst Case) 를 기준으로 고려한다. 비용 요소 중요도 설명 Photon 서버 비용 높음 동시 접속자 수, 세션 수에 비례 다운로드 트래픽 높음 월드/아바타 다운로드 (현재 1GB당 약 150원) 스토리지 비용 중간 비활성 계정 데이터 장기 보관 시 누적 상세 비용 산출, 플랜별 마진 분석, 손익분기점(BEP)은 비용 분석 참조 3.2 리전별 비용 차이 Firebase Storage 다운로드 비용은 리전에 따라 다르므로, 서비스 리전 선택 시 비용 확인 필요. 3.3 플랜 등급 하락 정책 Enterprise → 하위 플랜으로 등급 하락 시: 정책 설명 즉시 삭제 ❌ 부적절 유예 기간 일정 기간 데이터 다운로드 가능 Archive/Frozen 아카이브로 데이터 이동 (서버 비용 감축) 장기 미복귀 6~12개월 후 데이터 삭제 상세 정책은 데이터 생명주기 문서 참조 3.4 결제 시스템 (미구현) 현재 코드베이스에 결제/빌링 시스템이 없다. 향후 구현 시 고려할 사항: Stripe 또는 결제 게이트웨이 통합 구독 상태 관리 (Firebase Functions) 라이선스 키 발급 및 검증 평가판 기간 로직 Steam DRM / 가격 정책 연동 3.5 보안 취약점 취약점 설명 클라이언트 측 제한만 적용 서버 측 검증 없음 메모리 해킹 가능 MaxActorSize 런타임 변경 가능 향후 서버 측 라이선스 검증, 암호화된 라이선스 토큰, 주기적 라이선스 확인이 필요하다. 4. 엣지 케이스 및 예외 처리 상황 대응 무료 플랜에서 방 생성 시도 UI에서 비활성화 + 업그레이드 안내 구독 만료 시 데이터 손실 없이 기능 차단, 갱신 안내 동시 방 한도 초과 새 방 생성 차단, 기존 방 종료 유도 Enterprise → Pro 등급 하락 유예 기간 제공, 데이터 아카이브 결제 실패 유예 기간 제공 후 기능 제한 Ultra Sync 네트워크 조건 미달 Live로 자동 전환 + 안내 5. 미결정 쟁점 항목 상태 비고 Free 플랜 제한 방식 📋 논의 필요 워터마크 / 세션 시간 제한 / 기능 잠금 등 Studio 플랜 조직 시트 제공 여부 📋 논의 필요 개인 크리에이터에게 불필요할 수 있음 구독 종료 후 데이터 보관 기간 📋 논의 필요 Google Drive 등 벤치마킹 Enterprise 시트 구조의 구체적 운영 방식 📋 논의 필요 어드민 페이지 기능 범위 플랜별 가격 📋 논의 필요 - Starter/Pro 플랜의 정확한 포지셔닝 📋 논의 필요 Free와 Pro 사이 차별점 명확화 6. 향후 확장 가능성 항목 설명 우선순위 5티어 플랜 기능 제한/구현 Free/Starter/Pro/Studio/Enterprise 높음 결제 시스템 Stripe/Steam 결제 연동 높음 조직 관리 페이지 Enterprise 어드민 페이지 (멤버 초대/관리) 높음 라이선스 서버 서버 측 라이선스 검증 중간 평가판 기간 한정 Pro/Studio 체험 중간 Ultra Sync 구현 Enterprise 전용 고품질 동기화 중간 관련 문서 제품 개요 사용자 역할 보안 시스템 데이터 생명주기 리스크 관리 계정 시스템 네트워크 시스템"}, {"id": "03_Operations_03_Security", "title": "보안 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "보안 시스템 1. 개요 VIRDY의 보안 시스템은 인증, 데이터 보호, 아바타 저작권 보호를 중심으로 설계된다. 현행 시스템은 Firebase 서비스(Auth, Firestore 보안 규칙, Functions)를 기반으로 하며, 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에 따라 JWT 기반 인증, Photon Webhook 보안, Signed URL 기반 파일 접근 제어가 추가될 수 있다. 2. 핵심 기획 2.1 보안 아키텍처 계층 서비스 역할 인증 Firebase Auth 이메일/비밀번호 인증, 토큰 관리 데이터 보호 Firestore 보안 규칙 사용자/월드/아바타 데이터 접근 제어 서버 로직 Firebase Functions 서버 측 검증, 민감 작업 처리 파일 저장 Firebase Storage 보안 규칙 기반 파일 접근 제어 아바타 보호 VRM 암호화 아바타 파일 암호화 저장 2.2 인증 시스템 이메일 기반 인증 단계 동작 회원가입 Firebase Functions (signUpV2)를 통해 계정 생성 이메일 인증 Firebase Auth 이메일 인증 발송 → 인증 완료 필수 로그인 이메일 + 비밀번호로 인증, 이메일 인증 완료 확인 사용자명 로그인 사용자명 → Firebase Function으로 이메일 조회 → 이메일 로그인 비밀번호 리셋 Firebase Auth 비밀번호 리셋 이메일 발송 인증 토큰 항목 설명 토큰 방식 Firebase Auth 토큰 (자동 갱신) 세션 유지 Firebase SDK가 토큰 수명주기 관리 로그아웃 Firebase Auth 로그아웃 → 토큰 무효화 2.3 Firestore 보안 규칙 Firestore 보안 규칙을 통해 데이터 접근을 제어한다. 사용자 데이터 규칙 설명 읽기 인증된 사용자만 자신의 데이터 읽기 쓰기 Firebase Functions를 통해서만 수정 (직접 쓰기 차단) 월드 데이터 유형 읽기 규칙 쓰기 규칙 Public 월드 모든 인증 사용자 제작자만 (Functions 경유) Private 월드 제작자만 제작자만 (Functions 경유) Private+ 월드 제작자 + sharedWith 목록 제작자만 (Functions 경유) 아바타 데이터 규칙 설명 읽기 소유자만 쓰기 소유자만 타인 접근 Firebase 보안 규칙으로 차단 2.4 Firebase Functions 민감한 작업은 클라이언트에서 직접 수행하지 않고 Firebase Functions를 통해 서버 측에서 처리한다. 함수 용도 signUpV2 회원가입 (계정 생성 + Firestore 저장) getEmailByUsername 사용자명 → 이메일 조회 saveWorld 월드 메타데이터 저장 deleteWorld 월드 삭제 (Firestore + Storage) getWorldData 월드 메타데이터 조회 2.5 아바타 파일 보호 VRM 암호화 항목 설명 대상 VRM 아바타 파일 업로드 시 암호화 후 Firebase Storage 저장 로컬 캐시 암호화 상태로 캐시 저장 로드 시 복호화 후 메모리에서 사용 목적 파일 직접 추출 방지, 저작권 보호 VRM 저작권 정보 존중 메타데이터 설명 AllowedUser 허용 사용자 범위 ViolentUsage 폭력적 사용 허용 여부 SexualUsage 성적 사용 허용 여부 CommercialUsage 상업적 사용 허용 여부 2.6 네트워크 보안 Photon 세션 항목 설명 세션 접근 세션 코드를 아는 사용자만 참가 로비 분리 버전별 로비 분리 (VIRDY.{버전}) 데이터 전송 Photon 서버를 통한 암호화 전송 Chat 보안 항목 설명 인증 Firebase UserId로 Photon Chat 인증 개인 메시지 초대/따라가기/데려오기 등 명령은 Private Message로 전송 팀 채팅 역할 기반 필터링 (클라이언트 측) 2.7 Firebase Storage 보안 항목 설명 아바타 파일 소유자만 읽기/쓰기 월드 파일 공개 설정에 따라 접근 제어 썸네일 월드 공개 설정에 따라 공개 전송 HTTPS 암호화 2.8 보안 아키텍처 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시 보안 계층이 다음과 같이 강화된다. JWT 기반 인증 보안 (검토 중) 항목 설명 Access Token 1시간 만료, API 호출마다 서명 검증 Refresh Token 7~30일 만료 (미확정), 안전한 로컬 저장소 보관 JWT Payload userId, tenantId, role, subscriptionPlan 포함 서버 측 검증 모든 API 요청에서 JWT 서명/만료/권한 검증 수행 현행 Firebase Auth 토큰과 달리, JWT에 구독 플랜과 역할 정보를 직접 포함하여 API 호출마다 서버 측에서 권한을 검증할 수 있다. Photon Custom Authentication (검토 중) Photon 세션 접속 시 VIRDY Backend를 통한 인증을 필수로 설정하여, AppID 탈취로 인한 무단 사용을 방지한다. 단계 동작 1 Unity Client가 Photon에 연결 요청 (JWT 포함) 2 Photon이 Backend로 Auth 검증 요청 (JWT 전달) 3 Backend에서 JWT 서명/만료/구독 확인 4 인증 결과를 Photon에 반환 5 Photon이 Client에 연결 허용/거부 Photon Webhook 보안 (검토 중) 항목 설명 Webhook Secret Photon → Backend 요청 시 Secret으로 요청 검증 이벤트 종류 Room 생성/종료, Player 입장/퇴장 Backend 처리 세션 상태 DB 저장, 참가자 수 관리 Cloudflare R2 Signed URL 보안 (검토 중) 항목 설명 업로드 Backend에서 시간 제한 Signed URL 발급 → 클라이언트가 R2에 직접 업로드 다운로드 Backend에서 권한 확인 후 Signed URL 발급 → 클라이언트가 R2에서 직접 다운로드 Egress 비용 Cloudflare R2는 Egress 무료 (Firebase Storage 대비 비용 절감) URL 만료 시간 제한으로 URL 유출 시에도 재사용 불가 3. 설계 시 고려사항 3.1 클라이언트 측 보안 한계 현재 일부 검증이 클라이언트 측에서만 수행된다. 항목 현재 개선 방향 액터 수 제한 클라이언트 상수 서버 측 검증 추가 역할 확인 Firestore 평문 저장 난독화 또는 서버 측 검증 라이선스 빌드 타임 심볼 라이선스 서버 도입 3.2 아바타 저작권 보호 강화 VRM 파일은 암호화하지만, 메모리에서 복호화된 상태에서 추출 가능성이 있다. 추가 보호 조치: 런타임 메모리 보호 (난독화) 워터마크 삽입 DRM 수준 보호 (장기) 3.3 Firebase 의존도 보안이 Firebase 서비스에 강하게 의존하고 있다. Firebase 장애 시 전체 인증/데이터 접근이 불가하므로, 장기적으로 자체 인증 서버 백업을 고려할 수 있다. 4. 엣지 케이스 및 예외 처리 상황 대응 이메일 인증 미완료 로그인 인증 메일 재발송 안내 비밀번호 분실 Firebase Auth 리셋 이메일 발송 Firebase Auth 토큰 만료 SDK 자동 갱신 타인의 아바타 다운로드 시도 Firebase Storage 보안 규칙으로 차단 삭제된 월드 공유 링크 접근 \"월드를 찾을 수 없습니다\" 오류 Private 월드 권한 없는 접근 Firestore 보안 규칙으로 차단 암호화된 아바타 파일 손상 재다운로드 안내 세션 코드 브루트포스 4자리 코드 + 버전 로비 분리로 완화 5. 향후 확장 가능성 항목 설명 우선순위 서버 측 라이선스 검증 JWT 기반 서버 측 구독/권한 검증 높음 Photon Custom Auth Backend를 통한 Photon 접속 인증 높음 Webhook Secret 검증 Photon Webhook 요청의 무결성 검증 높음 소셜 로그인 Google, Steam 등 OAuth 연동 중간 2단계 인증 OTP 또는 인증 앱 연동 낮음 DRM 강화 아바타/월드 파일 DRM 보호 장기 런처 인증 자동 업데이트 + 토큰 인증 런처 중간 감사 로그 사용자 행동 로깅 및 모니터링 중간 관련 문서 라이선스 체계 사용자 역할 계정 시스템 데이터 생명주기 리스크 관리 아바타 시스템 네트워크 시스템"}, {"id": "03_Operations_04_Data_Lifecycle", "title": "데이터 생명주기", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 구독 상태별 데이터 처리", "id": "3-구독-상태별-데이터-처리"}, {"title": "4. 서버/멀티 세션 생명주기", "id": "4-서버멀티-세션-생명주기"}, {"title": "5. 데이터 삭제 후 서버 보관 기간", "id": "5-데이터-삭제-후-서버-보관-기간"}, {"title": "6. 설계 시 고려사항", "id": "6-설계-시-고려사항"}, {"title": "7. 엣지 케이스 및 예외 처리", "id": "7-엣지-케이스-및-예외-처리"}, {"title": "8. 미결정 쟁점", "id": "8-미결정-쟁점"}, {"title": "9. 향후 확장 가능성", "id": "9-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "데이터 생명주기 1. 개요 이 문서는 VIRDY 서비스 내 모든 데이터의 생성, 보관, 아카이브, 삭제에 대한 정책을 정의한다. 데이터 유형별로 보관 기간과 처리 방식을 명확히 하여 운영 비용을 최적화하고 사용자 자산을 보호한다. 2. 핵심 기획 2.1 데이터 유형 분류 유형 예시 복구 필요성 보관 기간 유저 자산 데이터 아바타, 월드 필수 장기 (정책에 따라) 계정 데이터 프로필, 설정, 친구 목록 필수 계정 삭제 전까지 로그성 데이터 세션 로그, 접속 기록 불필요 30~90일 실시간 세션 데이터 방 상태, 채팅 불필요 세션 종료 즉시 파기 법적/보안 로그 결제 기록, 보안 이벤트 법적 요구 법적 요구 범위 내 2.2 유저 자산 데이터 유저 자산은 바로 지우면 안 되는 데이터로, 신중한 생명주기 관리가 필요하다. 자산 저장 위치 설명 아바타 Firebase Storage VRM 파일 (암호화 저장) 월드 Firebase Storage AssetBundle 파일 메타데이터 Firestore 아바타/월드 설정, 공유 정보 2.3 로그성 데이터 복구 불가능해도 되는 데이터: 데이터 보관 기간 비고 세션 로그 30~90일 디버깅, 분석용 접속 기록 30~90일 익명화 가능 서버 성능 로그 30~90일 모니터링용 에러 로그 30~90일 버그 추적용 3. 구독 상태별 데이터 처리 3.1 구독 활성 상태 상태 데이터 처리 구독 시작 플랜에 따른 스토리지 할당 구독 유지 정상 접근 및 사용 가능 3.2 구독 중단 시 처리 플로우 구독 중단 ↓ [N일 유예 기간] 데이터 접근 가능 (읽기 전용) 아바타/월드 다운로드 가능 ↓ [유예 기간 종료] 아카이브로 데이터 이동 서버 비용 감축 (Cold Storage) ↓ [장기 미복귀: 6~12개월] 데이터 삭제 단, 로그인 시 삭제 기간 리셋 아카이브 이동 기간은 리셋하지 않음 3.3 구독 상태별 상세 정책 단계 기간 데이터 상태 사용자 액션 유예 기간 구독 종료 후 N일 읽기 전용 다운로드 가능 아카이브 유예 종료 후 Cold Storage 이동 재구독 시 복원 삭제 대기 아카이브 후 6~12개월 삭제 예정 로그인 시 기간 리셋 완전 삭제 삭제 대기 종료 영구 삭제 복구 불가 3.4 플랜 등급 하락 시 상황 처리 Enterprise → Studio 초과 슬롯 데이터 아카이브 Studio → Pro 초과 슬롯 데이터 아카이브 Pro → 무료 클라우드 데이터 아카이브, 로컬 다운로드 유도 4. 서버/멀티 세션 생명주기 용어 정리: 내부적으로는 \"세션(Session)\"이라는 기술 용어를 사용하지만, 사용자에게는 \"월드\"와 \"호스트\"라는 용어로 노출된다. 이 문서에서는 기술 구현 관점에서 \"세션\"을 사용한다. 4.1 세션 생성 및 호스트 항목 정책 세션 생성 주체 유료 플랜(Pro/Studio/Enterprise) 사용자만 생성 가능 호스트 (세션 소유자) 세션을 생성한 사용자. UI에서 👑 왕관 아이콘으로 표시 동시 세션 제한 Pro: 1개, Studio: 3개, Enterprise: 10개+ 4.2 세션 유지 조건 세션은 유료 플랜 사용자가 최소 1명 이상 접속 중일 때만 유지된다. 조건 세션 상태 유료 플랜 사용자 1명 이상 접속 ✅ 정상 유지 Free 사용자만 남음 ⚠️ \"0명\" 취급 → 10분 유예 시작 접속 인원 0명 ⚠️ 10분 유예 시작 핵심 원칙: Free 사용자는 세션 유지 인원으로 카운트되지 않음 Free 사용자만 남은 세션 = 실질적으로 \"빈 세션\"으로 취급 10분 유예 기간 내 유료 사용자 재접속 시 세션 유지 4.3 호스트 퇴장 시 처리 호스트가 퇴장(팅김/나감)할 때의 처리 규칙: 상황 처리 호스트 퇴장 + 다른 유료 사용자 있음 즉시 이전하지 않음 → 10분 유예 시작 호스트 퇴장 + Free 사용자만 남음 10분 유예 후 세션 파기 호스트 퇴장 + 아무도 없음 10분 유예 후 세션 파기 호스트 퇴장 후 유예 기간 (10분): 호스트가 재접속하면 그대로 호스트 유지 유예 기간 종료 시 남은 유료 사용자에게 호스트 자동 이전 Free 사용자만 남은 경우 세션 파기 4.4 호스트 이전 정책 4.4.1 자동 이전 (유예 기간 종료 시) 호스트가 10분 유예 기간 내 복귀하지 않으면, 남은 유료 사용자 중 한 명에게 자동 이전된다. 이전 대상 선정 우선순위: 1. 동시 세션에 여유가 있는 사용자 (현재 호스트 중인 세션 수 Studio > Pro) 3. 접속 시간이 가장 오래된 사용자 이전 불가 시: 모든 유료 사용자가 동시 세션 제한에 걸린 경우 → 세션 파기 4.4.2 강제 이전 (호스트가 새 월드 생성 시) 호스트가 유예 기간 중 새 월드를 열려고 할 때: 단계 동작 1 \"월드 열기\" 시도 2 동시 세션 제한 확인 → 기존 세션 존재 3 \"기존 월드 닫기\" 확인 팝업 4 확인 시: 남은 유료 사용자에게 호스트 이전 후 새 세션 생성 핵심: 호스트 입장에서는 \"월드 닫기\"지만, 실제로는 남은 유료 사용자에게 호스트가 이전되는 동작이다. 4.5 호스트 표시 (UI) 요소 설명 왕관 아이콘 👑 플레이어 목록에서 호스트 옆에 표시 실시간 반영 호스트 이전 시 왕관도 즉시 이동 이전 알림 \"호스트가 변경되었습니다\" 토스트 메시지 4.6 세션 파기 조건 조건 유예 기간 결과 유료 사용자 0명 (실질적 0명) 10분 세션 파기 물리적 접속 인원 0명 10분 세션 파기 호스트가 월드 닫기 (이전 대상 없음) 즉시 세션 파기 호스트가 월드 닫기 (이전 대상 있음) 즉시 호스트 이전 후 세션 유지 유예 기간 동작: 10분 카운트다운 시작 유예 기간 내 유료 사용자 재접속 시 카운트다운 리셋 Free 사용자 접속은 카운트다운에 영향 없음 10분 경과 시 세션 자동 파기 또는 호스트 이전 4.7 세션 관리 UI 참고: 세션 관리 UI 구성은 현재 검토 중이다. 상세 내용은 UI 기획 참조. 4.8 세션 메타데이터 세션 종료 후에도 보존되는 데이터: 데이터 저장 방식 설명 룸 설정 계정 데이터 방 생성 시 재사용 가능 권한 설정 계정 데이터 매니저 권한 등 프리셋 계정 데이터 카메라, 조명 프리셋 5. 데이터 삭제 후 서버 보관 기간 데이터 유형 삭제 요청 후 보관 비고 실시간 세션 데이터 종료 즉시 파기 - 로그성 데이터 최대 90일 디버깅/분석 후 파기 유저 자산 데이터 N일 보관 후 파기 복구 요청 대비 법적/보안 로그 법적 요구 범위 내 결제, 보안 이벤트 6. 설계 시 고려사항 6.1 비용 최적화 전략 설명 Cold Storage 활용 아카이브 데이터는 저비용 스토리지로 이동 개수 기반 제한 용량(GB)이 아닌 개수로 관리하여 예측 가능성 확보 자동 정리 비활성 계정 데이터 자동 아카이브/삭제 6.2 사용자 경험 원칙 설명 데이터 손실 방지 구독 종료 시 즉시 삭제 금지 충분한 유예 기간 다운로드 및 백업 시간 제공 명확한 안내 삭제 예정 시 사전 알림 6.3 벤치마킹 대상 서비스 참고 정책 Google Drive 구독 종료 후 데이터 보관 정책 Dropbox 계정 비활성 시 처리 정책 Adobe Creative Cloud 플랜 다운그레이드 시 파일 처리 7. 엣지 케이스 및 예외 처리 상황 대응 구독 종료 직전 대용량 업로드 유예 기간 내 다운로드 안내 아카이브 중 재구독 데이터 즉시 복원 삭제 대기 중 로그인 삭제 기간 리셋 (아카이브 기간은 유지) 법적 요청으로 데이터 보존 필요 삭제 일시 중지, 법적 절차 따름 사용자 명시적 삭제 요청 즉시 접근 차단, 유예 후 완전 삭제 8. 미결정 쟁점 항목 상태 비고 유예 기간 구체적 일수 📋 논의 필요 7일? 14일? 30일? 아카이브 후 삭제까지 기간 📋 논의 필요 6개월? 12개월? 0명 세션 유지 시간 ✅ 결정됨 10분 유예 후 파기 호스트 퇴장 후 유예 시간 ✅ 결정됨 10분 유예 후 호스트 이전 또는 파기 Cold Storage 구현 방식 📋 논의 필요 Firebase 외 옵션 검토 9. 향후 확장 가능성 항목 설명 우선순위 자동 아카이브 시스템 비활성 데이터 자동 이동 높음 데이터 내보내기 사용자 요청 시 전체 데이터 다운로드 중간 삭제 알림 시스템 삭제 예정 사전 이메일 알림 중간 데이터 복원 UI 아카이브 데이터 셀프 복원 낮음 관련 문서 라이선스 체계 계정 시스템 보안 시스템 리스크 관리"}, {"id": "03_Operations_05_Risk_Management", "title": "리스크 관리", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 리스크 분류", "id": "2-리스크-분류"}, {"title": "3. 리스크 상세", "id": "3-리스크-상세"}, {"title": "4. 리스크 우선순위", "id": "4-리스크-우선순위"}, {"title": "5. 설계 시 고려사항", "id": "5-설계-시-고려사항"}, {"title": "6. 미결정 쟁점", "id": "6-미결정-쟁점"}, {"title": "7. 향후 확장 가능성", "id": "7-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "리스크 관리 1. 개요 이 문서는 VIRDY 서비스 운영 시 막아야 할 위험(Risk)을 식별하고, 각 위험에 대한 대응 방안을 정의한다. 비용, 악용, 네트워크 품질, 신뢰 관련 리스크를 체계적으로 관리하여 서비스 안정성과 수익성을 확보한다. 2. 리스크 분류 분류 리스크 번호 설명 비용 관련 R1, R5 서버/스토리지 비용 폭주 악용 관련 R2, R3, R9 무료/저책임 계정의 시스템 악용 UX 관련 R4 정상 사용자 피해 네트워크 품질 R6, R7, R8, R11 동기화 품질 저하 운영 관련 R10 책임 소재 불명확 3. 리스크 상세 R1. 방 생성 남발로 인한 서버 및 네트워크 비용 폭주 항목 내용 위험 방 생성/종료가 잦을 경우 Photon 및 서버 비용이 예측 불가능해짐 시나리오 \"방 생성 후 이탈\"을 반복하는 패턴 악용 영향 실제 사용 인원 대비 과도한 리소스 사용 대응 방안: 플랜별 동시 방 생성 수 제한 (무료: 0, Pro: 1, Studio: 3, Enterprise: 10+) 방 생성 후 최소 유지 시간 설정 검토 상세 비용 시나리오 및 Worst Case 분석은 비용 분석 참조 R2. 방 파주기(생성 후 이탈) 악용 항목 내용 위험 방을 생성한 뒤 다른 사용자를 위해 남겨두고 이탈하는 행위 반복 시나리오 사실상 무제한 방 생성 효과 발생 영향 방 생성 제한이 무력화됨 대응 방안: ✅ 호스트 유예 정책 : 호스트 퇴장 시 즉시 이전하지 않고 10분 유예 ✅ 재접속 우선 : 유예 기간 내 호스트 복귀 시 그대로 호스트 유지 ✅ 호스트 이전 조건 : 유예 종료 시 + 다른 유료 사용자가 있을 때만 호스트 자동 이전 ✅ Free 사용자 \"0명\" 취급 : Free 사용자만 남으면 10분 유예 후 월드 자동 종료 ✅ 새 월드 열기 시 이전 : 호스트가 새 월드를 열면 기존 월드의 호스트가 남은 유저에게 이전 결론: 호스트 유예 정책 + 동시 월드 제한으로 악용 방지 및 재접속 편의성 확보 R3. 무료/저책임 계정의 운영 기능 악용 항목 내용 위험 비용·운영 책임을 지지 않는 계정이 운영 기능을 사용 시나리오 무료 계정이 방 생성 또는 운영 기능 악용 영향 시스템 악용, 품질 저하, 유료/무료 플랜 간 책임 구조 붕괴 대응 방안: Free 유저는 방생성이 불가능하기에 해당 이슈에서 제외 Session에 함께 있는 유저들은 상호간 신뢰를 바탕으로 함께 접속된 유저들, 그들간의 악용에 대한 이슈는 크게 없을 것으로 판단됨. 하지만 Session의 코드를 뚫고 들어오는 유저가 있을 수 있음. 코드 수 4자리 -> 더 늘리는 것 고려 R4. 동시 방 제한으로 인한 정상 사용자 피해 항목 내용 위험 이미 이탈한 방에 다른 사용자가 남아있어 새 방 생성이 제한됨 시나리오 개인 사용과 운영 목적 사용 구분 없이 제한 적용 영향 정상 사용자 불만 증가 대응 방안: ✅ 호스트 유예 정책 : 퇴장 시 즉시 이전되지 않으므로, 재접속 시 월드 코드 없이 복귀 가능 ✅ 새 월드 열기 시 자동 이전 : 기존 월드 닫기 → 남은 유저에게 호스트 이전 (모두 퇴장 X) ✅ 0명 월드 자동 종료 : 유료 사용자 0명 시 10분 유예 후 자동 종료 ✅ 플레이어 목록에 호스트 표시 : 👑 왕관으로 현재 호스트 명확히 표시 📋 활성 월드 리스트 (검토 중) : 내 월드/친구 월드 관리 UI (UX 협의 필요) 결론: 호스트 유예 + 자동 이전 정책으로 재접속 편의성 확보, 불만 최소화 R5. 구독 종료 후 데이터(월드/아바타) 비용 누적 항목 내용 위험 구독 종료된 계정의 데이터가 장기 보관되어 비용 유발 시나리오 비활성 계정이 지속적인 스토리지 비용 발생 영향 정리 기준 없을 경우 비용 누적 대응 방안: 데이터 생명주기 관리 정책 수립 (→ 데이터 생명주기 참조) 아카이브/Frozen 개념 도입 6~12개월 장기 미복귀 시 삭제 R6. 네트워크 품질 미달로 인한 세션 성립 실패 항목 내용 위험 특정 리전 또는 사용자 환경에서 RTT, 패킷 손실, 지터가 기준 이하 시나리오 멀티 세션이 불안정하거나 빈번히 끊김 영향 Live Sync조차 유지되지 않는 환경은 서비스 실패로 이어짐 대응 방안: 네트워크 품질 측정 및 사전 경고 시스템 최소 품질 요구사항 명시 및 안내 리전 선택 옵션 제공 검토 R7. Ultra Sync 유지 실패로 인한 Enterprise 신뢰 하락 항목 내용 위험 Enterprise 플랜에서 Ultra Sync 선택 후 네트워크 조건 문제로 유지 불가 시나리오 고가 플랜 구매 후 약속된 품질 제공 실패 영향 \"비싸게 팔고 안 된다\"는 인식 형성 대응 방안: Ultra → Live 자동 전환 및 안내 시스템 사전 네트워크 테스트 도구 제공 적절한 보상 구조 검토 (크레딧, 환불 정책) R8. 세션 Sync Mode 혼선으로 인한 품질 불일치 항목 내용 위험 Ultra / Live Sync가 명확한 세션 상태로 관리되지 않음 시나리오 참여자마다 서로 다른 동기화 방식이 섞임 영향 디버깅 불가, 품질 불균형, 사용자 불만 대응 방안: 세션 생성 시 Sync Mode 명시적 설정 세션 참가 시 모드 확인 및 동의 모드 불일치 시 참가 거부 또는 경고 R9. 클라이언트 분기 기반 Sync Mode 악용 가능성 항목 내용 위험 Photon Shared 구조상 서버가 클라이언트 송신 데이터를 완전히 검증할 수 없음 시나리오 악의적 클라이언트가 Live 세션에서 Ultra 수준 패킷 송신, 비정상 고빈도 데이터 전송 영향 리소스 낭비 및 품질 교란 대응 방안: 클라이언트 측 데이터 전송 빈도 제한 비정상 패턴 감지 및 경고 심각한 악용 시 세션에서 퇴장 처리 R10. Sync Mode 결정 주체 불명확으로 인한 책임 붕괴 항목 내용 위험 Ultra / Live Sync 전환 권한이 명확히 정의되지 않음 시나리오 임의 전환, 사용자 간 분쟁, CS 대응 혼선 영향 \"누가 결정했는가\"가 불명확해 운영 책임 붕괴 대응 방안: Sync Mode 결정 권한 명확화 (방장/세션 소유자) 변경 이력 로깅 변경 시 참여자 알림 R11. 멀티 동기화 품질 저하로 인한 서비스 평판 악화 항목 내용 위험 글로벌 환경에서 멀티 품질 이슈가 반복됨 시나리오 \"VIRDY는 멀티가 불안정하다\"는 인식 고착 영향 실제 원인이 네트워크/환경이더라도 브랜드 신뢰에 직접적 타격 대응 방안: 품질 모니터링 대시보드 구축 문제 발생 시 원인 명확화 (VIRDY vs 네트워크 환경) 사용자 교육 및 가이드 제공 최소 요구사항 명시 4. 리스크 우선순위 우선순위 리스크 이유 높음 R1, R5 직접적인 비용 영향 높음 R7, R11 브랜드 신뢰 및 Enterprise 고객 이탈 중간 R2, R3, R4 악용 방지 및 UX 중간 R6, R8 서비스 품질 낮음 R9, R10 운영 복잡도 5. 설계 시 고려사항 5.1 비용 관점 비용 산정은 항상 Worst Case 기준 주요 비용 요소: Photon 서버, 다운로드 트래픽, 스토리지 다운로드 트래픽이 가장 큰 비용 요소 5.2 악용 방지 관점 기능 제한은 클라이언트 + 서버 양쪽에서 검증 로깅 및 모니터링으로 비정상 패턴 감지 점진적 제재 (경고 → 기능 제한 → 계정 정지) 5.3 사용자 경험 관점 정상 사용자가 피해받지 않도록 제한 설계 명확한 안내 및 업그레이드 유도 제한에 걸렸을 때 해결 방법 제공 6. 미결정 쟁점 항목 상태 비고 방 생성 후 최소 유지 시간 📋 논의 필요 - 0명 월드 자동 종료 시간 ✅ 결정됨 10분 유예 후 종료 호스트 퇴장 후 유예 시간 ✅ 결정됨 10분 유예 후 이전 또는 종료 Ultra Sync 실패 시 보상 정책 📋 논의 필요 - 비정상 클라이언트 감지 기준 📋 논의 필요 - 활성 월드 리스트 UI 📋 UX 협의 필요 유수진님과 논의 필요 7. 향후 확장 가능성 항목 설명 우선순위 실시간 모니터링 대시보드 비용/품질 실시간 추적 높음 자동 제재 시스템 비정상 패턴 자동 감지 및 조치 중간 네트워크 품질 테스트 도구 사전 환경 검증 중간 리스크 리포트 자동화 주간/월간 리스크 현황 리포트 낮음 관련 문서 라이선스 체계 데이터 생명주기 계정 시스템 네트워크 시스템"}, {"id": "03_Operations_06_Account_System", "title": "계정 시스템", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 계정 생명주기", "id": "3-계정-생명주기"}, {"title": "4. 외부 연동 생명주기", "id": "4-외부-연동-생명주기"}, {"title": "5. 구독과 계정의 관계", "id": "5-구독과-계정의-관계"}, {"title": "6. 설계 시 고려사항", "id": "6-설계-시-고려사항"}, {"title": "7. 엣지 케이스 및 예외 처리", "id": "7-엣지-케이스-및-예외-처리"}, {"title": "8. 미결정 쟁점", "id": "8-미결정-쟁점"}, {"title": "9. 향후 확장 가능성", "id": "9-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "계정 시스템 1. 개요 이 문서는 VIRDY의 계정 생성, 인증, 연동, 삭제에 대한 정책을 정의한다. Steam을 포함한 외부 인증 수단과 VIRDY 내부 계정의 관계, 계정 생명주기, 데이터 귀속 정책을 명확히 한다. 🚧 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에 따라 인증 흐름이 변경될 수 있다. 전환 검토 내용은 본 문서 2.5절 참조. 2. 핵심 기획 2.1 계정 구조 VIRDY는 내부 계정 과 외부 인증 수단 을 분리하여 관리한다. 구분 역할 예시 VIRDY 계정 서비스 데이터의 소유 주체 아바타, 월드, 설정, 친구 목록 외부 인증 수단 로그인 방법 Steam, 이메일/비밀번호, (향후) Google 핵심 원칙: 외부 계정은 인증 수단일 뿐 , 서비스 데이터의 소유는 VIRDY 계정에 귀속 Steam 연동 해제, 로그인 불가 상황에서도 VIRDY 계정으로 데이터 복구 가능 2.2 Steam 연동 최초 접속 시 자동 계정 생성 단계 동작 1 Steam으로 VIRDY 최초 실행 2 Steam ID 확인 3 VIRDY 계정 자동 생성 4 저장 데이터: Steam ID, 생성 시각, 접속 지역(국가) 저장해야 하는 데이터 계정 복구 및 분쟁 해결을 위해 다음 데이터를 저장한다: 데이터 용도 최초 생성 시 Steam ID 계정 소유권 확인 최초 생성 시각 계정 생성 시점 증명 최초 접속 지역(국가) 분쟁 시 참고 자료 Steam 연동 해제 시 상황 처리 연동 해제 요청 VIRDY 계정은 유지, Steam 연동만 해제 연동 끊긴 계정 삭제 대상 아님, 복구 가능 상태 유지 재연동 동일 Steam ID로 재연동 가능 2.3 이메일 연동 유료 결제 시 이메일 필수 상황 이메일 연동 무료 사용 (Steam만) 선택 유료 결제/구독 필수 이유: 결제 영수증 발송 구독 상태 알림 계정 복구 수단 확보 법적 커뮤니케이션 채널 2.4 인증 방식 우선순위 우선순위 인증 방식 상태 1 Steam 로그인 ✅ 지원 예정 2 이메일/비밀번호 ✅ 현재 지원 3 Google OAuth 📋 계획 2.5 인증 흐름 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시 인증 흐름이 다음과 같이 변경될 수 있다. 전환 후 인증 흐름 (검토 중) Steam → Firebase Auth → Backend JWT 방식으로 3단계 인증을 거치는 구조이다. 단계 동작 1 Steam SDK로 로그인하여 Steam Token 획득 2 Firebase Auth에 Custom Token 요청 → Firebase Token 수신 3 Backend `/api/v1/auth/login`에 Firebase Token 전달 4 Backend에서 Firebase Token 검증 후 JWT (Access + Refresh) 발급 5 신규 사용자인 경우: VIRDY Account 자동 생성 + Default Tenant 생성 + Owner 권한 부여 전환 후 토큰 관리 (검토 중) 토큰 만료 용도 저장 위치 Access Token 1시간 API 호출 인증 (Authorization: Bearer) 메모리 (Unity) Refresh Token 7~30일 (미확정) Access Token 갱신 로컬 안전 저장소 전환 후 계정 복구 흐름 (검토 중) 유료 구독자는 구독 전환 시 이메일 인증이 필수이므로, Steam 계정 분실 시에도 이메일 본인인증을 통해 새 Steam 계정을 연동하여 구독을 복구할 수 있다. 단계 동작 1 Steam 계정 분실 발생 2 VIRDY 복구 페이지에서 복구 요청 3 등록된 이메일로 본인인증 4 새 Steam 계정과 기존 VIRDY Account 연동 5 구독 및 데이터 복구 완료 전환 후 Tenant 개념 도입 (검토 중) 개념 정의 VIRDY Account VIRDY 내부 계정 (사용자에게 비노출) Tenant 사용자/조직의 논리적 작업 공간 Display Name 사용자가 설정하는 표시 이름 (닉네임) 신규 사용자 생성 시 자동으로 Default Tenant가 생성되며, 모든 에셋과 설정은 Tenant 단위로 격리된다. 향후 기업 사용자가 여러 Tenant에 소속될 수 있도록 Tenant 전환 기능을 검토 중이다. 3. 계정 생명주기 3.1 생성 시점 방법 동작 Steam 첫 로그인 VIRDY 계정 자동 생성 이메일 회원가입 이메일 인증 후 계정 생성 3.2 활성 상태 정상적으로 로그인하여 서비스를 사용하는 상태. 3.3 비활성 시점 조건 상태 로그인 수단 전부 끊김 비활성 (복구 대기) 장기 미접속 비활성 (데이터 생명주기 정책 적용) 3.4 완전 삭제 시점 조건 처리 유저 명시적 삭제 요청 즉시 접근 차단, 유예 기간 후 삭제 장기 미접속 + 구독 종료 데이터 생명주기 정책에 따라 삭제 삭제 정책: 즉시 삭제 ❌ → 일정 기간 유예 후 삭제 유예 기간 내 로그인 시 삭제 취소 가능 법적/보안 로그는 별도 보관 4. 외부 연동 생명주기 4.1 핵심 원칙 외부 계정(Steam 등)은 인증 수단일 뿐 서비스 데이터의 소유는 VIRDY 계정 에 귀속 연동 해제/재연동에도 데이터는 VIRDY 계정에 유지 4.2 연동 상태 변화 상태 설명 데이터 영향 연동 외부 계정으로 로그인 가능 없음 연동 해제 해당 방법으로 로그인 불가 없음 (데이터 유지) 재연동 동일 계정으로 다시 연동 없음 (데이터 복구) 4.3 복구 시나리오 시나리오 복구 방법 Steam 계정 분실 이메일/비밀번호로 로그인 → Steam 재연동 이메일 분실 Steam으로 로그인 → 이메일 변경 모든 연동 끊김 CS 문의 → 본인 확인 후 복구 5. 구독과 계정의 관계 5.1 구독 시작 단계 동작 1 이메일 연동 확인 (필수) 2 결제 수단 등록 3 구독 시작 4 플랜에 따른 스토리지 할당 5.2 구독 중단 단계 기간 동작 유예 기간 N일 데이터 다운로드 가능 (아바타, 월드) 아카이브 유예 후 데이터 Cold Storage 이동 삭제 대기 6~12개월 로그인 시 기간 리셋 완전 삭제 삭제 대기 종료 복구 불가 상세 정책은 데이터 생명주기 참조 6. 설계 시 고려사항 6.1 계정 복구 용이성 원칙 설명 다중 인증 수단 권장 Steam + 이메일 연동 권장 복구 정보 저장 최초 생성 정보로 소유권 확인 CS 복구 프로세스 본인 확인 절차 정의 필요 6.2 보안 고려사항 항목 설명 Steam ID 검증 Steam Web API로 정품 확인 이메일 인증 Firebase Auth 이메일 인증 필수 세션 관리 Firebase Auth 토큰 기반 6.3 법적 요구사항 항목 설명 개인정보 보호 최소한의 개인정보만 수집 계정 삭제권 사용자 요청 시 삭제 가능 데이터 이동권 사용자 데이터 내보내기 기능 검토 7. 엣지 케이스 및 예외 처리 상황 대응 Steam 계정 해킹/도용 CS 문의 → 본인 확인 → Steam 연동 해제 이메일 접근 불가 Steam으로 로그인 → 이메일 변경 계정 삭제 후 복구 요청 유예 기간 내: 복구 가능 / 이후: 불가 Steam VAC Ban VIRDY 계정에 영향 없음 (별도 정책 검토) 미성년자 계정 법적 요구사항에 따라 처리 (추가 검토 필요) 계정 양도 요청 원칙적으로 불가 (정책 정의 필요) 8. 미결정 쟁점 항목 상태 비고 Steam 로그인 시 받아올 수 있는 데이터 범위 📋 확인 필요 Steam Web API 검토 계정 양도 정책 📋 논의 필요 - 미성년자 계정 정책 📋 논의 필요 법적 검토 필요 CS 본인 확인 절차 📋 정의 필요 - 다중 기기 로그인 정책 📋 논의 필요 동시 로그인 허용 vs 기존 세션 만료 Refresh Token 만료 기간 📋 미확정 7일 vs 30일 Tenant 전환 기능 범위 📋 미확정 개인 사용자는 단일 Tenant, 기업 사용자는 복수 9. 향후 확장 가능성 항목 설명 우선순위 Steam 로그인 구현 Steam Web API 연동 높음 Google OAuth Google 계정 로그인 중간 2단계 인증 OTP 또는 인증 앱 낮음 관련 문서 보안 시스템 라이선스 체계 데이터 생명주기 사용자 역할"}, {"id": "03_Operations_07_Cost_Analysis", "title": "비용 분석 및 수익성", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 비용 구성 요소 상세", "id": "2-비용-구성-요소-상세"}, {"title": "3. 사용자별 월간 원가", "id": "3-사용자별-월간-원가"}, {"title": "4. 플랜별 수익성 분석", "id": "4-플랜별-수익성-분석"}, {"title": "5. 손익분기점(BEP) 분석", "id": "5-손익분기점bep-분석"}, {"title": "6. 비용 방어 체계", "id": "6-비용-방어-체계"}, {"title": "7. 시나리오별 비용 시뮬레이션", "id": "7-시나리오별-비용-시뮬레이션"}, {"title": "8. 설계 시 고려사항", "id": "8-설계-시-고려사항"}, {"title": "9. 향후 검토 사항", "id": "9-향후-검토-사항"}, {"title": "10. 참고 자료", "id": "10-참고-자료"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "비용 분석 및 수익성 1. 개요 VIRDY의 비용 구조는 로컬 퍼스트 아키텍처 를 기반으로 설계되어, 전통적인 클라우드 기반 솔루션 대비 네트워크 전송 비용을 99% 절감 하는 것을 목표로 한다. 이 문서는 실제 운영 시 발생하는 비용을 사용자 플랜별로 분석하고, 수익성과 손익분기점을 산출한다. 1.1 비용 산출 전제 조건 항목 설명 비용 산정 원칙 최악의 경우(Worst Case)를 기준으로 산정 플랜 구조 Free / Starter / Pro / Studio / Enterprise (5단계) 가격 정책 Steam 수수료 30% 반영 환율 원화 기준 (USD 환산 시 별도 명시) 1.2 비용 구성 요소 개요 구성 요소 역할 비용 발생 시점 GCP Cloud Run Spring Boot API 서버 항상 PostgreSQL (GCP) 사용자/세션 데이터 항상 Cloudflare R2 아바타/월드 스토리지 업로드/다운로드 시 Firebase Auth 사용자 인증 로그인 시 Photon Fusion 실시간 네트워크 동기화 세션(합방) 시 2. 비용 구성 요소 상세 2.1 인프라 비용 (GCP/R2/Firebase) GCP Cloud Run (Spring Boot API) 항목 사양 월 예상 비용 vCPU 1 core ~50,000원 Memory 2GB ~30,000원 Request 1M requests/월 ~20,000원 합계 - ~100,000원 PostgreSQL (GCP Cloud SQL) 항목 사양 월 예상 비용 Instance db-f1-micro ~30,000원 Storage 10GB SSD ~10,000원 합계 - ~40,000원 Cloudflare R2 (S3 호환 스토리지) 항목 단가 비고 저장 용량 $0.015/GB/월 ~20원/GB/월 Class A 작업 (업로드) $4.50/1M requests ~6,000원/1M Class B 작업 (다운로드) $0.36/1M requests ~500원/1M 전송료 (Egress) 무료 ✅ 핵심 절감 요소 사용자별 R2 비용 추정: 플랜 저장 용량 월 비용 Free 로컬만 0원 Starter 5GB ~100원 Pro 50GB ~1,000원 Studio 200GB ~4,000원 Firebase Authentication 항목 무료 한도 초과 시 인증 요청 50,000/월 $0.0055/인증 예상 비용 - 무료 한도 내 2.2 네트워크 비용 (Photon Fusion) Photon Fusion은 CCU(동시 접속자) 기반 요금제 를 사용한다. Photon 요금제 플랜 월 비용 CCU 한도 초과 시 Free $0 20 CCU 불가 Photon 100 $95 (~127,000원) 100 CCU $0.99/CCU Photon 500 $355 (~475,000원) 500 CCU $0.75/CCU 트래픽 기반 추가 비용 세션당 트래픽은 다음과 같이 계산된다: 트래픽(GB) = (인원 × Tickrate × 데이터 크기 × 시간) / 1024^3 예시: 6인 풀방, 60Hz, 1시간 항목 값 동기화 데이터 본(22개) + 표정(100개) + 손가락(40개) ≈ 2KB/frame Tickrate 60Hz 초당 전송량 2KB × 60 = 120KB/s 6인 × 1시간 120KB × 6 × 3600s ≈ 2.5GB 월 20시간 합방 시: 트래픽: 2.5GB × 20h = 50GB Photon 초과 요금 (100GB 무료 후): 없음 Worst Case (720시간 풀방): 트래픽: 2.5GB × 720h = 1,800GB Photon 초과 요금: 폭주 🚨 2.3 고정 비용 (서버 유지비) 항목 월 비용 GCP Cloud Run ~100,000원 PostgreSQL ~40,000원 기타 (모니터링, 백업) ~10,000원 합계 ~150,000원 3. 사용자별 월간 원가 3.1 Light User (Starter 플랜) 사용 패턴: 아바타 3개 (5GB 저장) 월드 1개 합방 거의 안 함 (월 2시간 미만) 비용 항목 금액 R2 저장 ~100원 R2 다운로드 ~20원 Photon (거의 0) ~5원 총 원가 ~125원 3.2 Heavy User (Pro 플랜) 사용 패턴: 아바타 10개 (50GB 저장) 월드 5개 합방 월 20시간 (주 5시간) 6인 풀방 60Hz 비용 항목 금액 R2 저장 ~1,000원 R2 다운로드 ~100원 Photon 트래픽 (50GB) ~3,500원 총 원가 ~4,600원 3.3 Worst Case 시나리오 극단적 악용 케이스: 24시간 × 30일 = 720시간 동안 6인 풀방 60Hz 유지 트래픽: 약 1,800GB 발생 비용 항목 금액 R2 저장 ~10,000원 R2 다운로드 ~500원 Photon 트래픽 ~141,500원 🚨 총 원가 ~152,000원 대응 방안: Session Timeout (4시간 자동 종료) 일 10GB 초과 시 알림 및 제한 약관에 비정상 사용 제재 명시 4. 플랜별 수익성 분석 4.1 가격 정책 (검토 중) 플랜 월 구독료 연간 구독료 Steam 정산 후 타겟 Free 0원 - - 입문자 Starter 3,900원 39,000원 (17% 할인) ~2,730원 개인 방송 Pro 14,900원 149,000원 (17% 할인) ~10,430원 고품질 합방 Studio 📋 미정 📋 미정 📋 미정 프로덕션 Enterprise 📋 협의 📋 협의 📋 협의 기업 주의: Steam 수수료 30% 적용 기준. VAT 별도. 4.2 Starter 플랜 마진 항목 금액 구독료 (Steam 정산 후) 2,730원 예상 원가 -125원 순이익 2,605원 ✅ 마진율 ~95% 4.3 Pro 플랜 마진 항목 금액 구독료 (Steam 정산 후) 10,430원 예상 원가 (월 20h 합방) -4,600원 순이익 5,830원 ✅ 마진율 ~56% 4.4 Studio/Enterprise 플랜 (검토 중) 현재 가격 미정. 다음 요소를 고려하여 산정 필요: 고려 사항 내용 아바타/월드 슬롯 대용량 스토리지 비용 동시 세션 수 3개 이상 동시 방 유지 시 Photon 비용 증가 Ultra Sync 모드 고품질 동기화로 트래픽 2배 증가 가능 시트(Seat) 기반 팀원 수에 비례한 비용 구조 5. 손익분기점(BEP) 분석 5.1 고정비 추정 항목 월 비용 서버 유지비 (GCP + DB) ~150,000원 인건비 (별도 산정) 기타 운영비 ~50,000원 합계 ~200,000원 주의: 인건비 제외 시 서버 운영비만 기준 5.2 BEP 달성 조건 (서버 비용 기준) 목표: 월 200,000원 고정비 회수 Case 1: Starter Only 필요 사용자 수 = 200,000원 / 2,605원 ≈ 77명 Case 2: Pro Only 필요 사용자 수 = 200,000원 / 5,830원 ≈ 35명 Case 3: Mixed (Starter 70% : Pro 30%) 평균 순이익 = (2,605 × 0.7) + (5,830 × 0.3) = 3,572원 필요 사용자 수 = 200,000원 / 3,572원 ≈ 56명 5.3 Photon CCU 고려 Photon Free 플랜(20 CCU)을 벗어나면: Photon 플랜 월 비용 필요 BEP Photon 100 ~127,000원 +49명 추가 Photon 500 ~475,000원 +182명 추가 결론: 초기에는 Free 플랜(20 CCU) 내에서 운영하고, 점진적 확장 필요 6. 비용 방어 체계 6.1 5단계 방어 구조 1차 방어: Config API 강제 제어 플랜 Tickrate Bone 수 제어 방법 Free 20Hz 15개 서버에서 강제 제한 Starter 30Hz 22개 Config API 응답 Pro 60Hz 22개 Config API 응답 Enterprise Ultra 모드 전체 별도 계약 구현: 클라이언트가 세션 시작 시 서버에 Config 요청 서버가 플랜에 따라 동적으로 제한값 응답 클라이언트는 서버 응답값으로만 동작 2차 방어: Rate Limiting 대상 제한 아바타 업로드 5분당 1회 월드 업로드 10분당 1회 API 요청 1,000회/분 세션 생성 플랜별 동시 제한 3차 방어: Session Timeout 조건 동작 4시간 유지 자동 경고 유료 유저 0명 10분 유예 후 종료 호스트 이탈 10분 유예 + 자동 이전 4차 방어: 트래픽 모니터링 조건 동작 일 10GB 초과 이메일 알림 월 300GB 초과 계정 제한 검토 Worst Case 감지 강제 세션 종료 5차 방어: 약관 및 제재 항목 내용 비정상 사용 정의 24시간 연속 세션, 매크로 의심 패턴 제재 수위 경고 → 일시 정지 → 영구 정지 환불 정책 약관 위반 시 환불 불가 6.2 기술적 제약 설계 제약 목적 구현 방법 압축 기술 트래픽 1/10 축소 Draco + KTX2 P2P 최적화 서버 부하 감소 Photon Fusion Shared Mode Signed URL 직접 다운로드 R2 egress 무료 활용 변경 감지 불필요한 전송 제거 Delta Compression 7. 시나리오별 비용 시뮬레이션 7.1 정상 사용 패턴 시나리오: Pro 플랜 사용자, 주 3회 합방 (각 2시간) 항목 값 월 합방 시간 24시간 트래픽 ~60GB 원가 ~5,000원 수익 10,430원 - 5,000원 = 5,430원 ✅ 7.2 헤비 유저 패턴 시나리오: Pro 플랜, 매일 2시간 합방 항목 값 월 합방 시간 60시간 트래픽 ~150GB 원가 ~8,500원 수익 10,430원 - 8,500원 = 1,930원 ⚠️ 대응: 세션 타임아웃 정책으로 제한 7.3 악용 패턴 시나리오: 24시간 연속 세션 유지 시도 항목 값 의도 720시간 실제 (4시간 제한) 120시간 트래픽 ~300GB (제한 적용) 원가 ~15,000원 수익 10,430원 - 15,000원 = -4,570원 🚨 대응: 4시간 세션 타임아웃 일 10GB 초과 알림 월 300GB 초과 시 계정 제한 8. 설계 시 고려사항 8.1 Steam 정산 수수료 (30%) 모든 가격에 Steam 수수료 30% 반영 필요: 표시 가격 Steam 정산 후 3,900원 2,730원 (30% 차감) 14,900원 10,430원 (30% 차감) 8.2 VAT 및 환율 변동 고려 사항 내용 VAT 한국 10%, 지역별 상이 환율 변동 USD 기반 Photon/GCP 비용 영향 리전별 차이 Firebase Storage 다운로드 비용 차이 8.3 결제 시스템 미구현 향후 구현 필요: Stripe/Steam 결제 연동 구독 상태 관리 라이선스 검증 평가판 로직 9. 향후 검토 사항 항목 상태 우선순위 Studio/Enterprise 플랜 가격 확정 📋 논의 필요 높음 Photon 비용 최적화 (Delta Sync) 🚧 검토 중 높음 Ultra Sync 모드 비용 산출 📋 미정 중간 마켓플레이스 수수료 정책 📋 미정 낮음 리전별 서버 증설 비용 📋 미정 낮음 10. 참고 자료 원본 산출 자료 : VIRDY 사업 종합 기획서 v1.0 (HTML, 박성술 작성) 라이선스 체계 : 라이선스 체계 리스크 관리 : 리스크 관리 네트워크 시스템 : 네트워크 시스템 데이터 생명주기 : 데이터 생명주기 관련 문서 제품 개요 라이선스 체계 리스크 관리 네트워크 시스템"}, {"id": "04_Design_01_UI_Specification", "title": "UI 기획", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 검토 중인 기능", "id": "5-검토-중인-기능"}, {"title": "6. 향후 확장 가능성", "id": "6-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "UI 기획 1. 개요 VIRDY의 UI는 씬 기반 계층 구조로 구성되며, 전역 UI(GlobalUI)와 씬별 UI(Sign/Lobby/World)로 나뉜다. Creator와 Manager 역할에 따라 표시되는 패널이 다르며, 다국어(한국어/영어)를 지원한다. 2. 핵심 기획 2.1 UI 아키텍처 계층 범위 역할 GlobalUI 전역 (모든 씬) 알림, 에러 다이얼로그, 로딩, 토스트 메시지, 캘리브레이션 SignScene UI 인증 씬 로그인, 회원가입, 비밀번호 리셋 LobbyScene UI 로비 씬 액터, 아바타, 트래커, 월드 설정 WorldScene UI 월드 씬 카메라, 채팅, 조명, 플레이어 목록 모든 UI 패널은 UIController 기본 클래스를 상속하며, OnInitialize(첫 활성화), OnActivate(표시), OnDeactivate(숨김) 생명주기를 따른다. 2.2 Sign Scene UI 화면 목록 화면 설명 주요 요소 언어 선택 최초 실행 시 한국어/영어 선택 로그인 사용자 인증 사용자명, 비밀번호, 로그인 버튼 회원가입 1단계 이메일 인증 이메일 입력, 인증코드 확인 회원가입 2단계 닉네임 설정 닉네임 입력 회원가입 3단계 비밀번호 설정 비밀번호, 비밀번호 확인 회원가입 4단계 역할 선택 Creator/Manager 토글 회원가입 5단계 약관 동의 체크박스, 동의 버튼 비밀번호 리셋 비밀번호 복구 이메일 또는 사용자명 입력 2.3 Lobby Scene UI 로비 UI는 사이드바를 통해 패널 간 이동한다. 패널 목록 패널 설명 Creator Manager 사이드바 패널 간 네비게이션 ✅ ✅ (제한) 액터 패널 액터 슬롯 관리 (최대 6개) ✅ ❌ 아바타 패널 VRM 아바타 업로드/선택 ✅ ❌ 트래커 패널 Facial/Body/Hand 장비 설정 ✅ ❌ 월드 패널 월드 검색, 업로드, 공유 설정 ✅ ✅ 설정 패널 그래픽, 사운드, 키바인딩, 언어 ✅ ✅ 친구 패널 친구 검색, 추가, 온라인 상태 ✅ ✅ 액터 패널 구성 요소 설명 액터 카드 아바타 썸네일, 이름, 연결된 트래커 표시 슬롯 탭 최대 6개 액터 슬롯 전환 추가/삭제 슬롯 추가 (MaxActorSize 미만일 때), 삭제 편집/복제 기존 액터 설정 수정 또는 복제 아바타 패널 구성 요소 설명 아바타 리스트 업로드한 VRM 아바타 썸네일 목록 업로드 버튼 로컬 VRM 파일 선택 → 업로드 아바타 상세 선택한 아바타 이름, 파일 크기 선택/삭제 액터에 아바타 할당 또는 삭제 트래커 패널 구성 섹션 요소 페이셜 트래커 장비 드롭다운, 연결 상태, IP/포트 설정 바디 트래커 장비 드롭다운, 연결 상태, 트래커 매핑 핸드 트래커 장비 드롭다운, 연결 상태 민감도 설정 시선/눈썹/입 강도 슬라이더 캘리브레이션 T-Pose / I-Pose 캘리브레이션 버튼 월드 패널 구성 요소 설명 월드 리스트 공개/내/공유 월드 탭, 썸네일 카드 검색 Algolia 기반 월드 검색 정렬 최신순/인기순/오래된순 월드 카드 썸네일, 제목, 제작자, 방문수, 공개설정 월드 상세 설명, 공유설정, 편집, 삭제 월드 업로드 AssetBundle 파일 선택 + 메타데이터 입력 월드 진입 \"세션 생성\" 또는 \"세션 참가\" (코드 입력) 설정 패널 구성 섹션 항목 그래픽 해상도, 품질, 프레임 제한, 안티앨리어싱 사운드 마스터/음악/효과음/월드 볼륨 키바인딩 커스텀 키 설정 언어 한국어/영어 전환 2.4 World Scene UI 월드 진입 후 표시되는 UI 패널: 패널 설명 카메라 패널 10개 카메라 슬롯, 프리셋 저장, Channel Link 채팅 패널 메시지 표시, 입력 필드, 전체/팀 전환 플레이어 목록 접속자 이름, 역할 색상, 호스트 👑, ME 라벨 조명 제어 방향광 강도/회전, 포스트 프로세싱 설정 오버레이 카메라 속도, 줌 속도, 회전 민감도 카메라 패널 요소 설명 FreeCam 프리뷰 자유 카메라 미리보기 카메라 슬롯 [1]~[9] 고정 카메라 선택/전환 FOV 슬라이더 초점 거리 조절 DoF 설정 포커스 거리, 자동 포커스 대상 Follow/LookAt 대상 Actor 선택 Channel Link 접속자 목록, 송출/수신 제어 프리셋 저장 현재 카메라 Transform 프리셋 저장 채팅 패널 요소 설명 채팅 모드 탭 [All] / [Creator] / [Manager] 전환 메시지 표시 역할별 색상 코딩, 팀 접두사 입력 필드 텍스트 입력, 전송 버튼 플레이어 목록 요소 설명 이름 최대 16자 표시 (초과 시 ... 처리) 역할 색상 Creator/Manager 별도 색상 호스트 표시 👑 왕관 아이콘 (호스트 옆에 표시) ME 라벨 본인 식별 초대/따라가기 소셜 기능 버튼 호스트 표시 동작: 월드를 연 사용자에게 👑 왕관 아이콘 표시 호스트 이전 시 왕관도 실시간으로 이동 호스트 변경 시 \"호스트가 변경되었습니다\" 토스트 메시지 2.5 GlobalUI 모든 씬에서 공통으로 표시되는 전역 UI: 요소 설명 알림 팝업 초대, 따라가기 요청 등 에러 다이얼로그 연결 실패, 오류 메시지 로딩 인디케이터 비동기 작업 진행 표시 토스트 메시지 짧은 알림 (복사 완료, 저장 완료 등) 캘리브레이션 UI T-Pose/I-Pose 안내, 카운트다운 2.6 View 모드별 레이아웃 월드 진입 후 4가지 View 모드에 따라 화면 레이아웃이 달라진다. 모드 레이아웃 Default Main Screen만 전체 화면 Manager Main Screen + Spectator (9분할) + Manager CAM Studio 9분할 모니터링 전체 화면 Spout Main Screen → Spout 텍스처 출력 (UI 제외) 2.7 다국어 지원 항목 설명 지원 언어 한국어, 영어 선택 시점 최초 실행 시 + 설정에서 변경 가능 적용 방식 Localization 키 기반 텍스트 치환 2.8 Figma 디자인 화면 목록 Figma에서 관리되는 주요 디자인 화면: 카테고리 화면 수량 런처 대기, 토큰, 업데이트, 에러 등 9개 로그인 기본, 비밀번호 표시 2개 회원가입 이메일 인증 ~ 가입 완료 9개 액터 설정 메인, 아바타, 트래커, 표정 4개 월드 설정 리스트, 상세, 생성, 편집 4개 월드 진입 로딩, 메인 뷰, 설정 오버레이 3개 카메라 모드별 레이아웃, Channel Link 복수 Figma 디자인은 별도로 관리되며, 이 문서에서는 화면 구성과 기능 정의만 다룬다. 3. 설계 시 고려사항 3.1 역할별 UI 분기 Creator와 Manager는 로비에서 표시되는 패널이 다르다. Manager에게는 아바타/트래커 패널이 표시되지 않는다. 세션 생성은 역할과 무관하게 가능하며, Free 플랜만 제한된다. 이를 위한 UI 분기 처리가 필요하다. 3.2 반응형 레이아웃 해상도 변경 시 UI가 적절히 대응해야 한다. 특히 Manager 모드의 3분할 레이아웃(Main + Spectator + Manager CAM)은 해상도에 따라 비율 조정이 필요하다. 3.3 키바인딩 커스터마이징 카메라 전환(R+1~9), 이동(WASD), 기타 단축키는 사용자가 커스터마이즈할 수 있어야 한다. KeyBinder 시스템을 통해 가상 키를 물리 키에 매핑한다. 3.4 Spout 모드 UI 제외 Spout 출력 시 UI가 포함되지 않아야 한다. 이를 위해 Main Screen 렌더링과 UI 렌더링이 분리되어야 한다. 4. 엣지 케이스 및 예외 처리 상황 대응 사용자명 16자 초과 말줄임 처리 (앞 16자 + \"...\") 네트워크 오류 시 로딩 타임아웃 후 에러 다이얼로그 표시 월드 로딩 중 UI 인터랙션 로딩 중 다른 조작 차단 채팅 메시지 폭주 (스팸) 스크롤 처리, 최대 메시지 수 제한 다국어 텍스트 길이 차이 레이아웃이 텍스트 길이에 적응 키바인딩 충돌 동일 키 중복 할당 시 경고 5. 검토 중인 기능 5.1 활성 월드 리스트 (검토 중) ⚠️ 상태: 고민 중. UX 담당 유수진님과 협의 필요. 현재 별도의 \"내 월드\" 관리 패널이 없어, 활성 월드 리스트 기능을 검토 중이다. 검토 중인 기능: 항목 설명 활성 월드 리스트 현재 열려있는 월드 목록 표시 내가 호스트인 월드 본인이 호스트인 활성 월드 관리 친구의 월드 친구가 접속 중인 월드 목록 재접속 / 월드 닫기 호스트인 월드에 대한 관리 기능 고려사항: 항목 내용 장점 내 월드와 친구 월드를 한 곳에서 확인 가능, 재접속 편의성 향상 단점 기존 월드 패널과 역할이 중복될 수 있음 연계 이슈 이 기능 도입 시 기존 월드 패널 개편이 필요할 수 있음 결정 필요 사항: 1. 활성 월드 리스트를 별도 패널로 분리할지, 기존 월드 패널에 통합할지 2. 친구 월드 표시 시 프라이버시 설정 필요 여부 3. 월드 패널 전체 UX 재설계 필요 여부 📋 다음 단계: UX 담당 유수진님과 논의 후 방향 결정 6. 향후 확장 가능성 항목 설명 우선순위 활성 월드 리스트 내 월드/친구 월드 관리 (검토 중) 높음 튜토리얼 최초 실행 시 가이드 투어 중간 프로필 페이지 프로필 이미지, 자기소개, 포트폴리오 낮음 알림 센터 공지사항, 친구 접속, 월드 업데이트 알림 중간 다크 모드 UI 테마 전환 낮음 추가 언어 일본어, 중국어 등 장기 관련 문서 사용자 플로우 카메라 시스템 사용자 역할 데이터 생명주기"}, {"id": "05_Technical_01_Architecture", "title": "기술 아키텍처", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 향후 확장 가능성", "id": "5-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "기술 아키텍처 1. 개요 VIRDY는 Unity 2022.3 LTS 기반의 Windows x64 전용 클라이언트 애플리케이션이다. 클라이언트는 3개 씬 구조(Sign → Lobby → World)와 Context 서비스 로케이터 패턴을 중심으로 설계된다. 서버 아키텍처는 현재 Firebase 기반(Auth, Firestore, Storage, Functions)으로 구현되어 있으며, 서버 개발자 회의(2026.02)를 통해 Spring Boot 기반 자체 백엔드로의 전환을 검토 중 이다. 전환 방향은 비용, 확장성, 기술적 타당성에 따라 변동될 수 있다. 2. 핵심 기획 2.1 기술 스택 핵심 기술 영역 기술 버전/모드 게임 엔진 Unity 2022.3.62f3 LTS 렌더 파이프라인 Universal Render Pipeline (URP) 14.0.12 렌더링 모드 Forward+ - 네트워킹 Photon Fusion Shared Mode 백엔드 (현행) Firebase Auth, Firestore, Storage, Functions 백엔드 (전환 검토) Java Spring Boot 4.0 GCP Cloud Run, PostgreSQL, Cloudflare R2 채팅 Photon Chat - 주요 패키지 패키지 용도 UniTask 비동기/await 유틸리티 UniVRM VRM 아바타 로딩 Cinemachine 카메라 시스템 Final IK 인버스 키네마틱스 Animancer 애니메이션 상태 머신 MessagePack 직렬화 Newtonsoft.Json JSON 파싱 Klak.Spout Spout 텍스처 공유 (Windows) DOTween 트윈 애니메이션 외부 플러그인 플러그인 용도 ParrelSync 멀티 인스턴스 테스팅 RuntimeTransformHandle 월드 내 오브젝트 조작 uOSC OSC 프로토콜 (VMC, VRChat OSC) uWindowCapture 가상 배경용 윈도우 캡처 VSF SDK VSeeFace 통합 2.2 서비스 로케이터 패턴 (Context) VIRDY는 Context 싱글톤을 통해 전역 서비스에 접근하는 서비스 로케이터 패턴을 사용한다. Context에 등록된 서비스 서비스 역할 SceneService 씬 수명주기 관리, 씬 전환 FirebaseService Firebase 인증/데이터/스토리지 통합 FusionService Photon Fusion 세션 관리 Database 로컬 데이터 캐시 ActorManager 액터 생성/삭제/관리 ChatService Photon Chat 메시징 Cache 에셋(아바타, 월드) 캐싱 KeyBinder 전역 키보드 단축키 AppSettings 앱 설정 (그래픽, 사운드 등) HubSettings 모션캡처 허브 설정 모든 서비스는 Context의 static 필드로 접근하며, 씬 전환과 무관하게 유지된다. 2.3 씬 구조 VIRDY는 3개의 핵심 씬과 추가 로드(Additive)되는 월드 씬으로 구성된다. 씬 빌드 인덱스 역할 SignScene 0 인증 (로그인, 회원가입, 비밀번호 리셋) LobbyScene 1 설정 (액터, 아바타, 트래커, 월드 선택) WorldScene 2 실시간 방송 (카메라, 채팅, 멀티유저) AssetBundle 월드 Additive WorldScene 위에 Additive 로드되는 사용자 월드 씬 전환 이벤트 이벤트 발생 시점 OnLobbyConnected 로비 씬 로드 완료 OnWorldConnected 월드 씬 + 네트워크 접속 완료 OnWorldDisconnected 월드에서 로비로 복귀 OnWorldConnectionFailed 월드 접속 실패 2.4 엔티티 시스템 VIRDY 내부의 데이터 모델은 3개 계층으로 구성된다. 계층 역할 주요 클래스 Entity GUID 기반 식별, 생명주기 관리 EntityManager 자동 등록 StructuredData 복잡한 런타임 데이터 AvatarData, TrackerData, ChannelData Asset 직렬화 가능한 씬 오브젝트 ActorAsset (JSON 저장/로드) StructuredData 세부 구조 데이터 클래스 하위 클래스 TrackerData (추상) FacialTrackerData, MotionTrackerData, HandTrackerData FacialTrackerData iFacialMocap, VTubeStudio, Facemotion3D, OpenSeeFace MotionTrackerData SteamVR, VMCProtocol, Xsens, Vicon, MOVIN HandTrackerData LeapMotion, Manus, Mollisen, StretchSense FieldData 시스템 StructuredData는 리플렉션 기반 속성 시스템(FieldData)을 사용한다. `[FieldData]` 어트리뷰트가 적용된 필드는 동적 get/set이 가능하며, 값 변경 시 `OnFieldDataChanged` 이벤트가 트리거된다. 2.5 네트워크 오브젝트 계층 Photon Fusion Shared Mode로 동작하며, 네트워크 오브젝트는 아래 구조를 따른다. 네트워크 오브젝트 역할 주요 데이터 NetworkGame 세션 루트 Players[255], Channels[255], Actors[] NetworkPlayer 사용자당 1개 UserId, Username, IsCreator, HandlePosition/Rotation NetworkChannel 사용자당 1개 10개 가상 카메라 데이터, Channel Link 상태, 포스트 프로세싱 NetworkActor 아바타당 1개 22개 본 회전, 40개 손가락 포즈, 100개 BlendShape, Props 데이터 압축 데이터 원본 크기 압축 후 절감률 Quaternion 16 bytes (float×4) 8 bytes (short×4) 50% BlendShape 4 bytes (float) 1 byte (sbyte) 75% Position float3 Accuracy(0.1f) 양자화 가변 네트워크 최적화 기법 기법 설명 분산 업데이트 프레임당 최대 3명 액터만 업데이트 (라운드 로빈) 히스토리 보간 2프레임 히스토리 버퍼를 사용한 보간 변경 감지 변경된 데이터만 전송 양자화 [Networked, Accuracy()] 속성으로 데이터 양자화 2.6 Firebase 통합 구조 (현행) Firebase 서비스는 4개 하위 모듈로 구성된다. 모듈 역할 주요 기능 Auth (FBAuth) 인증 이메일 로그인, 사용자명 로그인, 회원가입, 비밀번호 리셋 Firestore (FBFirestore) 데이터 사용자/월드 데이터 CRUD, 친구 관리, 실시간 리스너 Storage (FBStorage) 파일 저장 아바타/월드 업로드/다운로드 Functions 서버 로직 signUpV2, resetPasswordV2, saveWorld, deleteWorld, getEmailByUsername Firestore 데이터 구조 컬렉션 주요 필드 users/{userId} username, email, isCreator users/{userId}/avatars/{avatarId} 아바타 메타데이터 users/{userId}/friends/{friendId} 친구 관계 users/{userId}/requests/{requestId} 친구 요청 users/{userId}/favorites/{worldId} 즐겨찾기 월드 users/{userId}/shared/{worldId} 공유받은 월드 users/{userId}/worlds_private/{worldId} 비공개 월드 worlds_public/{worldId} title, author, authorId, description, sceneName, isPublic, sharedWith, version, visits, urls[] 2.7 서버 아키텍처 전환 검토 (서버 개발자 회의 기반) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 전환 배경 현행 Firebase 아키텍처는 빠른 프로토타이핑에 적합하나, 상용화 단계에서 다음과 같은 한계가 예상된다: 한계 설명 서버 측 검증 부재 Firebase는 클라이언트 측 제한에 의존, 라이선스/권한의 서버 검증 불가 Egress 비용 Firebase Storage 다운로드 트래픽 비용이 규모 확대 시 부담 비즈니스 로직 제약 Firebase Functions만으로는 복잡한 비즈니스 로직 구현에 한계 테넌트/Seat 관리 멀티 테넌트 구조를 Firebase로 구현하기 어려움 검토 중인 전환 구성 영역 현행 (Firebase) 전환 검토안 (Spring Boot) 백엔드 프레임워크 Firebase Functions Java Spring Boot 4.0 인프라 Firebase Hosting GCP Cloud Run 인증 Firebase Auth (이메일/비밀번호) Steam OAuth → Firebase Auth → Spring Security JWT 데이터베이스 Firestore (NoSQL) PostgreSQL (RDB) 파일 저장 Firebase Storage Cloudflare R2 (Signed URL) 토큰 관리 Firebase Auth 토큰 (자동 갱신) 자체 JWT (Access 1h + Refresh 7~30d) Photon 연동 클라이언트 직접 연결 Backend Webhook 기반 상태 동기화 전환 시 JWT 토큰 구조 (검토 중) 토큰 만료 용도 저장 위치 Access Token 1시간 API 호출 인증 메모리 (Unity) Refresh Token 7~30일 (미확정) Access Token 갱신 로컬 안전한 저장소 JWT Payload에는 userId, tenantId, role, subscriptionPlan을 포함하여 API 호출마다 권한 검증이 가능하도록 설계한다. 전환 시 데이터 흐름 인증: Steam 로그인 → Firebase Custom Auth → Backend JWT 발급 파일 업로드: Backend에서 R2 Signed URL 발급 → 클라이언트가 R2에 직접 업로드 (Egress 비용 0원) 세션 관리: Photon Webhook → Backend로 Room 이벤트 전달 → 세션 상태 DB 저장 미확정 사항 항목 상태 비고 Refresh Token 만료 기간 📋 미확정 7일 vs 30일 Firebase 유지 범위 📋 미확정 Auth만 유지 vs 완전 탈피 DB 마이그레이션 전략 📋 미확정 Firestore → PostgreSQL 데이터 이전 전환 시점 및 단계 📋 미확정 점진적 전환 vs 일괄 전환 2.8 빌드 변형 스크립팅 심볼 설명 VIRDY_CORE 프레임워크 빌드 VIRDY_DOTWEEN DOTween 애니메이션 활성화 2.9 프로젝트 폴더 구조 폴더 역할 Assets/Repack/Scripts/Data/ 데이터 모델 (Entity, StructuredData, Asset) Assets/Repack/Scripts/Database/ 로컬 캐시 Assets/Repack/Scripts/Lobby/ 로비 씬 로직 Assets/Repack/Scripts/Network/Firebase/ Firebase 통합 Assets/Repack/Scripts/Network/Photon/ Photon Fusion/Chat Assets/Repack/Scripts/Scene/ 씬 관리 Assets/Repack/Scripts/Sign/ 인증 UI Assets/Repack/Scripts/Utility/ 유틸리티 (Context 포함) Assets/Repack/Scripts/World/ 월드 씬 로직 Assets/VIRDY-SDK/ SDK (Editor, Runtime, Samples) Assets/ExternalPlugins/ 외부 플러그인 2.10 배포 플랫폼 플랫폼 상태 비고 Windows x64 ✅ 지원 주요 플랫폼 Steam 📋 계획 상용화 시 출시 예정 macOS ❌ 미지원 Spout, 일부 트래커 미지원 3. 설계 시 고려사항 3.1 성능 최적화 아바타 항목 권장 사항 BlendShape 수 제한 권장 (프레임당 CPU 비용 높음) 메시 LOD 원거리 액터에 적용 검토 애니메이션 절차적 IK 대신 베이킹 우선 네트워크 대역폭 항목 설명 주요 소비 액터 본 업데이트 대규모 세션 액터 수 감소 권장 고정 카메라 FreeCam보다 전송 빈도 낮음 렌더링 항목 설명 렌더 스케일 카메라별 조절 가능 포스트 프로세싱 모니터링 카메라에서는 비활성화 권장 Spout 모드 별도 렌더 타겟 사용 (메모리 집약적) 메모리 관리 항목 조치 AssetBundle 월드 퇴장 후 Unload(true) 호출 아바타 캐시 주기적 정리 텍스처 메모리 모니터링 필요 (아바타 텍스처 용량이 큼) 3.2 Context 패턴의 장단점 장점 단점 서비스 접근이 간편 테스트 시 mock 주입 어려움 씬 전환 시에도 서비스 유지 의존성이 명시적이지 않음 초기 설정이 단순 서비스 간 순환 참조 가능성 향후 의존성 주입(DI) 컨테이너로의 전환을 고려할 수 있다. 3.3 Shared Mode의 특성 Photon Fusion Shared Mode는 서버 권한(Server Authority) 없이 클라이언트 간 데이터를 동기화한다. 각 클라이언트가 자신의 NetworkObject에 대한 State Authority를 갖는다. 특성 설명 서버 권한 없음 (각 클라이언트가 자체 객체 권한) 장점 구현 단순, 지연 시간 낮음 단점 치트 방지 어려움, 서버 측 검증 불가 적합 협업/방송 환경 (경쟁적 요소 적음) 4. 엣지 케이스 및 예외 처리 상황 대응 Context 초기화 전 서비스 접근 null 체크 또는 초기화 순서 보장 씬 전환 중 비동기 작업 UniTask CancellationToken으로 취소 처리 AssetBundle 로드 실패 에러 다이얼로그 표시, 로비로 복귀 Photon 세션 연결 실패 재시도 로직 + 사용자 알림 Firebase 서비스 장애 오프라인 캐시 활용 (제한적), 에러 안내 네트워크 오브젝트 소유권 충돌 State Authority 기반 충돌 해소 대규모 세션에서 성능 저하 프레임당 액터 업데이트 수 제한 (라운드 로빈) 5. 향후 확장 가능성 항목 설명 우선순위 서버 아키텍처 전환 Firebase → Spring Boot + PostgreSQL + R2 전환 높음 DI 컨테이너 도입 Context 서비스 로케이터를 DI 컨테이너로 교체 중간 ECS 전환 대규모 액터 처리를 위한 Entity Component System 검토 장기 서버 권한 모드 경쟁적 기능 추가 시 Host Mode 전환 검토 장기 자동 테스트 파이프라인 CI/CD 연동 자동 빌드 및 테스트 중간 코드 모듈화 패키지 매니저 기반 모듈 분리 낮음 관련 문서 개발 현황 API 명세 네트워크 시스템 보안 시스템 제품 개요"}, {"id": "05_Technical_02_Development_Status", "title": "개발 현황", "sections": [{"title": "1. 개요", "id": "1-개요"}], "searchText": "개발 현황 1. 개요 이 문서는 VIRDY의 기능별 개발 진행 상태, 알려진 제한사항, 기술 부채, 로드맵을 정리한다. 기획/개발/운영 전반에서 현재 상태를 파악하고 우선순위를 판단하는 기준 문서로 활용한다."}, {"id": "05_Technical_03_API_Specification", "title": "API 명세", "sections": [{"title": "1. 개요", "id": "1-개요"}, {"title": "2. 핵심 기획", "id": "2-핵심-기획"}, {"title": "3. 설계 시 고려사항", "id": "3-설계-시-고려사항"}, {"title": "4. 엣지 케이스 및 예외 처리", "id": "4-엣지-케이스-및-예외-처리"}, {"title": "5. 미결정 쟁점", "id": "5-미결정-쟁점"}, {"title": "6. 향후 확장 가능성", "id": "6-향후-확장-가능성"}, {"title": "관련 문서", "id": "관련-문서"}], "searchText": "API 명세 1. 개요 이 문서는 VIRDY 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에서 논의된 API 엔드포인트를 정리한다. 현행 Firebase Functions 기반 API와 전환 검토 중인 Spring Boot REST API를 모두 포함한다. 🚧 전환 검토 중인 API는 비용 및 기술적 타당성에 따라 변동될 수 있다. 확정 시 본 문서를 최종 명세로 갱신한다. 2. 핵심 기획 2.1 현행 API (Firebase Functions) 현재 클라이언트에서 사용 중인 Firebase Functions 기반 서버 함수이다. 함수명 용도 호출 방식 signUpV2 회원가입 (계정 생성 + Firestore 저장) Firebase Functions 직접 호출 getEmailByUsername 사용자명 → 이메일 조회 Firebase Functions 직접 호출 saveWorld 월드 메타데이터 저장 Firebase Functions 직접 호출 deleteWorld 월드 삭제 (Firestore + Storage 정리) Firebase Functions 직접 호출 getWorldData 월드 메타데이터 조회 Firebase Functions 직접 호출 resetPasswordV2 비밀번호 리셋 이메일 발송 Firebase Functions 직접 호출 2.2 전환 검토 중인 API (Spring Boot REST) 🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다. 서버 아키텍처 전환 시 도입 예정인 REST API 목록이다. 모든 API는 `Authorization: Bearer {access_token}` 헤더로 인증한다 (인증 API 제외). 2.2.1 인증 API Method Endpoint 설명 인증 POST `/api/v1/auth/login` 로그인 (Firebase Token → JWT 발급) Firebase Token POST `/api/v1/auth/refresh` Access Token 갱신 Refresh Token POST `/api/v1/auth/logout` 로그아웃 (토큰 무효화) JWT 로그인 요청/응답 흐름: 단계 동작 요청 Firebase Token을 Body에 포함하여 전송 Backend 처리 Firebase에 Token 검증 요청 → 신규 사용자면 Account/Tenant 자동 생성 응답 JWT (Access Token + Refresh Token) 반환 JWT Payload 포함 정보: userId (VIRDY 내부 ID) tenantId role (Owner / Admin / Member) subscriptionPlan 2.2.2 아바타 API Method Endpoint 설명 GET `/api/v1/avatars` 아바타 목록 조회 (이름, 크기, hash, 수정일) POST `/api/v1/avatars/upload/init` 업로드 Signed URL 발급 요청 POST `/api/v1/avatars/upload/complete` 업로드 완료 알림 → 메타데이터 DB 저장 POST `/api/v1/avatars/download` 다운로드 Signed URL 발급 (배치, avatarId 목록) DELETE `/api/v1/avatars/{id}` 아바타 삭제 아바타 목록 응답 구조 (검토 중): 필드 타입 설명 id Long 아바타 고유 ID name String 아바타 이름 fileSize Long 파일 크기 (bytes) fileHash String 캐시 비교용 해시 createdAt DateTime 생성일 updatedAt DateTime 수정일 향후 최적화: Resolve API (검토 중) Method Endpoint 설명 POST `/api/v1/avatars/resolve` 클라이언트 캐시 hash 목록 전송 → 변경분만 Signed URL 반환 클라이언트가 보유한 `[avatarId: hash]` 목록을 서버에 전송하면, 서버가 변경된 아바타만 Signed URL과 함께 반환한다. 불필요한 URL 발급과 조회를 줄이는 최적화 방안이다. 2.2.3 세션 API Method Endpoint 설명 POST `/api/v1/sessions` 세션 생성 (joinCode 발급) GET `/api/v1/sessions/{joinCode}` 세션 정보 조회 POST `/api/v1/sessions/{id}/close` 세션 종료 요청 2.2.4 Photon Webhook 수신 Backend가 Photon으로부터 수신하는 Webhook 엔드포인트이다. Webhook Secret으로 요청 무결성을 검증한다. Method Endpoint 설명 POST `/webhook/photon/room-created` Room 생성 이벤트 → photonRoomId 매핑 저장 POST `/webhook/photon/room-closed` Room 종료 이벤트 → 세션 상태 CLOSED POST `/webhook/photon/player-joined` 플레이어 입장 → currentParticipants 증가 POST `/webhook/photon/player-left` 플레이어 퇴장 → currentParticipants 감소 2.2.5 기타 API (향후 추가 예정) 영역 예상 엔드포인트 상태 친구 관리 `/api/v1/friends` 📋 미설계 구독 관리 `/api/v1/subscription` 📋 미설계 Actor 설정 `/api/v1/actors` 📋 미설계 장비 프리셋 `/api/v1/presets` 📋 미설계 월드 관리 `/api/v1/worlds` 📋 미설계 테넌트 전환 `/api/v1/auth/switch-tenant` 📋 미설계 로비 통합 `/api/v1/lobby/init` 📋 미설계 (로비 진입 시 병렬 호출 최적화) 3. 설계 시 고려사항 3.1 API 버전 관리 모든 API는 `/api/v1/` 접두사를 사용하여 버전 관리한다. 호환성이 깨지는 변경 시 `/api/v2/`로 새 버전을 추가하고, 기존 버전은 일정 기간 유지한다. 3.2 인증 및 권한 검증 항목 설명 인증 방식 JWT Bearer Token (Authorization 헤더) 권한 검증 JWT Payload의 role, subscriptionPlan으로 엔드포인트별 접근 제어 테넌트 격리 JWT의 tenantId로 데이터 격리 보장 3.3 에러 응답 형식 필드 설명 success false error.code 에러 코드 (예: AUTH_EXPIRED, FORBIDDEN) error.message 사용자 표시용 메시지 3.4 Signed URL 보안 항목 설명 유효 기간 시간 제한 (업로드: 30분, 다운로드: 1시간 등) 단방향 업로드용 URL로 다운로드 불가, 그 반대도 불가 권한 확인 URL 발급 전 JWT로 소유권 확인 4. 엣지 케이스 및 예외 처리 상황 대응 Access Token 만료 401 응답 → 클라이언트가 Refresh Token으로 갱신 Refresh Token 만료 401 응답 → Steam 재로그인 유도 권한 부족 (무료 플랜에서 세션 생성) 403 응답 + 업그레이드 안내 Signed URL 만료 후 업로드 시도 403 응답 → 새 URL 발급 요청 유도 Webhook Secret 불일치 401 응답 → 이벤트 무시 동시 세션 한도 초과 429 응답 → 기존 세션 종료 유도 5. 미결정 쟁점 항목 상태 비고 Access Token 만료 시 자동 갱신 타이밍 📋 논의 필요 만료 5분 전 자동 갱신 vs 만료 후 갱신 Resolve API 도입 시점 📋 논의 필요 MVP에서 도입 vs 이후 최적화 로비 통합 API 도입 여부 📋 논의 필요 개별 API 병렬 호출 vs 통합 API 월드 관리 API 상세 설계 📋 미설계 월드 기획 확정 후 장비 프리셋 저장 방식 📋 논의 필요 서버 저장 vs 로컬 저장 Rate Limiting 정책 📋 미설계 API별 호출 제한 6. 향후 확장 가능성 항목 설명 우선순위 인증/아바타/세션 API 구현 서버 개발자 회의에서 확정된 핵심 API 높음 Webhook 연동 구현 Photon Webhook 수신 및 처리 높음 친구/소셜 API 친구 관리, 온라인 상태 중간 구독/결제 API Stripe 연동, 구독 상태 관리 중간 월드 관리 API 월드 업로드/다운로드/공유 중간 Resolve API 아바타 캐시 최적화 낮음 로비 통합 API 로비 진입 시 단일 호출로 필요 데이터 수신 낮음 관련 문서 기술 아키텍처 개발 현황 아바타 시스템 네트워크 시스템 보안 시스템 계정 시스템"}];

        // 페이지 표시 함수
        function showPage(pageId) {
            // 모든 페이지 숨기기
            const pages = document.querySelectorAll('.page-content');
            pages.forEach(page => page.classList.remove('active'));

            // 선택된 페이지 표시
            const targetPage = document.getElementById('page-' + pageId);
            if (targetPage) {
                targetPage.classList.add('active');
                currentPage = pageId;

                // 좌측 네비게이션 활성화 표시
                const navLinks = document.querySelectorAll('.nav-list a');
                navLinks.forEach(link => link.classList.remove('active'));
                const activeNav = document.getElementById('nav-' + pageId);
                if (activeNav) {
                    activeNav.classList.add('active');
                }

                // TOC 업데이트
                updateTOC(pageId);

                // 페이지 상단으로 스크롤
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // TOC 업데이트 함수
        function updateTOC(pageId) {
            const toc = document.getElementById('toc-content');
            if (!toc) return;

            // 현재 페이지의 문서 데이터 찾기
            const docData = documentData.find(doc => doc.id === pageId);

            if (!docData || !docData.sections || docData.sections.length === 0) {
                toc.innerHTML = '<p style="color: #999; font-size: 12px;">이 페이지에는 섹션이 없습니다.</p>';
                return;
            }

            // TOC 생성
            let tocHtml = '<ul>';
            docData.sections.forEach(section => {
                tocHtml += `<li><a href="#${section.id}" onclick="scrollToSection('${section.id}'); return false;">${section.title}</a></li>`;
            });
            tocHtml += '</ul>';
            toc.innerHTML = tocHtml;
        }

        // 섹션으로 스크롤
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // 검색 기능
        let searchTimeout = null;

        function initSearch() {
            const searchInput = document.getElementById('search-input');
            const searchClear = document.getElementById('search-clear');
            const searchResults = document.getElementById('search-results');

            if (!searchInput) return;

            searchInput.addEventListener('input', function(e) {
                const query = e.target.value.trim();

                // 클리어 버튼 표시/숨김
                searchClear.style.display = query.length > 0 ? 'block' : 'none';

                // 디바운스 처리
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    performSearch(query);
                }, 200);
            });

            searchClear.addEventListener('click', function() {
                searchInput.value = '';
                searchClear.style.display = 'none';
                searchResults.classList.remove('active');
                searchResults.innerHTML = '';
            });

            // ESC 키로 검색 닫기
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchInput.value = '';
                    searchClear.style.display = 'none';
                    searchResults.classList.remove('active');
                    searchResults.innerHTML = '';
                    searchInput.blur();
                }
            });
        }

        function performSearch(query) {
            const searchResults = document.getElementById('search-results');

            if (query.length < 2) {
                searchResults.classList.remove('active');
                searchResults.innerHTML = '';
                return;
            }

            const results = [];
            const queryLower = query.toLowerCase();

            documentData.forEach(doc => {
                const titleMatch = doc.title.toLowerCase().includes(queryLower);
                const textMatch = doc.searchText && doc.searchText.toLowerCase().includes(queryLower);

                if (titleMatch || textMatch) {
                    let preview = '';
                    let matchIndex = -1;

                    if (doc.searchText) {
                        matchIndex = doc.searchText.toLowerCase().indexOf(queryLower);
                        if (matchIndex !== -1) {
                            // 매칭 위치 주변 텍스트 추출
                            const start = Math.max(0, matchIndex - 40);
                            const end = Math.min(doc.searchText.length, matchIndex + query.length + 80);
                            preview = (start > 0 ? '...' : '') +
                                     doc.searchText.substring(start, end) +
                                     (end < doc.searchText.length ? '...' : '');
                        }
                    }

                    results.push({
                        id: doc.id,
                        title: doc.title,
                        preview: preview,
                        titleMatch: titleMatch,
                        query: query
                    });
                }
            });

            displaySearchResults(results, query);
        }

        function displaySearchResults(results, query) {
            const searchResults = document.getElementById('search-results');

            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-no-results">검색 결과가 없습니다</div>';
                searchResults.classList.add('active');
                return;
            }

            let html = `<div class="search-result-count">${results.length}개 문서에서 발견</div>`;

            results.forEach(result => {
                // 검색어 하이라이트
                let highlightedPreview = result.preview;
                if (highlightedPreview) {
                    const regex = new RegExp(`(${escapeRegExp(query)})`, 'gi');
                    highlightedPreview = highlightedPreview.replace(regex, '<mark>$1</mark>');
                }

                html += `
                    <div class="search-result-item" onclick="goToSearchResult('${result.id}', '${escapeHtml(query)}')">
                        <div class="search-result-title">${result.title}</div>
                        ${highlightedPreview ? `<div class="search-result-preview">${highlightedPreview}</div>` : ''}
                    </div>
                `;
            });

            searchResults.innerHTML = html;
            searchResults.classList.add('active');
        }

        function goToSearchResult(pageId, query) {
            // 검색창 초기화
            const searchInput = document.getElementById('search-input');
            const searchClear = document.getElementById('search-clear');
            const searchResults = document.getElementById('search-results');

            searchInput.value = '';
            searchClear.style.display = 'none';
            searchResults.classList.remove('active');
            searchResults.innerHTML = '';

            // 해당 페이지로 이동
            showPage(pageId);

            // 페이지 내 검색어 하이라이트 (선택적)
            if (query) {
                setTimeout(() => {
                    highlightInPage(query);
                }, 100);
            }
        }

        function highlightInPage(query) {
            // 기존 하이라이트 제거
            const existingHighlights = document.querySelectorAll('.search-highlight');
            existingHighlights.forEach(el => {
                const parent = el.parentNode;
                parent.replaceChild(document.createTextNode(el.textContent), el);
                parent.normalize();
            });

            if (!query || query.length < 2) return;

            const activePage = document.querySelector('.page-content.active');
            if (!activePage) return;

            // 텍스트 노드에서 검색어 찾아 하이라이트
            const walker = document.createTreeWalker(
                activePage,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );

            const textNodes = [];
            while (walker.nextNode()) {
                if (walker.currentNode.nodeValue.toLowerCase().includes(query.toLowerCase())) {
                    textNodes.push(walker.currentNode);
                }
            }

            textNodes.forEach(node => {
                const text = node.nodeValue;
                const regex = new RegExp(`(${escapeRegExp(query)})`, 'gi');
                if (regex.test(text)) {
                    const span = document.createElement('span');
                    span.innerHTML = text.replace(regex, '<mark class="search-highlight" style="background: #fff3cd; padding: 1px 3px; border-radius: 3px;">$1</mark>');
                    node.parentNode.replaceChild(span, node);
                }
            });

            // 첫 번째 하이라이트로 스크롤
            const firstHighlight = activePage.querySelector('.search-highlight');
            if (firstHighlight) {
                firstHighlight.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            const firstPageId = documentData.length > 0 ? documentData[0].id : 'updates';
            showPage(firstPageId);
            initSearch();
        });
    </script>
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>🎬 VIRDY</h1>
                <div class="subtitle">기획 문서 통합본</div>
                <div class="meta">
                    생성일: 2026-02-04 10:19<br>
                    작성: VIRDY Studio
                </div>
            </div>
            <div class="search-container">
                <div class="search-input-wrapper">
                    <span class="search-icon">🔍</span>
                    <input type="text" id="search-input" class="search-input" placeholder="문서 검색..." autocomplete="off">
                    <button id="search-clear" class="search-clear">✕</button>
                </div>
                <div id="search-results" class="search-results"></div>
            </div>
            <nav>
                <div class="nav-category">📝 최신 업데이트</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('updates'); return false;">최근 4주 업데이트</a></li>
<li><a href="#" onclick="showPage('changelog'); return false;">전체 변경 이력</a></li>
</ul>
<div class="nav-category">📦 제품 정의</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('01_Product_01_Product_Overview'); return false;" id="nav-01_Product_01_Product_Overview">제품 개요</a></li>
<li><a href="#" onclick="showPage('01_Product_02_User_Flow'); return false;" id="nav-01_Product_02_User_Flow">사용자 플로우</a></li>
</ul>
<div class="nav-category">⚙️ 핵심 기능</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('02_Features_01_Avatar_System'); return false;" id="nav-02_Features_01_Avatar_System">아바타 시스템</a></li>
<li><a href="#" onclick="showPage('02_Features_02_Tracker_System'); return false;" id="nav-02_Features_02_Tracker_System">트래커 시스템</a></li>
<li><a href="#" onclick="showPage('02_Features_03_Camera_System'); return false;" id="nav-02_Features_03_Camera_System">카메라 시스템</a></li>
<li><a href="#" onclick="showPage('02_Features_04_World_System'); return false;" id="nav-02_Features_04_World_System">월드 시스템</a></li>
<li><a href="#" onclick="showPage('02_Features_05_Network_System'); return false;" id="nav-02_Features_05_Network_System">네트워크 시스템</a></li>
<li><a href="#" onclick="showPage('02_Features_06_SDK'); return false;" id="nav-02_Features_06_SDK">SDK</a></li>
</ul>
<div class="nav-category">🔒 운영 기획</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('03_Operations_01_User_Roles'); return false;" id="nav-03_Operations_01_User_Roles">사용자 역할</a></li>
<li><a href="#" onclick="showPage('03_Operations_02_License_System'); return false;" id="nav-03_Operations_02_License_System">라이선스 체계</a></li>
<li><a href="#" onclick="showPage('03_Operations_03_Security'); return false;" id="nav-03_Operations_03_Security">보안 시스템</a></li>
<li><a href="#" onclick="showPage('03_Operations_04_Data_Lifecycle'); return false;" id="nav-03_Operations_04_Data_Lifecycle">데이터 생명주기</a></li>
<li><a href="#" onclick="showPage('03_Operations_05_Risk_Management'); return false;" id="nav-03_Operations_05_Risk_Management">리스크 관리</a></li>
<li><a href="#" onclick="showPage('03_Operations_06_Account_System'); return false;" id="nav-03_Operations_06_Account_System">계정 시스템</a></li>
<li><a href="#" onclick="showPage('03_Operations_07_Cost_Analysis'); return false;" id="nav-03_Operations_07_Cost_Analysis">비용 분석 및 수익성</a></li>
</ul>
<div class="nav-category">🎨 UI/UX</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('04_Design_01_UI_Specification'); return false;" id="nav-04_Design_01_UI_Specification">UI 기획</a></li>
</ul>
<div class="nav-category">🛠️ 기술 설계</div>
<ul class="nav-list">
<li><a href="#" onclick="showPage('05_Technical_01_Architecture'); return false;" id="nav-05_Technical_01_Architecture">기술 아키텍처</a></li>
<li><a href="#" onclick="showPage('05_Technical_02_Development_Status'); return false;" id="nav-05_Technical_02_Development_Status">개발 현황</a></li>
<li><a href="#" onclick="showPage('05_Technical_03_API_Specification'); return false;" id="nav-05_Technical_03_API_Specification">API 명세</a></li>
</ul>

            </nav>
        </aside>

        <div class="main-wrapper">
            <div class="content-area">
                <main class="main-content">
                    
        <div class="page-content" id="page-updates">
            <div class="section-header">
                <h2>📝 최근 4주 업데이트</h2>
            </div>
            <h1>📋 최신 업데이트</h1>
<blockquote>최근 4주간의 주요 변경사항을 확인할 수 있습니다.</blockquote>
<p>전체 변경 이력은 CHANGELOG.md를 참고하세요.</p>
<hr>
<h2>2026년 2월 1주차 (02.03 - 02.04)</h2>
<h3>🔧 서버 개발자 회의 2차 내용 반영</h3>
<p><strong>플랜 구조 확정 및 Actor 개념 정립</strong></p>
<ul>
<li>5단계 티어 체계 확정 (Free/Starter/Pro/Studio/Enterprise)</li>
<li>"방 최대 인원" → "세션 최대 Actor"로 용어 변경</li>
<li>개인 Actor 수와 세션 최대 Actor 구분 명확화</li>
<li>Actor 수 확정: Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+</li>
</ul>
<p><strong>Manager 및 Free/Starter 정책 확정</strong></p>
<ul>
<li>Manager도 1 Actor로 계산 (아바타 없이 참여해도 세션 Actor 수에 포함)</li>
<li>Free/Starter 세션 참가 제한: 멀티플레이어 세션에서 Manager로만 참여 가능</li>
<li>세션 권한 이전 정책: Creator/Manager 역할 무관, Pro 이상 플랜이면 세션 유지</li>
</ul>
<p><strong>저장 및 용량 정책</strong></p>
<ul>
<li>아바타 슬롯 50개, 200MB/개 제한 명시</li>
<li>월드 용량 제한: Starter 300MB, Pro 이상 800MB</li>
<li>서버 전용 저장 정책 명시 (로컬 저장 제거)</li>
</ul>
<h3>📄 API 명세 문서 신규 작성</h3>
<ul>
<li>현행 Firebase Functions API 정리</li>
<li>전환 검토 중인 Spring Boot REST API (인증, 아바타, 세션, Webhook)</li>
<li>Signed URL 보안 정책, 에러 응답 형식</li>
</ul>
<h3>🔧 서버 개발자 회의 1차 내용 반영</h3>
<ul>
<li>서버 아키텍처 전환 검토 (Spring Boot 4.0 + PostgreSQL + Cloudflare R2)</li>
<li>인증 흐름 전환 검토 (Steam OAuth → Firebase Auth → JWT)</li>
<li>테넌트 내 권한 체계 검토 (Owner/Admin/Member)</li>
<li>Photon Custom Authentication 및 Webhook 흐름 추가</li>
</ul>
<hr>
<h2>2026년 1월 5주차 (01.30 - 02.02)</h2>
<h3>📝 문서 시스템 개선</h3>
<ul>
<li>CHANGELOG.md 추가: 전체 변경 이력 추적</li>
<li>UPDATES.md 추가: 최근 4주 업데이트 요약</li>
<li>`_updates/` 폴더: 주간 상세 리포트</li>
<li>HTML 온보딩 문서 자동 생성 시스템 (`generate_onboarding.py`)</li>
<li>통합 HTML 문서 뷰어 (`VIRDY_Onboarding.html`)</li>
</ul>
<h3>💰 비용 분석 문서 신규 작성</h3>
<ul>
<li>사용자별 월간 원가 산출 (Light/Heavy/Worst Case)</li>
<li>플랜별 마진 분석 (Starter 96%, Pro 56%)</li>
<li>손익분기점(BEP) 분석 (서버 비용 기준 56명)</li>
<li>5단계 비용 방어 체계 상세 명세</li>
<li>Photon/GCP/R2 비용 구성 요소 상세 분석</li>
</ul>
<h3>🔄 용어 통일</h3>
<ul>
<li>"Photon Fusion 2" → "Photon Fusion" 전체 문서 용어 통일</li>
</ul>
<hr>
<h2>2026년 1월 4주차 (01.23 - 01.29)</h2>
<h3>📄 초기 문서 작성 완료</h3>
<ul>
<li>17개 기획 문서 초안 완성</li>
<li>5개 카테고리별 구조화 (Product, Features, Operations, Design, Technical)</li>
<li>표준 문서 형식 확립 (개요, 핵심 기획, 설계 고려사항, 엣지 케이스, 향후 확장)</li>
<li>문서 버전, 최종 수정일, 작성자 메타데이터 포함</li>
</ul>
<hr>
<h2>업데이트 확인 방법</h2>
<h3>📌 빠른 확인</h3>
<p>이 파일에서 최근 4주간의 주요 변경사항을 확인하세요.</p>
<h3>📚 상세 확인</h3>
<p>`_updates/YYYY-MM-weekX.md` 파일에서 주간 회의 내용과 상세 변경 이유를 확인하세요.</p>
<h3>📖 전체 이력</h3>
<p>CHANGELOG.md에서 프로젝트 전체 변경 이력을 확인하세요.</p>
<h3>🌐 HTML 뷰어</h3>
<p>`VIRDY_Onboarding_v2.html`을 열면 사이드바에서 최신 업데이트를 확인할 수 있습니다.</p>
<hr>
<p><strong>마지막 업데이트</strong>: 2026.02.04</p>
        </div>
        
        <div class="page-content" id="page-changelog">
            <div class="section-header">
                <h2>📋 전체 변경 이력</h2>
            </div>
            <h1>변경 이력</h1>
<p>모든 주요 변경사항이 이 파일에 기록됩니다.</p>
<p>형식은 Keep a Changelog를 따르며, 이 프로젝트는 Semantic Versioning을 준수합니다.</p>
<hr>
<h2>[미배포] - 2026-02-03</h2>
<h3>추가됨</h3>
<ul>
<li><strong>05_Technical/03_API_Specification.md</strong>: API 명세 문서 신규 작성</li>
<ul>
<li>현행 Firebase Functions API 정리</li>
<li>전환 검토 중인 Spring Boot REST API (인증, 아바타, 세션, Webhook)</li>
<li>Signed URL 보안 정책, 에러 응답 형식</li>
<li>향후 추가 예정 API 영역 정리</li>
</ul>
</ul>
<h3>수정됨 (서버 개발자 회의 2차 내용 반영)</h3>
<ul>
<li><strong>03_Operations/02_License_System.md</strong> (v1.1 → v1.2): 플랜 구조 확정 및 제한 정책 구체화</li>
<ul>
<li>5단계 티어 체계 확정 (Free/Starter/Pro/Studio/Enterprise)</li>
<li>아바타 슬롯 50개, 200MB/개 제한 명시</li>
<li>월드 용량 제한 명시 (Starter 300MB, Pro 이상 800MB)</li>
<li>Actor 수 확정 (Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+)</li>
<li>동시 방 보유 1개 정책 확정 (Pro/Studio)</li>
<li>Free → Starter 전환 유도 전략 섹션 추가 (워터마크/시간제한/기능잠금 옵션)</li>
<li>Studio 조직 시트(Organization Sheet) 검토 중 표기</li>
<li>서버 전용 저장 정책 명시 (로컬 저장 제거)</li>
<li><strong>Actor 개념 정립</strong>: "방 최대 인원" → "세션 최대 Actor"로 용어 변경, 개인 Actor 수와 세션 최대 Actor 구분 명확화</li>
<li><strong>Manager도 1 Actor로 계산</strong>: 아바타 없이 참여해도 세션 Actor 수에 포함</li>
<li><strong>Free/Starter 세션 참가 제한</strong>: 멀티플레이어 세션에서 Manager로만 참여 가능</li>
<li><strong>세션 권한 이전 정책</strong>: Creator/Manager 역할 무관, Pro 이상 플랜이면 세션 유지</li>
</ul>
<li><strong>03_Operations/01_User_Roles.md</strong> (v1.1 → v1.2): 플랜별 역할 제한 반영</li>
<ul>
<li>Manager도 1 Actor로 계산됨 명시</li>
<li>플랜별 역할 제한 테이블 추가 (Free/Starter는 세션에서 Manager로만 참여)</li>
</ul>
<li><strong>02_Features/01_Avatar_System.md</strong> (v1.1 → v1.2): 저장 정책 구체화</li>
<ul>
<li>아바타 슬롯 50개, 200MB/개 제한 테이블 추가</li>
<li>Actor 수 라이선스 체계와 동기화 (Studio 4개, Enterprise 6개+)</li>
<li>Actor 개념 설명 추가 (1명이 여러 Actor 운용 가능, 세션은 Actor 수로 제한)</li>
<li>서버 전용 저장 정책 명시 (로컬 저장 제거)</li>
<li>엣지 케이스에 슬롯/용량 초과 대응 추가</li>
</ul>
<li><strong>02_Features/04_World_System.md</strong> (v1.0 → v1.1): 업로드 제한 구체화</li>
<ul>
<li>월드 용량 제한 테이블 추가 (Starter 300MB, Pro 이상 800MB)</li>
<li>서버 전용 저장 정책 명시 (로컬 저장 제거)</li>
<li>업로드 흐름에 용량 검증 단계 추가</li>
</ul>
<li><strong>02_Features/05_Network_System.md</strong> (v1.1 → v1.2): Actor 기반 세션 제한 개념 반영</li>
<ul>
<li>최대 플레이어 100명 → n명 (검토 중)으로 변경</li>
<li>플레이어 vs Actor 개념 구분 설명 추가</li>
<li>세션 최대 Actor (호스트 플랜 기준) 개념 명시</li>
</ul>
<li><strong>01_Product/01_Product_Overview.md</strong> (v1.0 → v1.1): 5티어 플랜 및 Actor 개념 반영</li>
<ul>
<li>라이선스 항목에 Starter 플랜 추가</li>
<li>"최대 100명" → "플랜별 세션 최대 Actor 제한"으로 변경</li>
</ul>
<li><strong>01_Product/02_User_Flow.md</strong> (v1.1 → v1.2): Actor 기반 제한 반영</li>
<ul>
<li>월드 참가 시 "인원 확인" → "세션 Actor 수 확인"으로 변경</li>
<li>엣지 케이스 "100명 초과" → "세션 최대 Actor 초과"로 변경</li>
</ul>
</ul>
<h3>수정됨 (서버 개발자 회의 1차 내용 반영)</h3>
<ul>
<li><strong>05_Technical/01_Architecture.md</strong>: 서버 아키텍처 전환 검토 섹션 추가 (2.7절)</li>
<ul>
<li>Spring Boot 4.0 + PostgreSQL + Cloudflare R2 전환 검토안</li>
<li>JWT 토큰 구조, 데이터 흐름 정리</li>
<li>미확정 사항 (Refresh Token 기간, Firebase 유지 범위 등)</li>
</ul>
<li><strong>03_Operations/06_Account_System.md</strong>: 인증 흐름 전환 검토 섹션 추가 (2.5절)</li>
<ul>
<li>Steam OAuth → Firebase Auth → JWT 흐름</li>
<li>Tenant 개념 도입, 계정 복구 흐름</li>
</ul>
<li><strong>03_Operations/03_Security.md</strong>: 보안 아키텍처 전환 검토 섹션 추가 (2.8절)</li>
<ul>
<li>JWT 기반 인증 보안, Photon Custom Auth</li>
<li>Photon Webhook Secret 검증, R2 Signed URL 보안</li>
</ul>
<li><strong>02_Features/01_Avatar_System.md</strong>: 아바타 저장/관리 전환 검토 내용 추가</li>
<ul>
<li>R2 Signed URL 기반 업로드/다운로드 흐름</li>
<li>fileHash 캐시 검증, Resolve API 검토</li>
</ul>
<li><strong>02_Features/05_Network_System.md</strong>: 세션 관리 전환 검토 섹션 추가 (2.16절)</li>
<ul>
<li>Backend 경유 세션 생성/종료 흐름</li>
<li>Photon Webhook 이벤트, 세션 데이터 모델</li>
<li>Photon Custom Authentication</li>
</ul>
<li><strong>03_Operations/01_User_Roles.md</strong>: 테넌트 내 권한 체계 검토 섹션 추가 (2.6절)</li>
<ul>
<li>Owner/Admin/Member 관리 권한과 Creator/Manager 프로덕션 역할 분리</li>
</ul>
<li><strong>03_Operations/02_License_System.md</strong>: Actor/Seat 개념 섹션 추가 (2.5절)</li>
<ul>
<li>플랜별 Actor 수 제한 확정 (서버 측 검증)</li>
<li>Seat 기반 멤버 초대 개념 (검토 중)</li>
</ul>
<li><strong>01_Product/02_User_Flow.md</strong>: 로그인/로비 흐름 전환 검토 추가</li>
<ul>
<li>Steam 주 인증 전환 흐름 (2.2.4절)</li>
<li>로비 데이터 로딩 전략 (Pre-load/Lazy Load) (2.3.2절)</li>
</ul>
</ul>
<hr>
<h2>[미배포] - 2026-02-02</h2>
<h3>추가됨</h3>
<ul>
<li><strong>03_Operations/07_Cost_Analysis.md</strong>: 비용 분석 및 수익성 문서 신규 작성</li>
<ul>
<li>사용자별 월간 원가 산출 (Light/Heavy/Worst Case)</li>
<li>플랜별 마진 분석 (Starter 96%, Pro 56%)</li>
<li>손익분기점(BEP) 분석 (서버 비용 기준 56명)</li>
<li>5단계 비용 방어 체계 상세 명세</li>
<li>시나리오별 비용 시뮬레이션 (정상/헤비/악용 패턴)</li>
<li>Photon/GCP/R2 비용 구성 요소 상세 분석</li>
</ul>
<li>CHANGELOG.md: 전체 변경 이력 추적 시스템 도입</li>
<li>HTML 온보딩 문서 생성기 (`generate_onboarding.py`)</li>
<li>통합 HTML 문서 뷰어 (`VIRDY_Onboarding.html`)</li>
</ul>
<h3>수정됨</h3>
<ul>
<li><strong>02_License_System.md</strong>: 비용 분석 문서 링크 추가 (3.1절)</li>
<li><strong>05_Risk_Management.md</strong>: 비용 분석 문서 링크 추가 (R1 리스크)</li>
<li><strong>전체 문서</strong>: "Photon Fusion 2" → "Photon Fusion" 용어 통일</li>
</ul>
<hr>
<h2>[1.0.0] - 2026-01-30</h2>
<h3>추가됨</h3>
<ul>
<li>초기 기획 문서 17개 작성 완료</li>
<ul>
<li>01_Product: 제품 개요, 사용자 플로우</li>
<li>02_Features: 아바타, 트래커, 카메라, 월드, 네트워크, SDK</li>
<li>03_Operations: 사용자 역할, 라이선스, 보안, 데이터 생명주기, 리스크 관리, 계정</li>
<li>04_Design: UI 기획</li>
<li>05_Technical: 아키텍처, 개발 현황</li>
</ul>
</ul>
<h3>문서 형식</h3>
<ul>
<li>모든 문서는 표준 구조를 따름 (개요, 핵심 기획, 설계 고려사항, 엣지 케이스, 향후 확장)</li>
<li>문서 버전, 최종 수정일, 작성자 메타데이터 포함</li>
</ul>
<hr>
<h2>범례</h2>
<ul>
<li>`추가됨`: 새로운 기능, 문서, 섹션</li>
<li>`수정됨`: 기존 기능/문서의 변경</li>
<li>`제거됨`: 삭제된 기능/문서</li>
<li>`수정 예정`: 향후 변경 예정 사항</li>
<li>`보안`: 보안 관련 변경사항</li>
</ul>
        </div>
        
        <div class="page-content" id="page-01_Product_01_Product_Overview">
            <div class="section-header">
                <h2>📦 제품 개요</h2>
            </div>
            <h1>제품 개요</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p><strong>VIRDY</strong>는 버추얼 크리에이터를 위한 올인원 모션캡처 라이브 스트리밍 솔루션이다. 하나의 프로그램 안에서 아바타 설정, 다종 모션캡처 장비 연동, 가상 카메라 운영, 커스텀 월드 업로드, 실시간 멀티유저 협업까지 모두 수행할 수 있다.</p>
<p>개인 VTuber부터 프로덕션 스튜디오까지, Motioncapture 기반 라이브 콘텐츠 제작에 필요한 전 과정을 단일 프로그램으로 통합하는 것이 VIRDY의 핵심 가치이다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 제품 비전</h3>
<p><strong>"Mocap 라이브 콘텐츠 제작의 진입 장벽을 낮추고, 개인부터 스튜디오까지 하나의 도구로 커버한다."</strong></p>
<p>기존 모캡 라이브 제작 환경은 여러 프로그램을 조합해야 하고, 멀티유저 협업이 어려우며, 각 장비별 별도 솔루션이 필요했다. VIRDY는 이를 하나로 통합한다.</p>
<h3>2.2 핵심 가치</h3>
<table>
<thead><tr><th>가치</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>올인원</strong></td><td>아바타 + 모캡 + 카메라 + 월드 + 서버를 단일 프로그램에서 제공</td></tr>
<tr><td><strong>다종 장비 지원</strong></td><td>Facial 5종, Body 5종, Hand 4종 등 14종 이상의 모캡 장비를 지원</td></tr>
<tr><td><strong>실시간 멀티 환경</strong></td><td>플랜별 세션 최대 Actor 제한 내에서 역할 분담 협업 가능</td></tr>
<tr><td><strong>커스텀 월드</strong></td><td>사용자가 직접 제작한 3D 월드를 업로드하고 방송 / 촬영에 사용</td></tr>
<tr><td><strong>크리에이터 생태계</strong></td><td>SDK를 통해 월드/아바타를 제작하고 공유하는 생태계 구축</td></tr>
</tbody></table>
<h3>2.3 타겟 사용자</h3>
<h4>주력 타겟: 개인 VTuber / 크리에이터</h4>
<ul>
<li>혼자 또는 소규모로 방송하는 개인 크리에이터</li>
<li>저가~중가 모캡 장비 사용 (SteamVR, iFacialMocap, Leap Motion, WebCam 등)</li>
<li>간편한 설정과 빠른 방송 시작을 원함</li>
<li>커스텀 월드 및 기능 세팅으로 차별화된 방송 환경 구축 니즈</li>
</ul>
<h4>주력 타겟 2: 프로덕션 스튜디오</h4>
<ul>
<li>전문 장비를 갖춘 방송/콘텐츠 제작 스튜디오</li>
<li>고가 모캡 장비 사용 (Vicon, Manus, StretchSense 등)</li>
<li>다수 스탭이 역할 분담하여 동시 작업</li>
<li>PD가 여러 카메라맨의 화면을 받아 실시간 스위칭</li>
</ul>
<h3>2.4 제품 정보</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>개발사</strong></td><td>*VIRDY Studio</td></tr>
<tr><td><strong>플랫폼</strong></td><td>Windows 전용</td></tr>
<tr><td><strong>엔진</strong></td><td>Unity 2022.3.62f3 (URP 14.0.12)</td></tr>
<tr><td><strong>배포</strong></td><td>Steam (주력)</td></tr>
<tr><td><strong>수익 모델</strong></td><td>SaaS 구독 (영구 라이선스 검토 중)</td></tr>
<tr><td><strong>개발 상태</strong></td><td>개발 / 내부 테스트 단계</td></tr>
</tbody></table>
<h3>2.5 핵심 기능 요약</h3>
<table>
<thead><tr><th>기능</th><th>설명</th><th>상태</th></tr></thead>
<tbody>
<tr><td><strong>아바타 시스템</strong></td><td>VRM 아바타 로딩, ARKit Facial, 암호화 저장, 자체 확장자 계획</td><td>✅ / 📋 확장자</td></tr>
<tr><td><strong>트래커 시스템</strong></td><td>Facial 5종 + Body 5종 + Hand 4종 연동, 캘리브레이션</td><td>✅</td></tr>
<tr><td><strong>카메라 시스템</strong></td><td>10채널 가상 카메라, 4가지 View 모드, Channel Link</td><td>✅</td></tr>
<tr><td><strong>월드 시스템</strong></td><td>AssetBundle 커스텀 월드, Public/Private 공유, 라이팅 제어</td><td>✅</td></tr>
<tr><td><strong>네트워크</strong></td><td>Photon Fusion 기반, 플랜별 세션 Actor 제한, 데이터 압축 동기화</td><td>✅</td></tr>
<tr><td><strong>채팅</strong></td><td>월드 내 텍스트 채팅</td><td>✅</td></tr>
<tr><td><strong>친구 시스템</strong></td><td>Firebase 기반 친구 목록, Algolia 검색, Invite / Join 기능</td><td>✅</td></tr>
<tr><td><strong>SDK</strong></td><td>월드/아바타 빌드, 인터랙티브 기능, 외부 배포 예정</td><td>🚧</td></tr>
<tr><td><strong>라이선스</strong></td><td>SaaS 티어 (Free/Starter/Pro/Studio/Enterprise)</td><td>📋</td></tr>
<tr><td><strong>음성 채팅</strong></td><td>세션 내 음성 채팅</td><td>📋</td></tr>
<tr><td><strong>로컬 모드</strong></td><td>서버 없이 혼자 사용</td><td>📋</td></tr>
<tr><td><strong>런처</strong></td><td>자동 업데이트 + 인증 런처</td><td>📋</td></tr>
<tr><td><strong>세션 녹화</strong></td><td>모션 데이터 녹화 및 재생</td><td>📋</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 단일 프로그램 통합의 트레이드오프</h3>
<p>VIRDY는 모든 기능을 하나의 프로그램에 통합한다. 이는 사용성 측면에서 장점이지만, 메모리/성능 관리에 주의가 필요하다. <br></p>
<h3>3.2 개인 사용자와 스튜디오의 동시 지원</h3>
<p>두 타겟 사이에 요구사항 차이가 크다.</p>
<table>
<thead><tr><th>항목</th><th>개인 크리에이터</th><th>프로덕션 스튜디오</th></tr></thead>
<tbody>
<tr><td>설정 복잡도</td><td>최소화</td><td>세밀한 컨트롤 필요</td></tr>
<tr><td>동시 접속</td><td>1~3명</td><td>5명 이상</td></tr>
<tr><td>장비 가격대</td><td>저가~중가</td><td>고가 전문 장비</td></tr>
<tr><td>워크플로우</td><td>혼자 또는 소규모</td><td>역할 분담 (PD, 카메라맨, 출연자)</td></tr>
</tbody></table>
<p>세팅에 대한 온보딩을 제공하여 'Simple Setup', 'Advanced Setup' 같은 빠른 세팅 가이드를 제공하는 것 고려 필요.</p>
<h3>3.3 Steam 배포 고려</h3>
<p>Steam을 주력 배포 채널로 사용할 경우:</p>
<ul>
<li>Steam DRM / 인증 연동 필요</li>
<li>Steam Workshop을 월드/아바타/에셋 공유에 활용 가능성 검토</li>
<li>Steam 리뷰 / 커뮤니티 관리 필요</li>
<li>가격 정책이 SaaS 구독과 Steam 구매 모델 사이에서 충돌할 수 있음</li>
<ul>
<li>상용화 기획 페이지에서 상세 다룰 예정</li>
</ul>
</ul>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>월드 참여 중 네트워크 끊김</td><td>로컬 상태 유지, 재접속 시 복구 시도</td></tr>
<tr><td>지원하지 않는 VRM 버전 업로드</td><td>오류 메시지와 함께 지원 버전 안내</td></tr>
<tr><td>무료 티어 기능 한도 초과</td><td>업그레이드 안내 팝업, 기능 차단 (데이터 손실 없이)</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>방향</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>자체 아바타 확장자</strong></td><td>애니메이션/스크립트 내장 포맷</td><td>높음</td></tr>
<tr><td><strong>로컬 모드</strong></td><td>네트워크 없이 단독 사용</td><td>높음</td></tr>
<tr><td><strong>세션 녹화/재생</strong></td><td>모션 데이터 녹화 및 재생</td><td>중간</td></tr>
<tr><td><strong>배포(Steam, 자체)</strong></td><td>자동 업데이트 + 토큰 인증</td><td>중간</td></tr>
<tr><td><strong>NDI 출력</strong></td><td>방송 장비 연동 출력</td><td>낮음</td></tr>
<tr><td><strong>음성 채팅</strong></td><td>세션 내 실시간 음성 통화</td><td>낮음</td></tr>
<tr><td><strong>에셋 마켓플레이스</strong></td><td>월드/아바타 공유 및 거래 (+ Steam Workshop)</td><td>장기</td></tr>
<tr><td><strong>엔터프라이즈 라이선스</strong></td><td>대규모 스튜디오용 커스텀 계약</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>사용자 플로우</li>
<li>아바타 시스템</li>
<li>라이선스 체계</li>
<li>개발 현황</li>
</ul>
        </div>
        
        <div class="page-content" id="page-01_Product_02_User_Flow">
            <div class="section-header">
                <h2>📦 사용자 플로우</h2>
            </div>
            <h1>사용자 플로우</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY의 전체 사용자 플로우를 정의한다. 개발자가 앱 흐름을 이해하고, QA가 테스트 케이스를 도출하며, 기획자가 UX를 검증하는 데 활용된다.</p>
<h3>1.1 Scene 구조</h3>
<p>VIRDY는 <strong>인증 → 로비 → 월드</strong> 3단계로 구성되며, 각 단계는 Unity Scene과 1:1 대응된다.</p>
<table>
<thead><tr><th>Scene</th><th>Build Index</th><th>역할</th><th>주요 기능</th></tr></thead>
<tbody>
<tr><td><strong>SIGN</strong></td><td>0</td><td>인증</td><td>로그인, 회원가입, 비밀번호 리셋</td></tr>
<tr><td><strong>LOBBY</strong></td><td>1</td><td>준비</td><td>아바타/트래커/월드 설정, 월드 생성/참가</td></tr>
<tr><td><strong>WORLD</strong></td><td>2</td><td>실시간 프로덕션</td><td>모션캡처, 카메라, 방송 송출</td></tr>
</tbody></table>
<h3>1.2 사용자 역할</h3>
<table>
<thead><tr><th>역할</th><th>대상</th><th>권한</th></tr></thead>
<tbody>
<tr><td><strong>Creator</strong></td><td>크리에이터, 출연자</td><td>모든 기능 사용 가능 (아바타, 트래커, 월드 생성)</td></tr>
<tr><td><strong>Manager</strong></td><td>PD, 카메라맨, 스태프</td><td>제한적 기능 (카메라/조명만, 아바타/모션캡처 사용 불가)</td></tr>
</tbody></table>
<hr>
<h2 id="2-핵심-플로우">2. 핵심 플로우</h2>
<h3>2.1 전체 서비스 플로우</h3>
<pre><code class="mermaid">flowchart TD
<p>Start([프로그램 실행]) --> CheckToken{자동 로그인<br>토큰 존재?}</p>
<p>CheckToken -->|Yes| ValidateToken["토큰 유효성 검증"] CheckToken -->|No| SignScene["Sign Scene 로드"]</p>
<p>ValidateToken --> TokenValid{토큰 유효?} TokenValid -->|Yes| LobbyScene["Lobby Scene 진입"] TokenValid -->|No| SignScene</p>
<p>SignScene --> Auth["인증 플로우"] Auth --> AuthSuccess{인증 성공?} AuthSuccess -->|Yes| LobbyScene AuthSuccess -->|No| SignScene</p>
<p>LobbyScene --> LobbyFlow["로비 플로우"] LobbyFlow --> WorldEntry{월드 진입}</p>
<p>WorldEntry -->|월드 생성| CreateSession["월드 생성"] WorldEntry -->|월드 참가| JoinSession["월드 참가"] WorldEntry -->|로그아웃| SignScene</p>
<p>CreateSession --> WorldScene["World Scene 진입"] JoinSession --> WorldScene</p>
<p>WorldScene --> WorldFlow["월드 내 활동"] WorldFlow --> ExitWorld{월드 나가기}</p>
<p>ExitWorld -->|Yes| Disconnect["월드 종료"] ExitWorld -->|No| WorldFlow</p>
<p>Disconnect --> LobbyScene</p>
<p>style Start fill:#e1f5e1 style SignScene fill:#fff4e6 style LobbyScene fill:#e3f2fd style WorldScene fill:#f3e5f5</code></pre></p>
<hr>
<h3>2.2 인증 플로우 (Sign Scene)</h3>
<h4>2.2.1 로그인</h4>
<table>
<thead><tr><th>단계</th><th>동작</th><th>성공 시</th><th>실패 시</th></tr></thead>
<tbody>
<tr><td>1</td><td>이메일/비밀번호 입력</td><td>다음 단계</td><td>입력 오류 표시</td></tr>
<tr><td>2</td><td>Firebase Auth 로그인 API 호출</td><td>다음 단계</td><td>오류 표시 (잘못된 비밀번호/계정 없음/네트워크 오류)</td></tr>
<tr><td>3</td><td>이메일 인증 확인</td><td>다음 단계</td><td>경고 + 인증 메일 재발송 옵션</td></tr>
<tr><td>4</td><td>자동 로그인 토큰 저장</td><td>다음 단계</td><td>-</td></tr>
<tr><td>5</td><td>Firestore에서 사용자 정보 로드</td><td>Lobby Scene 전환</td><td>재시도 또는 로그아웃</td></tr>
</tbody></table>
<h4>2.2.2 회원가입</h4>
<table>
<thead><tr><th>단계</th><th>동작</th><th>성공 시</th><th>실패 시</th></tr></thead>
<tbody>
<tr><td>1</td><td>이용약관 동의</td><td>다음 단계</td><td>로그인 화면으로</td></tr>
<tr><td>2</td><td>이메일, 비밀번호, 닉네임</td><td>다음 단계</td><td>폼 검증 오류 표시</td></tr>
<tr><td>3</td><td>Firebase Auth 계정 생성</td><td>다음 단계</td><td>이메일 중복/네트워크 오류</td></tr>
<tr><td>4</td><td>Firestore에 사용자 정보 저장</td><td>다음 단계</td><td>계정 삭제 후 로그인 화면으로</td></tr>
<tr><td>5</td><td>인증 메일 발송</td><td>로그인 화면으로</td><td>경고 표시 (재발송 가능)</td></tr>
</tbody></table>
<p><strong>필수 입력 필드:</strong></p>
<ul>
<li>이메일 (유효한 형식)</li>
<li>비밀번호 (8자 이상, 영문+숫자 조합)</li>
<li>닉네임 (필수)</li>
</ul>
<h4>2.2.3 비밀번호 리셋</h4>
<p>이메일 입력 → Firebase Auth 비밀번호 리셋 API 호출 → 리셋 메일 발송 완료 → 로그인 화면으로</p>
<h4>2.2.4 인증 흐름 전환 검토 (서버 개발자 회의 기반)</h4>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시, Steam 로그인이 주 인증 방식이 되고 이메일/비밀번호는 보조 수단으로 전환된다.</p>
<p><strong>전환 후 로그인 흐름 (검토 중)</strong></p>
<table>
<thead><tr><th>단계</th><th>동작</th><th>성공 시</th><th>실패 시</th></tr></thead>
<tbody>
<tr><td>1</td><td>Steam SDK로 로그인</td><td>Steam Token 획득</td><td>Steam 오류 안내</td></tr>
<tr><td>2</td><td>Firebase Custom Auth 요청</td><td>Firebase Token 수신</td><td>Firebase 오류 안내</td></tr>
<tr><td>3</td><td>Backend `/api/v1/auth/login` 호출</td><td>JWT 수신</td><td>서버 오류 안내</td></tr>
<tr><td>4</td><td>JWT 로컬 저장</td><td>Lobby Scene 전환</td><td>-</td></tr>
</tbody></table>
<p><strong>전환 후 자동 로그인</strong></p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>저장 위치</td><td>Refresh Token → 로컬 안전 저장소</td></tr>
<tr><td>유효 기간</td><td>Refresh Token 만료 (7~30일, 미확정)</td></tr>
<tr><td>검증 방식</td><td>프로그램 시작 시 `/api/v1/auth/refresh` 호출</td></tr>
<tr><td>만료 시 동작</td><td>Steam 재로그인 → JWT 재발급</td></tr>
</tbody></table>
<hr>
<h3>2.3 로비 플로우 (Lobby Scene)</h3>
<h4>2.3.1 Creator 로비 기능</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>액터 설정</strong></td><td>최대 6개 슬롯, 각 슬롯에 아바타 1개 + 트래커 (Facial/Body/Hand 각 1개) 할당</td></tr>
<tr><td><strong>아바타 설정</strong></td><td>VRM 업로드/선택, BlendShape 설정, 민감도 조절</td></tr>
<tr><td><strong>트래커 설정</strong></td><td>Facial/Body/Hand 장비 연결, 캘리브레이션</td></tr>
<tr><td><strong>월드 설정</strong></td><td>월드 검색/업로드, 공유 설정</td></tr>
<tr><td><strong>환경설정</strong></td><td>그래픽, 사운드, 키바인딩, 언어</td></tr>
<tr><td><strong>월드 생성</strong></td><td>월드 생성 플로우 시작</td></tr>
<tr><td><strong>월드 참가</strong></td><td>월드 참가 플로우 시작</td></tr>
<tr><td><strong>로그아웃</strong></td><td>Sign Scene으로 전환</td></tr>
</tbody></table>
<h4>2.3.2 로비 데이터 로딩 전략 검토 (서버 개발자 회의 기반)</h4>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 전환 시 로비 진입 시 데이터를 효율적으로 로딩하기 위한 전략이 도입된다.</p>
<table>
<thead><tr><th>데이터</th><th>로딩 시점</th><th>이유</th></tr></thead>
<tbody>
<tr><td>아바타 목록</td><td>로비 진입 시 즉시 (Pre-load)</td><td>파일 크기가 커서 미리 다운로드 필요</td></tr>
<tr><td>아바타 파일</td><td>목록 수신 후 즉시 (캐시 미스분만)</td><td>백그라운드 다운로드</td></tr>
<tr><td>친구 목록</td><td>메뉴 진입 시 (Lazy Load)</td><td>데이터 작음, 필요 시 로드</td></tr>
<tr><td>Actor 설정</td><td>메뉴 진입 시 (Lazy Load)</td><td>로컬 설정 우선, 서버는 백업</td></tr>
<tr><td>구독 상세</td><td>구독 메뉴 진입 시 (Lazy Load)</td><td>기본 정보는 JWT에 포함</td></tr>
<tr><td>월드 목록</td><td>미정</td><td>기획 확정 후 결정</td></tr>
</tbody></table>
<h4>2.3.3 Manager 로비 기능</h4>
<p>Manager는 아래 기능을 사용할 수 있다:</p>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>월드 설정</strong></td><td>월드 검색/업로드, 공유 설정</td></tr>
<tr><td><strong>환경설정</strong></td><td>그래픽, 사운드, 키바인딩, 언어</td></tr>
<tr><td><strong>월드 생성</strong></td><td>월드 생성 플로우 시작</td></tr>
<tr><td><strong>월드 참가</strong></td><td>월드 참가 플로우 시작</td></tr>
<tr><td><strong>로그아웃</strong></td><td>Sign Scene으로 전환</td></tr>
</tbody></table>
<blockquote><strong>Manager 제약:</strong> 아바타/트래커 설정 불가 (카메라/조명 전용 역할)</blockquote>
<h4>2.3.3 호스트와 월드 관리</h4>
<blockquote><strong>용어:</strong> 사용자에게는 "세션"이라는 기술 용어 대신 "월드"와 "호스트"를 사용한다.</blockquote>
<p><strong>호스트 (Host):</strong></p>
<ul>
<li>월드를 연 사용자가 해당 월드의 <strong>호스트</strong>가 됨</li>
<li>플레이어 목록에서 👑 왕관 아이콘으로 표시</li>
<li>호스트가 나가면 남은 유료 사용자에게 자동 이전 (10분 유예 후)</li>
</ul>
<p><strong>호스트 이전 시나리오:</strong></p>
<table>
<thead><tr><th>상황</th><th>동작</th></tr></thead>
<tbody>
<tr><td>호스트 퇴장 (팅김/나감)</td><td>10분 유예 → 유예 내 복귀 시 호스트 유지</td></tr>
<tr><td>유예 후 미복귀</td><td>남은 유료 사용자에게 호스트 자동 이전</td></tr>
<tr><td>호스트가 새 월드 열기</td><td>기존 월드의 호스트를 다른 유저에게 이전 후 새 월드 생성</td></tr>
<tr><td>유료 사용자 0명</td><td>10분 유예 후 월드 자동 종료</td></tr>
</tbody></table>
<blockquote><strong>참고:</strong> 호스트 이전 및 월드 생명주기 상세 정책은 데이터 생명주기 참조<br><strong>참고:</strong> 활성 월드 관리 UI는 검토 중. UI 기획 참조</blockquote>
<hr>
<h3>2.4 월드 진입 플로우</h3>
<h4>2.4.1 월드 생성</h4>
<blockquote><strong>개발자 참고:</strong> 내부적으로 Photon Fusion "세션"을 생성하는 플로우이다.</blockquote>
<table>
<thead><tr><th>단계</th><th>동작</th><th>성공 시</th><th>실패 시</th></tr></thead>
<tbody>
<tr><td>1</td><td>구독 플랜 확인</td><td>다음 단계</td><td>Free 플랜이면 월드 생성 불가 안내</td></tr>
<tr><td>2</td><td>월드 선택 확인</td><td>다음 단계</td><td>"월드를 선택하세요" 경고</td></tr>
<tr><td>3</td><td>4자리 랜덤 월드 코드 생성</td><td>다음 단계</td><td>중복 시 재생성</td></tr>
<tr><td>4</td><td>Photon Fusion 세션 생성</td><td>월드 로딩 시작</td><td>네트워크/서버 오류</td></tr>
</tbody></table>
<blockquote><strong>참고:</strong> Creator/Manager 역할과 무관하게 월드 생성 가능. Free 플랜만 월드 생성 제한.</blockquote>
<h4>2.4.2 월드 참가</h4>
<blockquote><strong>개발자 참고:</strong> 내부적으로 Photon Fusion "세션"에 참가하는 플로우이다.</blockquote>
<p><strong>참가 방법:</strong> 1. <strong>월드 코드 입력:</strong> 4자리 영숫자 직접 입력 2. <strong>친구 초대 수락:</strong> Chat으로 받은 초대 메시지에서 코드 추출 3. <strong>따라가기:</strong> 친구 목록에서 접속 중인 친구의 월드로 이동</p>
<table>
<thead><tr><th>단계</th><th>동작</th><th>성공 시</th><th>실패 시</th></tr></thead>
<tbody>
<tr><td>1</td><td>월드 코드 입력/추출</td><td>다음 단계</td><td>형식 오류 표시</td></tr>
<tr><td>2</td><td>Photon 세션 검색</td><td>다음 단계</td><td>"월드를 찾을 수 없습니다"</td></tr>
<tr><td>3</td><td>세션 Actor 수 확인</td><td>다음 단계</td><td>"세션이 가득 찼습니다" (호스트 플랜 기준 초과)</td></tr>
<tr><td>4</td><td>Photon Fusion 세션 참가</td><td>월드 로딩 시작</td><td>네트워크/타임아웃 오류</td></tr>
</tbody></table>
<h4>2.4.3 월드 로딩</h4>
<table>
<thead><tr><th>단계</th><th>표시 메시지</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>"월드 정보 불러오는 중..."</td><td>Firebase Storage에서 메타데이터 다운로드</td></tr>
<tr><td>2</td><td>"월드 데이터 다운로드 중... (XX%)"</td><td>AssetBundle 다운로드 (캐시 확인 후)</td></tr>
<tr><td>3</td><td>"씬 로딩 중..."</td><td>Unity Scene 로드</td></tr>
<tr><td>4</td><td>"월드 접속 중..."</td><td>Photon Chat 구독, NetworkGame 초기화 대기 (30초 타임아웃)</td></tr>
</tbody></table>
<p><strong>캐싱:</strong></p>
<ul>
<li>월드 AssetBundle은 로컬에 캐시 (`Application.persistentDataPath/WorldCache/`)</li>
<li>메타데이터의 버전 해시로 유효성 검증</li>
<li>캐시 유효 시 다운로드 단계 생략</li>
</ul>
<hr>
<h3>2.5 월드 내 활동</h3>
<h4>2.5.1 Creator 활동</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>모션캡처</strong></td><td>연결된 트래커로 실시간 아바타 구동</td></tr>
<tr><td><strong>카메라 조작</strong></td><td>10채널 카메라 전환/이동/설정</td></tr>
<tr><td><strong>아바타 이동</strong></td><td>선택한 액터의 WASD로 아바타 이동 (위치/회전 네트워크 동기화)</td></tr>
<tr><td><strong>채팅</strong></td><td>전체/팀 채팅 메시지 전송</td></tr>
<tr><td><strong>방송 출력</strong></td><td>Spout/윈도우 캡처로 OBS 연동</td></tr>
<tr><td><strong>조명 제어</strong></td><td>Directional Light 강도/방향 조절</td></tr>
<tr><td><strong>포스트 프로세싱</strong></td><td>Bloom/Color 파라미터 조절</td></tr>
<tr><td><strong>Channel Link</strong></td><td>카메라 송출/수신</td></tr>
<tr><td><strong>초대</strong></td><td>친구에게 월드 초대</td></tr>
</tbody></table>
<h4>2.5.2 Manager 활동</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>카메라 조작</strong></td><td>10채널 카메라 전환/이동/설정</td></tr>
<tr><td><strong>Channel Link</strong></td><td>카메라 송출/수신 (PD 워크플로우)</td></tr>
<tr><td><strong>아바타 이동</strong></td><td>선택한 액터의 WASD로 아바타 이동 (위치/회전 네트워크 동기화)</td></tr>
<tr><td><strong>조명 제어</strong></td><td>Directional Light 강도/방향 조절</td></tr>
<tr><td><strong>포스트 프로세싱</strong></td><td>Bloom/Color 파라미터 조절</td></tr>
<tr><td><strong>채팅</strong></td><td>전체/팀 채팅 메시지 전송</td></tr>
</tbody></table>
<h4>2.5.3 멀티유저 프로덕션 (PD 워크플로우)</h4>
<p>대규모 프로덕션에서 다수 Manager가 협업하는 구조:</p>
<table>
<thead><tr><th>역할</th><th>동작</th></tr></thead>
<tbody>
<tr><td><strong>카메라맨 B, C, D</strong></td><td>각자 CAM 1~3 촬영 → PD의 고정 카메라에 Channel Link</td></tr>
<tr><td><strong>PD (A)</strong></td><td>모든 카메라맨의 화면 수신 → R+1~9 키로 실시간 스위칭</td></tr>
<tr><td><strong>Creator</strong></td><td>PD의 Main Screen 수신 → Spout/윈도우 캡처로 방송 송출</td></tr>
</tbody></table>
<p>Creator와 Manager의 조작 차이는 Actor의 존재 유무일뿐, 그외에 시스템적으로 사용을 제한하는 기능은 없다.</p>
<hr>
<h3>2.6 월드 퇴장</h3>
<table>
<thead><tr><th>단계</th><th>동작</th><th>비고</th></tr></thead>
<tbody>
<tr><td>1</td><td>확인 팝업 표시</td><td>"월드에서 나가시겠습니까?"</td></tr>
<tr><td>2</td><td>Photon Chat 채널 구독 해제</td><td>실패 시 경고 후 계속</td></tr>
<tr><td>3</td><td>NetworkRunner 종료</td><td>5초 타임아웃 후 강제 종료</td></tr>
<tr><td>4</td><td>월드 AssetBundle 언로드</td><td>메모리 해제</td></tr>
<tr><td>5</td><td>Lobby Scene 로드</td><td>실패 시 프로그램 재시작 필요</td></tr>
</tbody></table>
<hr>
<h3>2.7 소셜 기능</h3>
<h4>2.7.1 친구 추가</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>친구 검색 UI 열기</td></tr>
<tr><td>2</td><td>검색어 입력 (닉네임 또는 이메일, 2자 이상)</td></tr>
<tr><td>3</td><td>Algolia 검색 API 호출</td></tr>
<tr><td>4</td><td>검색 결과에서 사용자 선택</td></tr>
<tr><td>5</td><td>Firebase에 친구 추가 요청</td></tr>
</tbody></table>
<h4>2.7.2 친구 초대</h4>
<p>월드 접속 중일 때, 온라인 친구에게 Photon Chat으로 초대 메시지 전송 (`/invite {worldCode}`)</p>
<h4>2.7.3 따라가기</h4>
<p>로비에서 친구 목록 조회 → 월드 접속 중인 친구 선택 → 해당 월드로 자동 참가</p>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 Scene 전환</h3>
<table>
<thead><tr><th>전환</th><th>조건</th><th>정리 작업</th></tr></thead>
<tbody>
<tr><td>SIGN → LOBBY</td><td>인증 성공</td><td>-</td></tr>
<tr><td>LOBBY → WORLD</td><td>월드 생성/참가 성공</td><td>-</td></tr>
<tr><td>WORLD → LOBBY</td><td>월드 퇴장</td><td>NetworkRunner 종료, AssetBundle 언로드</td></tr>
<tr><td>LOBBY/WORLD → SIGN</td><td>로그아웃</td><td>FusionService 정리</td></tr>
</tbody></table>
<h3>3.2 자동 로그인</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>저장 위치</td><td>PlayerPrefs 또는 로컬 파일</td></tr>
<tr><td>유효 기간</td><td>Firebase 기본 설정 (1시간 ~ 7일)</td></tr>
<tr><td>검증 방식</td><td>프로그램 시작 시 Firebase Auth 토큰 검증</td></tr>
<tr><td>만료 시 동작</td><td>Sign Scene 로드, 재로그인 요구</td></tr>
</tbody></table>
<h3>3.3 네트워크 재연결 전략</h3>
<table>
<thead><tr><th>서비스</th><th>재연결 전략</th><th>타임아웃</th><th>실패 시 동작</th></tr></thead>
<tbody>
<tr><td><strong>Photon Fusion</strong></td><td>자동 재연결 시도</td><td>30초</td><td>강제 종료, 로비 복귀</td></tr>
<tr><td><strong>Photon Chat</strong></td><td>지수 백오프 (5초 → 60초)</td><td>무제한</td><td>채팅만 비활성화, 세션 유지</td></tr>
<tr><td><strong>Firebase</strong></td><td>즉시 실패, 재시도 없음</td><td>-</td><td>오류 표시, 사용자 재시도 유도</td></tr>
</tbody></table>
<h3>3.4 역할 기반 UI 제어</h3>
<table>
<thead><tr><th>역할</th><th>로비 UI</th><th>월드 UI</th></tr></thead>
<tbody>
<tr><td><strong>Creator</strong></td><td>액터/아바타/트래커/월드 패널 전체</td><td>모든 기능</td></tr>
<tr><td><strong>Manager</strong></td><td>설정 패널만</td><td>카메라/조명 제어만</td></tr>
</tbody></table>
<h3>3.5 캐싱 전략</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>캐시 위치</td><td>`Application.persistentDataPath/WorldCache/`</td></tr>
<tr><td>버전 관리</td><td>메타데이터의 버전 해시로 유효성 검증</td></tr>
<tr><td>캐시 삭제 조건</td><td>버전 불일치, Scene 로드 실패</td></tr>
<tr><td>최대 캐시 크기</td><td>5GB (향후 설정 가능)</td></tr>
</tbody></table>
<hr>
<h2 id="4-예외-처리">4. 예외 처리</h2>
<h3>4.1 인증 단계</h3>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>이메일 인증 미완료 상태에서 로그인</td><td>경고 표시, 인증 메일 재발송 옵션</td></tr>
<tr><td>회원가입 중 네트워크 중단</td><td>재시도 옵션, 계정 생성 실패 시 Firebase 데이터 롤백</td></tr>
<tr><td>자동 로그인 토큰 만료</td><td>Sign Scene 로드, 재로그인 요구</td></tr>
</tbody></table>
<h3>4.2 로비 단계</h3>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>Free 플랜에서 월드 생성 시도</td><td>UI에서 버튼 비활성화, 업그레이드 안내</td></tr>
<tr><td>Manager가 아바타/트래커 설정 시도</td><td>UI에서 패널 비활성화, 툴팁으로 제약 안내</td></tr>
<tr><td>아바타 파일 업로드 실패</td><td>오류 메시지, 지원 형식 안내 (VRM)</td></tr>
<tr><td>트래커 연결 실패</td><td>장비별 연결 가이드 표시, 재시도 버튼</td></tr>
<tr><td>월드 코드 입력 오류</td><td>"월드를 찾을 수 없습니다" 오류</td></tr>
<tr><td><strong>동시 월드 제한 초과</strong></td><td>새 월드 열기 차단, 기존 월드 닫기 유도</td></tr>
<tr><td><strong>호스트가 새 월드 열기 시도</strong></td><td>기존 월드 닫기 확인 팝업 → 남은 유저에게 호스트 이전</td></tr>
</tbody></table>
<h3>4.3 월드 진입</h3>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>세션 최대 Actor 초과</td><td>"세션이 가득 찼습니다" 오류, 로비 복귀 (호스트 플랜 기준)</td></tr>
<tr><td>월드 다운로드 중 네트워크 끊김</td><td>타임아웃 후 재시도 옵션, 실패 시 로비 복귀</td></tr>
<tr><td>AssetBundle 손상</td><td>캐시 삭제 후 재시도 유도</td></tr>
<tr><td>초기화 타임아웃 (30초)</td><td>자동 연결 해제, 로비 복귀</td></tr>
<tr><td>접속한 월드가 삭제된 상태</td><td>"월드가 삭제되었습니다" 오류, 로비 복귀</td></tr>
</tbody></table>
<h3>4.4 월드 내 활동</h3>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>네트워크 연결 끊김</td><td>30초 재연결 시도, 실패 시 강제 퇴장</td></tr>
<tr><td>Chat 연결 끊김</td><td>백그라운드 재연결, 세션은 유지</td></tr>
<tr><td>Channel Link 이중 연결 시도 (A→B→C)</td><td>"이중 공유는 불가능합니다" 경고</td></tr>
<tr><td>Creator가 아바타 없이 월드 진입</td><td>빈 액터 상태로 참가</td></tr>
</tbody></table>
<h3>4.5 소셜 기능</h3>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>오프라인 친구에게 초대 시도</td><td>"친구가 오프라인 상태입니다" 알림</td></tr>
<tr><td>친구가 없는 월드로 따라가기 시도</td><td>"친구가 월드에 없습니다" 오류</td></tr>
<tr><td>검색 결과 없음</td><td>"다른 검색어를 시도하세요" 안내</td></tr>
</tbody></table>
<hr>
<h2 id="5-상태-정의">5. 상태 정의</h2>
<h3>5.1 Scene 상태</h3>
<table>
<thead><tr><th>Scene</th><th>상태</th><th>설명</th></tr></thead>
<tbody>
<tr><td>SIGN</td><td>Idle</td><td>로그인 화면 표시 중</td></tr>
<tr><td>SIGN</td><td>Authenticating</td><td>Firebase Auth API 호출 중</td></tr>
<tr><td>LOBBY</td><td>Idle</td><td>로비 화면 표시 중</td></tr>
<tr><td>LOBBY</td><td>CreatingSession</td><td>세션 생성 API 호출 중</td></tr>
<tr><td>LOBBY</td><td>JoiningSession</td><td>세션 참가 API 호출 중</td></tr>
<tr><td>WORLD</td><td>Loading</td><td>월드 로딩 중</td></tr>
<tr><td>WORLD</td><td>Active</td><td>월드 활동 중</td></tr>
<tr><td>WORLD</td><td>Disconnecting</td><td>세션 종료 처리 중</td></tr>
</tbody></table>
<h3>5.2 네트워크 상태</h3>
<table>
<thead><tr><th>상태</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Disconnected</td><td>세션 연결 안 됨 (로비에서 모든 기능 사용 가능)</td></tr>
<tr><td>Connecting</td><td>세션 연결 시도 중 (로딩 화면)</td></tr>
<tr><td>Connected</td><td>세션 연결됨 (월드 활동 가능)</td></tr>
<tr><td>Reconnecting</td><td>재연결 시도 중 (제한적 활동)</td></tr>
<tr><td>Failed</td><td>연결 실패 (로비로 강제 복귀)</td></tr>
</tbody></table>
<hr>
<h2 id="6-향후-확장-가능성">6. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>현재</th><th>향후</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>소셜 로그인</strong></td><td>이메일/비밀번호만</td><td>Google, Steam, Discord</td><td>높음</td></tr>
<tr><td><strong>런처</strong></td><td>없음</td><td>자동 업데이트 + 토큰 인증</td><td>높음</td></tr>
<tr><td><strong>로컬 모드</strong></td><td>미지원</td><td>네트워크 없이 단독 사용</td><td>중간</td></tr>
<tr><td><strong>튜토리얼</strong></td><td>없음</td><td>최초 실행 시 온보딩 가이드</td><td>중간</td></tr>
<tr><td><strong>음성 채팅</strong></td><td>미지원</td><td>월드 내 실시간 음성</td><td>낮음</td></tr>
<tr><td><strong>월드 녹화</strong></td><td>미지원</td><td>모션 데이터 녹화 및 재생</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="7-관련-문서">7. 관련 문서</h2>
<ul>
<li>제품 개요</li>
<li>사용자 역할</li>
<li>아바타 시스템</li>
<li>트래커 시스템</li>
<li>카메라 시스템</li>
<li>월드 시스템</li>
<li>네트워크 시스템</li>
<li>라이선스 체계</li>
<li>UI 기획</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_01_Avatar_System">
            <div class="section-header">
                <h2>⚙️ 아바타 시스템</h2>
            </div>
            <h1>아바타 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>아바타 시스템은 사용자가 자신의 3D 캐릭터를 VIRDY에 가져와 실시간으로 구동하는 기능이다. <br> VRM 포맷 아바타를 업로드하여 Actor에 불러오고, 트래커와 연결하여 실시간 모션캡처 아바타로 동작한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 지원 아바타 포맷</h3>
<table>
<thead><tr><th>포맷</th><th>상태</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>VRM 0.x</strong></td><td>✅</td><td>현재 주력 지원 포맷. VRoid Studio, Blender 등에서 제작 가능</td></tr>
<tr><td><strong>VRM 1.0</strong></td><td>📋</td><td>차세대 VRM 포맷, 지원은 되나 검증 X</td></tr>
<tr><td><strong>VSF</strong></td><td>📋</td><td>VSeeFace 포맷, 지원중이나 일부 VSF 스크립트는 테스트 필요</td></tr>
<tr><td><strong>자체 확장자</strong></td><td>📋</td><td>애니메이션/스크립트 내장 포맷, 배포 할 VIRDY SDK에서 빌드</td></tr>
</tbody></table>
<h3>2.2 아바타 로딩 파이프라인</h3>
<table>
<thead><tr><th>단계</th><th>동작</th><th>설명</th></tr></thead>
<tbody>
<tr><td>1</td><td>파일 선택</td><td>로컬 VRM 파일 업로드 / 리스트 내 선택</td></tr>
<tr><td>2</td><td>VRM 파싱</td><td>UniVRM으로 VRM 파일 로드 및 메타데이터 추출</td></tr>
<tr><td>3</td><td>머티리얼 변환</td><td>MToon 셰이더 → URP Toon Lit 셰이더로 자동 변환</td></tr>
<tr><td>4</td><td>본 매핑</td><td>Humanoid 본 자동 매핑 + IK 설정</td></tr>
<tr><td>5</td><td>표정 설정</td><td>BlendShapeProxy 기반 52종 ARKit BlendShape 매핑</td></tr>
<tr><td>6</td><td>Puppet 생성</td><td>트래커 데이터를 아바타에 연결하는 중간 계층 생성</td></tr>
<tr><td>7</td><td>씬 배치</td><td>아바타를 Scene에 불러오기</td></tr>
</tbody></table>
<h3>2.3 아바타 저장 및 관리</h3>
<blockquote>🚧 모든 아바타 데이터는 <strong>서버(클라우드)에만 저장</strong>되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용하고, 로컬 캐시는 성능 최적화 목적으로만 사용한다.</blockquote>
<h4>저장 정책</h4>
<table>
<thead><tr><th>항목</th><th>값</th><th>비고</th></tr></thead>
<tbody>
<tr><td>아바타 슬롯 수</td><td>최대 50개</td><td>Pro/Studio 기준, 사용자에게 제한 미노출</td></tr>
<tr><td>아바타 용량 제한</td><td>200MB/개</td><td>모든 플랜 동일</td></tr>
<tr><td>저장 위치</td><td>서버 (클라우드)</td><td>로컬 저장 미지원</td></tr>
<tr><td>로컬 캐시</td><td>성능 최적화용</td><td>원본은 서버에만 존재</td></tr>
</tbody></table>
<h4>아바타 목록 관리 (현행 - Firebase Storage)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>업로드</td><td>로컬 VRM → Firebase Storage 암호화 업로드</td></tr>
<tr><td>다운로드</td><td>Firebase → 로컬 캐시 저장</td></tr>
<tr><td>삭제</td><td>Firebase 삭제 + 로컬 캐시 삭제</td></tr>
<tr><td>캐시</td><td>이미 다운로드한 아바타는 로컬 캐시에서 바로 로드</td></tr>
</tbody></table>
<h4>아바타 저장/관리 전환 검토 (서버 개발자 회의 기반)</h4>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시 아바타 업로드/다운로드 흐름이 Cloudflare R2 Signed URL 방식으로 변경된다.</p>
<p><strong>업로드 흐름 (검토 중)</strong></p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>클라이언트가 Backend에 업로드 요청 (파일명, 크기)</td></tr>
<tr><td>2</td><td>Backend가 R2 Signed URL 생성 (Upload용) → 클라이언트에 반환</td></tr>
<tr><td>3</td><td>클라이언트가 R2에 직접 파일 업로드 (Egress 비용 0원)</td></tr>
<tr><td>4</td><td>업로드 완료 후 Backend에 완료 알림 → 메타데이터 DB 저장</td></tr>
</tbody></table>
<p><strong>다운로드 흐름 (검토 중)</strong></p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>로비 진입 시 Backend에 아바타 목록 요청</td></tr>
<tr><td>2</td><td>응답에 이름, 크기, fileHash, 수정일 포함</td></tr>
<tr><td>3</td><td>로컬 캐시와 hash 비교 → 캐시 일치 시 다운로드 생략</td></tr>
<tr><td>4</td><td>다운로드 필요한 아바타만 Backend에 Signed URL 요청</td></tr>
<tr><td>5</td><td>R2에서 직접 다운로드 (병렬, Egress 비용 0원)</td></tr>
<tr><td>6</td><td>로컬 캐시 저장 → VRM에서 썸네일 파싱하여 표시</td></tr>
</tbody></table>
<p><strong>캐시 최적화 (검토 중)</strong></p>
<p>아바타 목록 API 응답에 fileHash를 포함하여, 클라이언트가 로컬 캐시의 유효성을 빠르게 판단할 수 있다. 향후 Resolve API를 도입하여, 클라이언트가 보유한 캐시 hash 목록을 서버에 한 번에 전송하고, 변경된 아바타만 Signed URL을 받는 최적화도 검토 중이다.</p>
<p><strong>결정 사항 (검토 중)</strong></p>
<table>
<thead><tr><th>항목</th><th>방향</th></tr></thead>
<tbody>
<tr><td>썸네일</td><td>서버에서 별도 저장하지 않고, 클라이언트가 VRM 파일에서 직접 파싱</td></tr>
<tr><td>캐시 검증</td><td>fileHash를 통해 캐시 유효성 검증 → 불필요한 다운로드 방지</td></tr>
<tr><td>다운로드 시점</td><td>로비 진입 시 즉시 Pre-load (아바타는 파일 크기가 크므로 선행 로드)</td></tr>
</tbody></table>
<h3>2.4 표정 시스템</h3>
<p>VIRDY는 ARKit 호환 52종 BlendShape를 지원한다.</p>
<h4>BlendShape 카테고리</h4>
<table>
<thead><tr><th>카테고리</th><th>주요 항목</th></tr></thead>
<tbody>
<tr><td>눈 (Eyes)</td><td>깜빡임, 시선 방향, 찡그림, 크게뜨기</td></tr>
<tr><td>눈썹 (Brows)</td><td>내리기, 올리기 (안쪽/바깥쪽)</td></tr>
<tr><td>입/턱 (Mouth/Jaw)</td><td>미소, 찡그림, 오므리기, 벌리기, 좌우 이동</td></tr>
<tr><td>볼/코/혀</td><td>볼 부풀리기, 코 찡그림, 혀 내밀기</td></tr>
</tbody></table>
<h4>민감도 조절</h4>
<p>사용자가 부위별로 트래킹 민감도를 조절할 수 있다.</p>
<table>
<thead><tr><th>파라미터</th><th>범위</th><th>설명</th></tr></thead>
<tbody>
<tr><td>시선 강도 (Gaze)</td><td>0~1</td><td>눈동자 움직임 반영 정도</td></tr>
<tr><td>눈썹 강도 (Eyebrow)</td><td>0~1</td><td>눈썹 움직임 반영 정도</td></tr>
<tr><td>입/볼 강도 (Mouth)</td><td>0~1</td><td>입과 볼 움직임 반영 정도</td></tr>
</tbody></table>
<h4>Facial Blendshape Config 세부 조절</h4>
<p>ARKit 52 Blendshape를 개별 세부 조절할 수 있다. <br> e.g. 움직임을 0.4 정도만 움직여도 0.8로 Output이 나오게 하는 기능.</p>
<h3>2.5 아바타 블렌드셰이프 커스텀 설정</h3>
<p>기본 표정 외에 사용자가 추가 BlendShape를 설정할 수 있다.</p>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td>BlendShape 목록 조회</td><td>VRM에 포함된 모든 BlendShape 표시</td></tr>
<tr><td>커스텀 표정 매핑</td><td>특정 키/트리거에 BlendShape 조합 할당</td></tr>
<tr><td>GameObject 연동</td><td>BlendShape와 연계하여 오브젝트 활성화/비활성화</td></tr>
</tbody></table>
<h3>2.6 액터(Actor) 구조</h3>
<p><strong>Actor</strong>는 아바타 + 트래커 조합의 단위이다. 1명의 사용자가 여러 Actor를 동시에 운용할 수 있으며, 세션의 수용량은 플레이어 수가 아닌 <strong>총 Actor 수</strong>로 제한된다.</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>개인 Actor 수</td><td>플랜별 상이 (Free/Starter 1개, Pro 2개, Studio 4개, Enterprise 6개+)</td></tr>
<tr><td>구성</td><td>아바타 1개 + Facial 트래커 1개 + Body 트래커 1개 + Hand 트래커 1개</td></tr>
<tr><td>저장</td><td>슬롯별 설정이 서버에 저장됨 (로컬은 캐시 용도)</td></tr>
</tbody></table>
<blockquote>Actor 수 제한은 서버 측에서 검증한다. 상세 내용은 라이선스 체계 참조.</blockquote>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 암호화 및 저작권 보호</h3>
<ul>
<li>VRM 파일은 업로드/캐시 시 암호화 적용</li>
<li>로컬 캐시에서도 암호화 상태로 저장되어 직접 파일 추출 방지</li>
<li>VRM 메타데이터의 저작권 정보 존중 (AllowedUser, ViolentUsage 등)</li>
</ul>
<h3>3.2 메모리 관리</h3>
<ul>
<li>아바타 텍스처는 메모리 사용의 주요 원인</li>
<li>월드 진입 시 아바타 + 월드가 동시에 로드되므로 메모리 예산 관리 필요</li>
<li>다수 아바타 동시 로드 시 (멀티유저) LOD 또는 품질 조절 검토</li>
<ul>
<li>VIRDY-SDK를 통한 Avatar Build 시, Analysis 분석 및 자동 최적화 기능 개발 예정</li>
</ul>
</ul>
<h3>3.4 네트워크 동기화 대상</h3>
<p>아바타의 네트워크 동기화 데이터:</p>
<table>
<thead><tr><th>데이터</th><th>수량</th><th>설명</th></tr></thead>
<tbody>
<tr><td>본 회전</td><td>22개</td><td>Hips ~ Toes</td></tr>
<tr><td>손가락 포즈</td><td>40개</td><td>양손 각 20개</td></tr>
<tr><td>표정 값</td><td>100개</td><td>BlendShape 값</td></tr>
<tr><td>위치</td><td>3개</td><td>Hip + 손 오프셋</td></tr>
</tbody></table>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>지원하지 않는 VRM 버전 업로드</td><td>오류 메시지 + 지원 버전 안내</td></tr>
<tr><td>VRM 본 매핑 불완전 (필수 본 누락)</td><td>경고 표시, 누락 본은 기본 포즈</td></tr>
<tr><td>아바타 파일 손상</td><td>로드 실패 → 재업로드 안내</td></tr>
<tr><td>아바타 슬롯 초과 (50개)</td><td>업로드 실패 안내, 기존 아바타 정리 권유</td></tr>
<tr><td>아바타 용량 초과 (200MB)</td><td>업로드 실패 안내, 파일 최적화 권유</td></tr>
<tr><td>로컬 캐시 손상</td><td>자동 재다운로드</td></tr>
<tr><td>동일 아바타를 중복 업로드</td><td>기존 아바타 덮어쓰기 안내. 중복 감지는 파일명, VRM 버전</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>VRM 1.0</strong></td><td>차세대 VRM 포맷 지원</td><td>높음</td></tr>
<tr><td><strong>자체 확장자</strong></td><td>애니메이션/스크립트 내장 아바타 포맷, SDK에서 빌드</td><td>높음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>트래커 시스템</li>
<li>SDK</li>
<li>네트워크 시스템</li>
<li>사용자 플로우</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_02_Tracker_System">
            <div class="section-header">
                <h2>⚙️ 트래커 시스템</h2>
            </div>
            <h1>트래커 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>트래커 시스템은 다양한 모션캡처 장비를 VIRDY에 연결하여 실시간으로 아바타를 구동하는 핵심 기능이다. Facial(얼굴), Body(바디), Hand(핸드) 3개 카테고리로 총 14종 이상의 장비를 지원하며, 개인 크리에이터의 저가 장비부터 프로덕션 스튜디오의 전문 장비까지 폭넓게 대응한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 트래커 데이터 파이프라인</h3>
<p>트래커 데이터는 아래 단계를 거쳐 아바타에 적용된다.</p>
<table>
<thead><tr><th>단계</th><th>동작</th><th>설명</th></tr></thead>
<tbody>
<tr><td>1</td><td>장비 입력</td><td>물리 장비로부터 실시간 데이터 수신</td></tr>
<tr><td>2</td><td>TrackerData 변환</td><td>장비별 데이터를 통일된 구조로 변환</td></tr>
<tr><td>3</td><td>Puppet 생성</td><td>트래커별 중간 본 계층 구조 생성</td></tr>
<tr><td>4</td><td>리타게팅</td><td>본 매핑 및 IK 계산을 통해 아바타 본에 맞춤</td></tr>
<tr><td>5</td><td>아바타 적용</td><td>최종 아바타 본에 포즈 적용</td></tr>
<tr><td>6</td><td>네트워크 동기화</td><td>적용된 포즈를 네트워크로 전송</td></tr>
</tbody></table>
<h3>2.2 액터와 트래커 관계</h3>
<p>하나의 Actor(액터)에는 아래 트래커가 각 1개씩 할당된다.</p>
<table>
<thead><tr><th>트래커</th><th>역할</th><th>필수 여부</th></tr></thead>
<tbody>
<tr><td><strong>Facial Tracker</strong></td><td>얼굴 표정 (52종 BlendShape)</td><td>선택</td></tr>
<tr><td><strong>Motion Tracker</strong></td><td>신체 움직임 (본 회전)</td><td>선택</td></tr>
<tr><td><strong>Hand Tracker</strong></td><td>손가락 움직임 (30개 본)</td><td>선택</td></tr>
</tbody></table>
<blockquote>모든 트래커는 선택 사항이다. 연결하지 않은 트래커의 해당 부위는 기본 포즈를 유지한다.</blockquote>
<blockquote>일부 Motion Tracker는 Facial/Hand 또한 움직일 수 있다.</blockquote>
<h3>2.3 Facial Tracker (얼굴 트래킹)</h3>
<h4>지원 장비</h4>
<table>
<thead><tr><th>장비</th><th>연결 방식</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>iFacialMocap</strong></td><td>WiFi/UDP</td><td>iPhone 기반, 가장 보편적</td></tr>
<tr><td><strong>VTube Studio</strong></td><td>로컬 API</td><td>기존 VTS 사용자 대상</td></tr>
<tr><td><strong>Facemotion3D</strong></td><td>WiFi/UDP</td><td>iPhone 기반, iFacial과 VIRDY 내부 기능 차이 없음</td></tr>
<tr><td><strong>OpenSeeFace</strong></td><td>로컬</td><td>무료, 웹캠 기반</td></tr>
<tr><td><strong>OSC Protocol</strong></td><td>OSC</td><td>범용 프로토콜, 커스텀 연동</td></tr>
</tbody></table>
<h4>페이셜 민감도 설정</h4>
<p>사용자가 부위별로 트래킹 반영 정도를 조절할 수 있다.</p>
<table>
<thead><tr><th>파라미터</th><th>범위</th><th>설명</th></tr></thead>
<tbody>
<tr><td>시선 강도 (Gaze)</td><td>0~1</td><td>눈동자 움직임 반영 정도</td></tr>
<tr><td>눈썹 강도 (Eyebrow)</td><td>0~1</td><td>눈썹 움직임 반영 정도</td></tr>
<tr><td>입/볼 강도 (Mouth)</td><td>0~1</td><td>입과 볼 움직임 반영 정도</td></tr>
</tbody></table>
<p>Facial Blendshape Config를 통해 더욱 상세한 설정이 가능하다.</p>
<h4>Spine 연동</h4>
<p>페이셜 트래킹만 사용할 때, 머리 방향에 따라 상체(Spine)가 자연스럽게 따라 움직이는 기능이다.</p>
<table>
<thead><tr><th>파라미터</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Scale</td><td>Spine 회전 크기 조절</td></tr>
<tr><td>Lerp</td><td>Spine 회전 보간 속도 조절</td></tr>
</tbody></table>
<h3>2.4 Motion Tracker (바디 트래킹)</h3>
<h4>지원 장비</h4>
<table>
<thead><tr><th>장비</th><th>연결 방식</th><th>가격대</th><th>대상</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>SteamVR</strong></td><td>SteamVR API</td><td>중저가</td><td>개인 크리에이터</td><td>컨트롤러 + 트래커 조합</td></tr>
<tr><td><strong>VMC Protocol</strong></td><td>UDP/OSC</td><td>무료</td><td>개인 크리에이터</td><td>다른 모캡 앱과 연동</td></tr>
<tr><td><strong>Xsens</strong></td><td>전용 SDK</td><td>고가</td><td>개인/기업 크리에이터</td><td>관성 센서 기반</td></tr>
<tr><td><strong>MOVIN</strong></td><td>전용 SDK</td><td>고가</td><td>개인/기업 크리에이터</td><td>관성 센서 기반</td></tr>
<tr><td><strong>Vicon</strong></td><td>DataStream SDK</td><td>최고가</td><td>전문 스튜디오</td><td>광학 기반, 최고 품질</td></tr>
</tbody></table>
<h4>SteamVR 트래커 할당</h4>
<p>SteamVR 사용 시, 물리 장치를 신체 부위에 할당한다.</p>
<table>
<thead><tr><th>부위</th><th>장치 예시</th></tr></thead>
<tbody>
<tr><td>머리</td><td>Tracker 1 혹은 HMD</td></tr>
<tr><td>왼손</td><td>Controller L</td></tr>
<tr><td>오른손</td><td>Controller R</td></tr>
<tr><td>허리</td><td>Tracker 2</td></tr>
<tr><td>왼발</td><td>Tracker 3</td></tr>
<tr><td>오른발</td><td>Tracker 4</td></tr>
</tbody></table>
<p>추가 옵션:</p>
<ul>
<li>화면에 SteamVR 트래커 위치 시각화</li>
<li>모션 미러링 (좌우 반전)</li>
<li>캘리브레이션 포즈: T Pose, I Pose 지원</li>
</ul>
<h4>Vicon 특이사항</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>리타게팅</td><td>별도의 고급 리타게팅 처리 사용</td></tr>
<tr><td>미러링</td><td>Vicon 자체 미러링 방식 적용 (일반 미러링과 분리)</td></tr>
<tr><td>Prop 트래킹</td><td>소품(Props) 트래킹 지원 — 물체를 별도로 트래킹하며 Hand와 세밀한 인터랙션</td></tr>
</tbody></table>
<h3>2.5 Hand Tracker (핸드 트래킹)</h3>
<h4>지원 장비</h4>
<table>
<thead><tr><th>장비</th><th>연결 방식</th><th>특징</th><th>대상</th></tr></thead>
<tbody>
<tr><td><strong>Leap Motion</strong></td><td>USB/전용 SDK</td><td>책상 위 센서, 저렴</td><td>개인 크리에이터</td></tr>
<tr><td><strong>Mollisen</strong></td><td>전용 SDK</td><td>장갑형</td><td>개인 크리에이터</td></tr>
<tr><td><strong>Manus</strong></td><td>전용 SDK</td><td>장갑형, 고품질</td><td>전문가</td></tr>
<tr><td><strong>StretchSense</strong></td><td>전용 SDK</td><td>장갑형</td><td>전문가</td></tr>
</tbody></table>
<h4>손가락 본 구조</h4>
<table>
<thead><tr><th>구분</th><th>본 수</th><th>설명</th></tr></thead>
<tbody>
<tr><td>왼손</td><td>15개</td><td>엄지~새끼 각 3관절</td></tr>
<tr><td>오른손</td><td>15개</td><td>엄지~새끼 각 3관절</td></tr>
<tr><td>합계</td><td>30개</td><td>네트워크 동기화 시 40개 muscle 값으로 전송</td></tr>
</tbody></table>
<h4>Leap Motion 설정</h4>
<table>
<thead><tr><th>파라미터</th><th>설명</th></tr></thead>
<tbody>
<tr><td>모션 강도</td><td>손가락 움직임 반영 정도</td></tr>
<tr><td>위치 오프셋 (X/Y/Z)</td><td>센서 위치 보정</td></tr>
<tr><td>회전 오프셋 (X/Y/Z)</td><td>센서 방향 보정</td></tr>
</tbody></table>
<h4>Mollisen 캘리브레이션</h4>
<p>Mollisen 장갑은 2단계 캘리브레이션이 필요하다.</p>
<table>
<thead><tr><th>단계</th><th>포즈</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1단계 (MIN)</td><td>보자기 (손 최대 펴기)</td><td>최소값 기준점 설정</td></tr>
<tr><td>2단계 (MAX)</td><td>주먹 (손 최대 쥐기)</td><td>최대값 기준점 설정</td></tr>
</tbody></table>
<p>캘리브레이션 모드: 양손 / 왼손만 / 오른손만 선택 가능</p>
<h3>2.6 SteamVR 캘리브레이션 시스템</h3>
<h4>캘리브레이션 모드</h4>
<table>
<thead><tr><th>모드</th><th>포즈</th><th>용도</th></tr></thead>
<tbody>
<tr><td><strong>T-Pose</strong></td><td>양팔 수평 펴기</td><td>바디 트래킹 기본 캘리브레이션</td></tr>
<tr><td><strong>I-Pose</strong></td><td>차렷 자세</td><td>대체 캘리브레이션</td></tr>
</tbody></table>
<h4>캘리브레이션 플로우</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>캘리브레이션 포즈 선택 및 시작 버튼 클릭</td></tr>
<tr><td>2</td><td>T-Pose 또는 I-Pose 실루엣, 캘리 안내 메시지 표시</td></tr>
<tr><td>3</td><td>카운트다운 (초 단위)</td></tr>
<tr><td>4</td><td>포즈 캡처 및 기준점 설정</td></tr>
<tr><td>5</td><td>캘리브레이션 완료 → 정상 트래킹 시작</td></tr>
</tbody></table>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 장비별 연결 방식 차이</h3>
<p>각 장비마다 연결 프로토콜이 다르므로, 통일된 TrackerData 인터페이스로 추상화해야 한다.</p>
<table>
<thead><tr><th>연결 유형</th><th>해당 장비</th><th>고려사항</th></tr></thead>
<tbody>
<tr><td>WiFi/UDP</td><td>iFacialMocap, Facemotion3D</td><td>네트워크 지연, 방화벽</td></tr>
<tr><td>로컬 API</td><td>VTube Studio, OpenSeeFace</td><td>포트 충돌 가능</td></tr>
<tr><td>OSC</td><td>OSC Protocol, VMC</td><td>표준 프로토콜, 설정 유연</td></tr>
<tr><td>전용 SDK</td><td>SteamVR, Vicon, Xsens, MOVIN, Manus, Mollisen, StretchSense, Leap Motion</td><td>SDK 버전 관리, 라이선스</td></tr>
</tbody></table>
<h3>3.2 다중 트래커 우선순위</h3>
<p>Facial + Motion + Hand가 동시에 활성화될 때 본 충돌을 방지해야 한다.</p>
<ul>
<li>Eye 본은 Facial 전용으로 처리 (Motion에서 제외)</li>
<li>손가락 본은 Hand 전용으로 처리 (Motion에서 제외)</li>
<li>나머지 본은 Motion이 우선</li>
</ul>
<h3>3.3 Vicon 예외 처리</h3>
<p>Vicon은 다른 장비와 처리 방식이 다르다.</p>
<ul>
<li>별도 리타게팅 컴포넌트 사용</li>
<li>미러링 로직 분리</li>
<li>세밀한 Prop 트래킹 추가 지원</li>
</ul>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>트래커 연결 중 장비 연결 해제</td><td>마지막 포즈 프리징 (혹은 장비 Timeout용 대기 모션 재생), 재연결 안내</td></tr>
<tr><td>WiFi 트래커 네트워크 지연</td><td>프레임 보간으로 끊김 방지</td></tr>
<tr><td>SteamVR 트래커 할당 충돌 (동일 장치 중복)</td><td>경고 표시, 재할당 유도</td></tr>
<tr><td>캘리브레이션 미 진행 상태로 월드 진입 시도</td><td>캘리브레이션/리타게팅 안내</td></tr>
<tr><td>Facial만 연결 시</td><td>Spine은 기본 연동, 추후 Facial Pendulum Tracking 지원</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>웹캠 페이셜</strong></td><td>XRAnimator, WebCam Motioncapture 등 웹캠 기반 얼굴 트래킹 추가</td><td>높음</td></tr>
<tr><td><strong>트래커 프리셋</strong></td><td>자주 쓰는 장비 조합을 프리셋으로 저장</td><td>중간</td></tr>
<tr><td><strong>MotionBuilder 연동</strong></td><td>Autodesk MotionBuilder 실시간 스트리밍</td><td>낮음</td></tr>
<tr><td><strong>Optitrack</strong></td><td>광학 모캡 추가 지원</td><td>낮음</td></tr>
<tr><td><strong>자동 장비 감지</strong></td><td>연결된 장비 자동 인식 및 설정 제안</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>아바타 시스템</li>
<li>네트워크 시스템</li>
<li>UI 기획</li>
<li>사용자 플로우</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_03_Camera_System">
            <div class="section-header">
                <h2>⚙️ 카메라 시스템</h2>
            </div>
            <h1>카메라 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>카메라 시스템은 VIRDY의 가상 방송 환경에서 촬영, 모니터링, 방송 출력을 담당한다. 10개 채널의 가상 카메라를 운영하며, 4가지 View 모드와 Channel Link를 통해 개인 크리에이터부터 프로덕션 스튜디오까지 다양한 워크플로우를 지원한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 10채널 가상 카메라 구조</h3>
<table>
<thead><tr><th>채널</th><th>이름</th><th>타입</th><th>설명</th></tr></thead>
<tbody>
<tr><td>0</td><td>Free CAM</td><td>자유 카메라</td><td>WASD + 마우스로 자유 이동, 프리셋 저장 불가</td></tr>
<tr><td>1~9</td><td>CAM 01 ~ CAM 09</td><td>고정 카메라</td><td>Transform 프리셋 저장 가능, Channel Link 가능</td></tr>
</tbody></table>
<h4>카메라별 저장 데이터</h4>
<table>
<thead><tr><th>데이터</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Position</td><td>카메라 위치 (3D 좌표)</td></tr>
<tr><td>Rotation</td><td>카메라 회전 (Euler 각도)</td></tr>
<tr><td>Focal Length</td><td>초점 거리 (줌)</td></tr>
<tr><td>카메라 설정</td><td>DOF, Follow, LookAt 등</td></tr>
</tbody></table>
<h3>2.2 카메라 모드</h3>
<h4>FreeCam (자유 카메라)</h4>
<table>
<thead><tr><th>조작</th><th>키</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기본 이동</td><td>W / A / S / D</td><td>카메라 앞/뒤/좌/우 이동</td></tr>
<tr><td>상승/하강</td><td>Q / E</td><td>카메라 상하 이동</td></tr>
<tr><td>빠른 이동</td><td>Shift</td><td>카메라 이동 속도 증가</td></tr>
<tr><td>시점 회전</td><td>마우스 우클릭 드래그</td><td>카메라 방향 변경</td></tr>
<tr><td>줌</td><td>마우스 휠</td><td>Focal Length 조절</td></tr>
</tbody></table>
<p>조절 가능한 설정:</p>
<table>
<thead><tr><th>설정</th><th>설명</th></tr></thead>
<tbody>
<tr><td>카메라 속도</td><td>이동 속도</td></tr>
<tr><td>줌 속도</td><td>마우스 휠 민감도</td></tr>
<tr><td>회전 민감도</td><td>마우스 드래그 민감도</td></tr>
</tbody></table>
<h4>Fixed Camera (고정 카메라)</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td>카메라 위치 저장/로드</td><td>Transform을 저장하고 불러오기</td></tr>
<tr><td>Channel Link</td><td>다른 유저에게 카메라 뷰 공유</td></tr>
<tr><td>Spectator 미리보기</td><td>9개 카메라 동시 미리보기</td></tr>
<tr><td>전체 카메라 저장/로드</td></tr>
</tbody></table>
<p>모든 카메라 로컬 저장 및 불러오기 (월드 재접속, 변경시 사용)</p>
<h3>2.3 View 모드</h3>
<p>4가지 View 모드를 제공하여 다양한 상황에 맞는 화면 구성을 지원한다.</p>
<table>
<thead><tr><th>모드</th><th>화면 구성</th><th>용도</th></tr></thead>
<tbody>
<tr><td><strong>Default</strong></td><td>Main Screen만 표시</td><td>일반 방송 (개인 크리에이터, 화면녹화)</td></tr>
<tr><td><strong>Manager</strong></td><td>Main + Sub + Spectator (9분할)</td><td>제작/매니저 모드</td></tr>
<tr><td><strong>Studio</strong></td><td>9분할 모니터링 화면</td><td>스튜디오 모니터링</td></tr>
<tr><td><strong>Spout</strong></td><td>Spout 텍스처 출력</td><td>OBS 연동 방송 송출</td></tr>
</tbody></table>
<h4>Default 모드</h4>
<ul>
<li>Main Screen 단일 화면</li>
<li>가장 기본적인 방송 화면 구성</li>
</ul>
<h4>Manager 모드</h4>
<table>
<thead><tr><th>영역</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Main Screen</td><td>메인 송출 화면</td></tr>
<tr><td>Spectator View</td><td>CAM 01~09의 9분할 미리보기</td></tr>
<tr><td>Manager CAM</td><td>자유롭게 조작하는 FreeCam</td></tr>
</tbody></table>
<h4>Studio 모드</h4>
<ul>
<li>9분할 화면으로 CAM 01~09를 동시 모니터링</li>
<li>스튜디오 환경에서 다수 카메라를 한 눈에 확인</li>
<li>메모리/GPU 최적화: 모니터링 카메라 해상도 / 프레임 다운그레이드 기능 제공</li>
</ul>
<h4>Spout 모드</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>출력 경로</td><td>VIRDY → Spout Sender → OBS (Spout2 Source)</td></tr>
<tr><td>출력 내용</td><td>Main Screen만 전송 (UI 제외)</td></tr>
<tr><td>장점</td><td>GPU 메모리 직접 공유로 저지연, 채팅 등 UI가 방송에 포함되지 않음</td></tr>
<tr><td>해상도</td><td>설정에 따라 조절 가능</td></tr>
</tbody></table>
<h3>2.4 Channel Link 시스템</h3>
<p>Channel Link는 멀티유저 환경에서 다른 유저의 카메라 뷰를 주고받는 기능이다.</p>
<h4>연결 모드</h4>
<table>
<thead><tr><th>모드</th><th>설명</th></tr></thead>
<tbody>
<tr><td>없음 (None)</td><td>Channel Link 미사용</td></tr>
<tr><td>송출 (Sending)</td><td>내 카메라 뷰를 다른 유저에게 전송</td></tr>
<tr><td>수신 (Receiving)</td><td>다른 유저의 카메라 뷰를 수신</td></tr>
</tbody></table>
<h4>연결 제약</h4>
<table>
<thead><tr><th>항목</th><th>제한</th></tr></thead>
<tbody>
<tr><td>최대 송출 대상</td><td>제한 없음</td></tr>
<tr><td>이중 공유</td><td>불가 (A→B→C 형태 차단)</td></tr>
</tbody></table>
<h4>PD 워크플로우 (프로덕션)</h4>
<p>Channel Link를 활용한 전형적인 프로덕션 구성:</p>
<table>
<thead><tr><th>역할</th><th>동작</th></tr></thead>
<tbody>
<tr><td>카메라맨 B</td><td>CAM 1~3 촬영 → PD의 1~3 고정 카메라에 Send</td></tr>
<tr><td>카메라맨 C</td><td>CAM 1~3 촬영 → PD의 4~6 고정 카메라에 Send</td></tr>
<tr><td>카메라맨 D</td><td>CAM 1~3 촬영 → PD의 7~9 고정 카메라에 Send</td></tr>
<tr><td>PD (A)</td><td>9개 채널 Receive → Main Screen에 카메라 스위칭 (R+1~9)</td></tr>
<tr><td>방송 송출</td><td>PD의 Main Screen → Creator의 Main Screen으로 Send → Creator의 Main Screen을 방송 송출 (OBS Game Capture 혹은 Spout2)</td></tr>
</tbody></table>
<h3>2.5 카메라 설정</h3>
<h4>기본 설정</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>카메라 속도</td><td>FreeCam 이동 속도</td></tr>
<tr><td>줌 속도</td><td>마우스 휠 민감도 및 Z, C 세기</td></tr>
<tr><td>회전 민감도</td><td>마우스 드래그 민감도</td></tr>
</tbody></table>
<h4>렌즈 설정</h4>
<table>
<thead><tr><th>항목</th><th>범위</th><th>설명</th></tr></thead>
<tbody>
<tr><td>초점 거리 (Focal Length)</td><td>20~200mm</td><td>줌 레벨</td></tr>
<tr><td>조리개 (Aperture)</td><td>조절 가능</td><td>배경 흐림 정도 영향</td></tr>
</tbody></table>
<h4>포커스 설정 (DoF)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>포커스 사용</td><td>피사계 심도 활성화/비활성화</td></tr>
<tr><td>포커스 심도</td><td>DoF 블러 강도</td></tr>
<tr><td>자동 포커스 대상</td><td>특정 Actor를 선택하여 자동 초점</td></tr>
</tbody></table>
<h4>Follow / LookAt 설정</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Follow 대상</td><td>카메라가 따라가는 대상 Actor</td></tr>
<tr><td>LookAt 대상</td><td>카메라가 바라보는 대상 Actor</td></tr>
<tr><td>LookAt Offset Y</td><td>바라보기 대상의 Y축 오프셋 (높이 조절)</td></tr>
</tbody></table>
<h3>2.6 카메라 단축키</h3>
<table>
<thead><tr><th>키</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1~9</td><td>해당 번호 카메라로 Main Screen 전환</td></tr>
<tr><td>R</td><td>FreeCam으로 전환</td></tr>
<tr><td>W/A/S/D</td><td>FreeCam 전후좌우 이동</td></tr>
<tr><td>Q/E</td><td>FreeCam 상승/하강</td></tr>
<tr><td>Shift</td><td>FreeCam 빠른 이동</td></tr>
<tr><td>마우스 드래그</td><td>시점 회전</td></tr>
<tr><td>마우스 휠</td><td>줌 인/아웃</td></tr>
<tr><td>V</td><td>장면 크로스페이드 On/Off (전환 애니메이션)</td></tr>
</tbody></table>
<h3>2.7 카메라 전환 및 블렌딩</h3>
<p>카메라 전환 시 크로스페이드 블렌딩을 지원한다.</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>전환 옵션 사용</td><td>V (On/Off)</td></tr>
<tr><td>블렌딩</td><td>부드러운 카메라 전환 애니메이션</td></tr>
</tbody></table>
<h3>2.8 네트워크 동기화</h3>
<p>카메라 데이터는 네트워크를 통해 다른 유저에게 동기화된다.</p>
<table>
<thead><tr><th>동기화 대상</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Position</td><td>카메라 위치</td></tr>
<tr><td>Rotation</td><td>카메라 회전</td></tr>
<tr><td>Focal Length</td><td>초점 거리</td></tr>
<tr><td>Bool 설정 (3개)</td><td>DOF 등 On/Off 설정</td></tr>
<tr><td>Float 설정 (6개)</td><td>민감도, 오프셋 등 수치 설정</td></tr>
</tbody></table>
<p>네트워크 보간(Interpolation)을 통해 카메라 움직임이 부드럽게 전달된다.</p>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 Spout 출력 성능</h3>
<ul>
<li>Spout은 GPU 메모리를 직접 공유하므로 CPU 부하가 낮음</li>
<li>해상도가 높아질수록 VRAM 사용량 증가</li>
<li>OBS 측 Spout2 Source 플러그인 설치 필요</li>
<li>Spout 출력할 UI 별도 문서 항목으로 분류 필요</li>
</ul>
<h3>3.2 Channel Link 네트워크 대역폭</h3>
<ul>
<li>Channel Link는 카메라 Transform만 동기화 (영상 스트리밍이 아님)</li>
<li>데이터 동기화에 대한 최적화 및 압축 등 필요 (변화가 없는데도 계속 업데이트 하면 안 됨)</li>
</ul>
<h3>3.3 카메라 데이터 압축</h3>
<ul>
<li>Position 및 Rotation 데이터 압축</li>
<li>네트워크 대역폭 최소화를 위한 R&D 지속 필요</li>
</ul>
<h3>3.4 Cinemachine 통합</h3>
<ul>
<li>Unity Cinemachine을 활용하여 카메라 블렌딩 및 DoF 처리</li>
<li>CinemachineVirtualCamera: 각 채널의 가상 카메라</li>
<li>CinemachineBrain: 카메라 전환/블렌딩 제어</li>
<li>CinemachineAutoDoFFocus: 자동 피사계 심도 포커스</li>
</ul>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>이중 Channel Link 시도 (A→B→C)</td><td>"이중 공유는 불가능합니다" 경고, 시스템 차단</td></tr>
<tr><td>Channel Link 송출 중 상대방 퇴장</td><td>송출 자동 해제, 알림 표시</td></tr>
<tr><td>Channel Link 수신 중 송출자 퇴장</td><td>수신 자동 해제, 내 카메라 시점으로 복귀</td></tr>
<tr><td>Spout 출력 중 OBS 미실행</td><td>송출 데이터 무시, VIRDY 내부 동작에 영향 없음</td></tr>
<tr><td>카메라 프리셋 저장 후 월드 변경</td><td>프리셋은 어느 월드에서든 로드 가능. 단, 월드 구조에 따라 프리셋 불러올 시 정상적인 카메라 위치가 아닐 수 있음.</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>NDI 출력</strong></td><td>방송 장비 연동용 NDI 프로토콜 지원</td><td>낮음</td></tr>
<tr><td><strong>카메라 애니메이션</strong></td><td>카메라 이동 경로를 사전 설정하여 자동 재생, 인게임 시퀀스 기능</td><td>낮음</td></tr>
<tr><td><strong>카메라 프리셋 공유</strong></td><td>다른 유저와 카메라 프리셋 공유</td><td>장기</td></tr>
<tr><td><strong>렌즈 효과 확장</strong></td><td>필름 그레인, 비네팅 등 시네마 효과 추가</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>사용자 플로우</li>
<li>네트워크 시스템</li>
<li>사용자 역할</li>
<li>UI 기획</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_04_World_System">
            <div class="section-header">
                <h2>⚙️ 월드 시스템</h2>
            </div>
            <h1>월드 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>월드(World)는 VIRDY에서 사용자들이 실시간으로 모여 방송하고 협업하는 가상 공간이다. 사용자는 VIRDY SDK로 Unity 씬을 월드로 빌드하여 업로드하고, 다른 사용자와 공유할 수 있다. 월드는 AssetBundle로 패키징되어 서버(클라우드)에 저장되며, Photon 세션을 통해 멀티유저 환경을 제공한다.</p>
<blockquote>🚧 모든 월드 데이터는 <strong>서버(클라우드)에만 저장</strong>되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용하고, 로컬 캐시는 성능 최적화 목적으로만 사용한다.</blockquote>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 월드 구성요소</h3>
<table>
<thead><tr><th>구성요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>WorldData</strong></td><td>월드 메타데이터 (제목, 설명, 공개설정, 버전 등)</td></tr>
<tr><td><strong>AssetBundle</strong></td><td>Unity 씬이 패키징된 번들 파일</td></tr>
<tr><td><strong>VIRDYWorldDescriptor</strong></td><td>월드 설정 컴포넌트 (스폰 포인트, 라이팅, 렌더러)</td></tr>
<tr><td><strong>Photon Session</strong></td><td>실시간 멀티유저 세션</td></tr>
</tbody></table>
<h3>2.2 월드 데이터 구조</h3>
<h4>기본 정보</h4>
<table>
<thead><tr><th>필드</th><th>설명</th></tr></thead>
<tbody>
<tr><td>worldId</td><td>고유 식별자 (형식: vw_{GUID})</td></tr>
<tr><td>title</td><td>월드 이름</td></tr>
<tr><td>author</td><td>제작자 이름</td></tr>
<tr><td>authorId</td><td>제작자 사용자 ID</td></tr>
<tr><td>description</td><td>월드 설명</td></tr>
<tr><td>sceneName</td><td>AssetBundle 내 씬 경로</td></tr>
<tr><td>fileSize</td><td>파일 크기 (표시용)</td></tr>
</tbody></table>
<h4>버전 및 통계</h4>
<table>
<thead><tr><th>필드</th><th>설명</th></tr></thead>
<tbody>
<tr><td>version</td><td>버전 번호 (업데이트 시 증가)</td></tr>
<tr><td>create</td><td>생성 시간</td></tr>
<tr><td>update</td><td>수정 시간</td></tr>
<tr><td>visits</td><td>방문 횟수</td></tr>
</tbody></table>
<h4>썸네일</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>개수</td><td>3장</td></tr>
<tr><td>포맷</td><td>png, jpg 등</td></tr>
<tr><td>저장</td><td>Firebase Storage</td></tr>
</tbody></table>
<h3>2.3 월드 공개 설정</h3>
<table>
<thead><tr><th>유형</th><th>설명</th><th>접근 가능 사용자</th></tr></thead>
<tbody>
<tr><td><strong>Public</strong></td><td>모든 사용자에게 공개</td><td>전체</td></tr>
<tr><td><strong>Private</strong></td><td>제작자만 접근 가능</td><td>제작자</td></tr>
<tr><td><strong>Private+</strong></td><td>제작자 + 지정 사용자</td><td>제작자 + 공유 대상</td></tr>
</tbody></table>
<h3>2.4 월드 로딩 파이프라인</h3>
<table>
<thead><tr><th>단계</th><th>동작</th><th>설명</th></tr></thead>
<tbody>
<tr><td>1</td><td>메타데이터 다운로드</td><td>Firebase Functions로 월드 데이터 요청</td></tr>
<tr><td>2</td><td>AssetBundle 다운로드</td><td>Firebase Storage에서 다운로드 (또는 로컬 캐시 사용)</td></tr>
<tr><td>3</td><td>AssetBundle 로드</td><td>메모리에 번들 로드</td></tr>
<tr><td>4</td><td>씬 로드</td><td>월드 씬 로드</td></tr>
<tr><td>5</td><td>렌더링 설정</td><td>월드 렌더러 Feature 병합, 필수 기능(NiloToon, ToonLit 등) 보장</td></tr>
<tr><td>7</td><td>SDK 컴포넌트 초기화</td><td>VIRDYBehaviour, VIRDYNetworkBehaviour 초기화 호출</td></tr>
</tbody></table>
<h4>씬 초기화 시 자동 처리</h4>
<table>
<thead><tr><th>항목</th><th>동작</th></tr></thead>
<tbody>
<tr><td>EventSystem</td><td>자동 비활성화 (VIRDY 메인 EventSystem과 충돌 방지)</td></tr>
<tr><td>Camera</td><td>자동 비활성화 (VIRDY 카메라 시스템 사용)</td></tr>
<tr><td>AudioListener</td><td>자동 비활성화 (메인 AudioListener 사용)</td></tr>
<tr><td>레이어 > 29</td><td>자동 재설정 (예약 레이어)</td></tr>
<tr><td>오디오 소스</td><td>AudioMixer "Master/World" 연결</td></tr>
</tbody></table>
<h3>2.6 월드 업로드 및 관리</h3>
<h4>업로드 제한</h4>
<table>
<thead><tr><th>항목</th><th>값</th><th>비고</th></tr></thead>
<tbody>
<tr><td>월드 용량 제한</td><td>Starter: 300MB / Pro 이상: 800MB</td><td>플랜별 상이</td></tr>
<tr><td>저장 위치</td><td>서버 (클라우드)</td><td>로컬 저장 미지원</td></tr>
<tr><td>로컬 캐시</td><td>성능 최적화용</td><td>원본은 서버에만 존재</td></tr>
</tbody></table>
<blockquote>Free 플랜은 월드 업로드가 불가능하다. 상세 내용은 라이선스 체계 참조.</blockquote>
<h4>신규 월드 업로드</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>파일 다이얼로그로 AssetBundle 파일 선택</td></tr>
<tr><td>2</td><td>씬 경로 및 파일 크기 추출</td></tr>
<tr><td>3</td><td><strong>용량 검증 (플랜별 제한 초과 시 업로드 실패)</strong></td></tr>
<tr><td>4</td><td>썸네일 3장 업로드</td></tr>
<tr><td>5</td><td>AssetBundle을 서버 Storage에 업로드</td></tr>
<tr><td>6</td><td>DB에 월드 메타데이터 저장</td></tr>
<tr><td>7</td><td>버전 번호 초기화 (version = 1)</td></tr>
</tbody></table>
<h4>월드 업데이트</h4>
<table>
<thead><tr><th>변경 사항</th><th>동작</th></tr></thead>
<tbody>
<tr><td>메타데이터만 변경 (제목, 설명, 공개설정)</td><td>Firestore 직접 업데이트</td></tr>
<tr><td>파일 변경</td><td>썸네일/AssetBundle 재업로드 + version 증가</td></tr>
<tr><td>공유 대상 변경</td><td>shared 관련 DB Collection만 업데이트</td></tr>
</tbody></table>
<h4>월드 삭제</h4>
<p>Firestore 메타데이터 + Storage 파일 + 로컬 캐시(?)를 모두 삭제한다.</p>
<h3>2.7 월드 목록 관리</h3>
<table>
<thead><tr><th>목록</th><th>설명</th></tr></thead>
<tbody>
<tr><td>전체 공개 월드</td><td>worlds_public 컬렉션의 모든 월드</td></tr>
<tr><td>내 월드</td><td>내가 제작한 월드</td></tr>
<tr><td>공유받은 월드</td><td>다른 사용자가 나에게 공유한 월드</td></tr>
<tr><td>즐겨찾기 월드</td><td>즐겨찾기에 추가한 월드</td></tr>
</tbody></table>
<h4>정렬 옵션</h4>
<table>
<thead><tr><th>옵션</th><th>기준</th></tr></thead>
<tbody>
<tr><td>최신순</td><td>update 내림차순</td></tr>
<tr><td>오래된순</td><td>update 오름차순</td></tr>
<tr><td>인기순</td><td>visits 내림차순</td></tr>
<tr><td>비인기순</td><td>visits 오름차순</td></tr>
</tbody></table>
<h3>2.8 VIRDYWorldDescriptor</h3>
<p>월드 씬에 필수적인 SDK 컴포넌트로, 아래 설정을 포함한다.</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>SpawnPoint</td><td>플레이어 스폰 위치 (미설정 시 Descriptor 위치 사용)</td></tr>
<tr><td>RendererData</td><td>월드 전용 렌더러 설정 (오버라이드 가능)</td></tr>
<tr><td>GlobalVolume</td><td>포스트 프로세싱 볼륨</td></tr>
<tr><td>CustomDirectionalLight</td><td>월드 방향광 (선택)</td></tr>
<tr><td>UnityVersion / URPVersion</td><td>빌드 환경 버전 정보</td></tr>
</tbody></table>
<p>렌더러 오버라이드 시, VIRDY는 월드의 렌더러 기능을 적용하되 NiloToon/ToonLit(아바타 렌더링)과 HighlightPlus(하이라이트)는 반드시 보장한다.</p>
<h3>2.9 런타임 커스터마이징</h3>
<p>월드 진입 후 실시간으로 조절할 수 있는 항목이다. 세션 내 모든 유저가 Slider UI를 통해 조작할 수 있으며, 변경 사항은 세션 전체에 실시간으로 동기화된다.</p>
<h4>방향광(Directional Light) 제어</h4>
<table>
<thead><tr><th>파라미터</th><th>범위</th><th>UI</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Intensity</td><td>0~10</td><td>Slider</td><td>광원 강도</td></tr>
<tr><td>Rotation X</td><td>0°~360°</td><td>Slider</td><td>수직 회전 (태양 고도)</td></tr>
<tr><td>Rotation Y</td><td>0°~360°</td><td>Slider</td><td>수평 회전 (태양 방위)</td></tr>
</tbody></table>
<h4>포스트 프로세싱 제어</h4>
<table>
<thead><tr><th>효과</th><th>조절 항목</th><th>UI</th></tr></thead>
<tbody>
<tr><td><strong>Bloom</strong></td><td>Threshold, Intensity, Scatter, Enable</td><td>Slider + Toggle</td></tr>
<tr><td><strong>Color Adjustments</strong></td><td>Post Exposure, Contrast, Saturation, Enable</td><td>Slider + Toggle</td></tr>
</tbody></table>
<h4>멀티유저 동기화 플로우</h4>
<p>세션 내 Light/PostProcess 값은 <strong>모든 유저에게 공유되는 단일 상태</strong>이다. 누구든 값을 변경하면 세션 전체에 즉시 반영된다.</p>
<table>
<thead><tr><th>단계</th><th>동작</th><th>설명</th></tr></thead>
<tbody>
<tr><td>1</td><td>유저가 Slider를 조작</td><td>방향광 Intensity, Rotation 또는 PostProcess 파라미터 변경</td></tr>
<tr><td>2</td><td>로컬에 즉시 적용</td><td>조작한 유저의 화면에 변경값이 즉시 반영</td></tr>
<tr><td>3</td><td>RPC로 전체 전파</td><td>StateAuthority → 모든 Proxy에 Reliable RPC 전송</td></tr>
<tr><td>4</td><td>전체 유저에게 적용</td><td>세션 내 모든 유저의 화면에 동일한 값이 반영</td></tr>
</tbody></table>
<p><strong>시나리오 예시:</strong></p>
<blockquote>유저 A, B, C, D가 같은 세션에 접속해 있다.</blockquote>
<blockquote>1. 유저 A가 Directional Light의 Intensity를 5로 조절한다 → A, B, C, D 모두 Intensity 5가 적용된다.<br>2. 이후 유저 C가 Light의 Rotation X를 45°로 변경한다 → A, B, C, D 모두 Rotation X 45°가 적용된다.<br>3. 유저 B가 Bloom의 Intensity를 높인다 → A, B, C, D 모두 동일한 Bloom Intensity가 적용된다.</blockquote>
<blockquote>즉, <strong>마지막으로 조작한 유저의 값이 세션 전체의 현재 상태</strong>가 된다.</blockquote>
<h4>동기화 특성</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>제어 권한</td><td>세션 내 모든 유저가 조작 가능 (역할 제한 없음)</td></tr>
<tr><td>동기화 방식</td><td>RPC (StateAuthority → Proxies, Reliable)</td></tr>
<tr><td>적용 범위</td><td>세션 전체 (모든 접속자에게 동일하게 반영)</td></tr>
<tr><td>충돌 처리</td><td>마지막 조작값이 최종값</td></tr>
<tr><td>후속 참가자</td><td>세션 참가 시 현재 상태값을 수신하여 동기화</td></tr>
</tbody></table>
<h3>2.10 세션 관리</h3>
<h4>세션 생성</h4>
<p>유저가 월드를 선택하고 "월드 생성" 버튼을 누르면 본인은 세션으로 이동, 4자리 숫자 세션 코드가 생성된다.</p>
<h4>세션 참가</h4>
<table>
<thead><tr><th>방법</th><th>설명</th></tr></thead>
<tbody>
<tr><td>세션 코드 입력</td><td>4자리 코드를 입력하여 참가</td></tr>
<tr><td>친구 초대/따라가기</td><td>소셜 기능을 통해 참가</td></tr>
</tbody></table>
<h3>2.11 월드 언로드</h3>
<p>월드에서 나갈 때 데이터 및 메모리 정리에 대한 순서가 필요할지 개발팀 문의 예정.</p>
<h3>2.12 월드 제작 가이드라인</h3>
<h4>필수 구성요소</h4>
<table>
<thead><tr><th>구성요소</th><th>필수 여부</th><th>설명</th></tr></thead>
<tbody>
<tr><td>VIRDYWorldDescriptor</td><td>필수</td><td>월드 설정 앵커</td></tr>
<tr><td>Spawn Point Transform</td><td>필수</td><td>플레이어 스폰 위치</td></tr>
<tr><td>Directional Light</td><td>권장</td><td>주 광원</td></tr>
<tr><td>Volume (Post Processing)</td><td>권장</td><td>포스트 프로세싱</td></tr>
</tbody></table>
<h4>성능 권장사항</h4>
<table>
<thead><tr><th>항목</th><th>권장 값</th></tr></thead>
<tbody>
<tr><td>Draw Calls</td><td>300 미만</td></tr>
<tr><td>폴리곤 수</td><td>50만 미만</td></tr>
<tr><td>텍스처 메모리</td><td>개별 텍스처 2048 미만 사용 권장</td></tr>
<tr><td>실시간 광원</td><td>4개 미만</td></tr>
<tr><td>라이트맵</td><td>사용 권장</td></tr>
</tbody></table>
<h4>제작 시 주의사항</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Cinemachine Camera 추가 금지</td><td>VIRDY 카메라 시스템과 충돌</td></tr>
<tr><td>AudioListener 추가 금지</td><td>메인 AudioListener와 충돌</td></tr>
<tr><td>레이어 30 이상 사용 자제</td><td>예약된 레이어</td></tr>
<tr><td>오디오 소스</td><td>AudioMixer "Master/World" 사용</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 AssetBundle 호환성</h3>
<ul>
<li>월드 AssetBundle은 Streamed Scene AssetBundle이어야 함 (1개 씬)</li>
<li>Unity 버전 및 URP 버전이 VIRDY 클라이언트와 호환되어야 함</li>
<li>VIRDYWorldDescriptor에 빌드 환경 버전 정보를 기록하여 호환성 추적</li>
</ul>
<h3>3.2 메모리 관리</h3>
<ul>
<li>AssetBundle 로드 시 메모리 급증 가능 (특히 텍스처가 많은 월드)</li>
<li>언로드 시 `Unload(true)`로 완전 해제 필수</li>
<li>월드 + 아바타가 동시에 로드되므로 총 메모리 예산 관리 필요</li>
</ul>
<h3>3.3 렌더러 병합 시 필수 기능 보장</h3>
<p>월드가 커스텀 렌더러를 사용할 경우에도 NiloToon/ToonLit(아바타 셰이더)와 HighlightPlus(상호작용 하이라이트)가 반드시 포함되어야 한다.</p>
<h3>3.4 네트워크 동기화 범위</h3>
<p>메인 라이트 및 포스트 프로세싱 설정 변경은 RPC를 통해 모든 접속자에게 동기화된다. 세션 내 어떤 유저든 Slider를 조작하면 모든 참가자에게 동일하게 적용된다.</p>
<ul>
<li><strong>동기화 대상</strong>: Directional Light (Intensity, Rotation X/Y) + PostProcess (Bloom, Color Adjustments)</li>
<li><strong>동기화 단위</strong>: 세션 전체 (개별 유저 단위가 아님)</li>
<li><strong>충돌 정책</strong>: Last-Write-Wins — 여러 유저가 동시에 조작할 경우 마지막 RPC가 최종값이 됨</li>
<li><strong>늦은 참가자 처리</strong>: 세션에 나중에 참가한 유저도 현재 Light/PostProcess 상태를 수신받아 동기화된 상태로 시작</li>
<li><strong>Local 상태 on/off?</strong>: 월드 내 유저들과 동기화되지 않고, 혼자 Local로 전환하여 쓸 수 있는 상태를 만들 것인가? 고민</li>
</ul>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>AssetBundle이 Streamed Scene이 아닌 경우</td><td>업로드 시 검증 실패, 오류 안내</td></tr>
<tr><td>VIRDYWorldDescriptor가 누락된 월드</td><td>기본값으로 동작 (스폰 포인트 = 원점)</td></tr>
<tr><td>월드 다운로드 중 네트워크 끊김</td><td>타임아웃 후 오류 표시, 로비 복귀</td></tr>
<tr><td>캐시된 월드의 버전이 서버와 불일치</td><td>서버 버전 다운로드 후 캐시 갱신</td></tr>
<tr><td>월드 언로드 시 메모리 누수</td><td>Unload(true)로 강제 해제, 이후 GC 호출</td></tr>
<tr><td>삭제된 월드에 접속 시도</td><td>"월드를 찾을 수 없습니다" 오류, 로비 복귀</td></tr>
<tr><td>공유 권한이 취소된 월드 접근</td><td>Firestore 보안 규칙으로 차단, 목록에서 자동 제거</td></tr>
<tr><td>동일 월드 중복 업로드</td><td>기존 월드 업데이트로 처리 (version 증가)</td></tr>
<tr><td>월드 내 EventSystem/Camera 존재</td><td>자동 비활성화 처리</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>Steam Workshop 연동</strong></td><td>Steam Workshop을 통한 월드 배포</td><td>중간</td></tr>
<tr><td><strong>월드 태그/카테고리</strong></td><td>월드 검색을 위한 태그 시스템</td><td>중간</td></tr>
<tr><td><strong>월드 버전 관리</strong></td><td>이전 버전 롤백 기능</td><td>낮음</td></tr>
<tr><td><strong>월드 마켓플레이스</strong></td><td>커뮤니티 월드 공유/판매 플랫폼</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>카메라 시스템</li>
<li>네트워크 시스템</li>
<li>SDK</li>
<li>사용자 플로우</li>
<li>기술 아키텍처</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_05_Network_System">
            <div class="section-header">
                <h2>⚙️ 네트워크 시스템</h2>
            </div>
            <h1>네트워크 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>네트워크 시스템은 Photon Fusion Shared Mode를 기반으로 VIRDY의 실시간 멀티유저 협업을 지원한다. 플랜에 따라 세션당 최대 Actor 수가 제한되며, 아바타, 카메라, 채팅을 실시간으로 동기화한다. 데이터 압축과 보간 기술로 네트워크 대역폭을 최적화한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 네트워크 구성요소</h3>
<table>
<thead><tr><th>구성요소</th><th>역할</th></tr></thead>
<tbody>
<tr><td><strong>FusionService</strong></td><td>세션 수명주기 관리 (생성, 참가, 종료)</td></tr>
<tr><td><strong>FusionLobby</strong></td><td>로비 연결 및 세션 검색</td></tr>
<tr><td><strong>NetworkGame</strong></td><td>세션 루트 오브젝트 (플레이어, 채널, 액터 관리)</td></tr>
<tr><td><strong>NetworkPlayer</strong></td><td>플레이어별 인증 정보 및 위치 동기화</td></tr>
<tr><td><strong>NetworkActor</strong></td><td>아바타 본/표정/손가락 동기화</td></tr>
<tr><td><strong>NetworkChannel</strong></td><td>카메라 위치/설정/Channel Link 동기화</td></tr>
<tr><td><strong>ChatService</strong></td><td>Photon Chat 기반 텍스트 채팅 및 초대 시스템</td></tr>
</tbody></table>
<h3>2.2 기본 설정</h3>
<table>
<thead><tr><th>항목</th><th>값</th><th>비고</th></tr></thead>
<tbody>
<tr><td>게임 모드</td><td>Photon Fusion Shared Mode</td><td>-</td></tr>
<tr><td>최대 플레이어 (기술적 한계)</td><td>n명 (검토 중)</td><td>Photon 설정</td></tr>
<tr><td>세션 최대 Actor (비즈니스 제한)</td><td>플랜별 상이</td><td>호스트 플랜 기준 (Pro 3, Studio 6, Enterprise 10+)</td></tr>
<tr><td>로비 유형</td><td>Custom</td><td>-</td></tr>
<tr><td>로비 이름</td><td>VIRDY.{버전}</td><td>-</td></tr>
<tr><td>세션 코드</td><td>4자리 영숫자 (예: A1B2)</td><td>-</td></tr>
</tbody></table>
<blockquote><strong>플레이어 vs Actor</strong>: 플레이어는 접속한 사용자 수이고, Actor는 세션 내 아바타 수이다. 1명의 플레이어가 여러 Actor를 운용할 수 있으므로, 세션 수용량은 <strong>Actor 수</strong>로 제한한다. 상세 내용은 라이선스 체계 참조.</blockquote>
<h3>2.3 세션 생성 및 참가</h3>
<h4>세션 생성</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>사용자가 월드를 선택하고 "세션 생성" 클릭 (Free 플랜 제외)</td></tr>
<tr><td>2</td><td>4자리 랜덤 세션 코드 생성</td></tr>
<tr><td>3</td><td>세션 속성에 worldId 포함</td></tr>
<tr><td>4</td><td>Photon 세션 생성 → 월드 로딩 → 접속 완료</td></tr>
</tbody></table>
<h4>세션 참가</h4>
<table>
<thead><tr><th>방법</th><th>설명</th></tr></thead>
<tbody>
<tr><td>세션 코드 입력</td><td>4자리 코드를 입력하여 세션에 참가</td></tr>
<tr><td>친구 초대 수락</td><td>Chat으로 받은 초대를 수락하여 참가</td></tr>
<tr><td>따라가기</td><td>친구가 있는 세션에 참가 요청</td></tr>
</tbody></table>
<h3>2.4 세션 연결 플로우</h3>
<h4>연결 과정</h4>
<table>
<thead><tr><th>단계</th><th>동작</th><th>상태 표시</th></tr></thead>
<tbody>
<tr><td>1</td><td>로비 Runner 종료</td><td>"초기화 중..."</td></tr>
<tr><td>2</td><td>Firebase Storage에서 월드 다운로드</td><td>"월드 데이터 다운로드 중... (XX%)"</td></tr>
<tr><td>3</td><td>AssetBundle 로드</td><td>"씬 로딩 중..."</td></tr>
<tr><td>4</td><td>NetworkRunner 생성 및 세션 참가</td><td>"세션 접속 중..."</td></tr>
<tr><td>5</td><td>연결 대기 (30초 타임아웃)</td><td>-</td></tr>
<tr><td>6</td><td>Photon Chat 채널 구독</td><td>-</td></tr>
<tr><td>7</td><td>WorldScene 로드 대기</td><td>-</td></tr>
<tr><td>8</td><td>NetworkGame 초기화 완료</td><td>로딩 해제</td></tr>
</tbody></table>
<h4>연결 해제 과정</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>채팅 구독 해제</td></tr>
<tr><td>2</td><td>NetworkRunner 종료</td></tr>
<tr><td>3</td><td>월드 언로드 (AssetBundle 메모리 해제)</td></tr>
<tr><td>4</td><td>로비 복귀</td></tr>
</tbody></table>
<h3>2.5 네트워크 오브젝트 계층</h3>
<p>세션에 접속하면 아래 오브젝트가 플레이어별로 생성된다.</p>
<table>
<thead><tr><th>오브젝트</th><th>수량</th><th>설명</th></tr></thead>
<tbody>
<tr><td>NetworkGame</td><td>1개 (세션당)</td><td>모든 플레이어/채널/액터를 관리하는 루트</td></tr>
<tr><td>NetworkPlayer</td><td>1개 (플레이어당)</td><td>사용자 정보, 아바타 위치</td></tr>
<tr><td>NetworkChannel</td><td>1개 (플레이어당)</td><td>10개 카메라 + Channel Link</td></tr>
<tr><td>NetworkActor</td><td>플랜별 상이 (플레이어당)</td><td>아바타별 본/표정/손가락. 개인 Actor 수는 플랜에 따라 1~6개+</td></tr>
</tbody></table>
<h3>2.6 아바타 동기화 데이터</h3>
<table>
<thead><tr><th>데이터</th><th>수량</th><th>설명</th></tr></thead>
<tbody>
<tr><td>본 회전</td><td>22개</td><td>Hips ~ Toes (Quaternion)</td></tr>
<tr><td>손가락 포즈</td><td>40개</td><td>양손 각 20개 (muscle 값)</td></tr>
<tr><td>표정(BlendShape)</td><td>100개</td><td>ARKit 52종 + 확장</td></tr>
<tr><td>위치</td><td>3개</td><td>Hip 위치 + 손 오프셋</td></tr>
</tbody></table>
<h4>동기화 본 목록 (22개)</h4>
<table>
<thead><tr><th>부위</th><th>본</th></tr></thead>
<tbody>
<tr><td>몸통</td><td>Hips, Spine, Chest, UpperChest, Neck, Head</td></tr>
<tr><td>왼팔</td><td>LeftShoulder, LeftUpperArm, LeftLowerArm, LeftHand</td></tr>
<tr><td>오른팔</td><td>RightShoulder, RightUpperArm, RightLowerArm, RightHand</td></tr>
<tr><td>왼다리</td><td>LeftUpperLeg, LeftLowerLeg, LeftFoot, LeftToes</td></tr>
<tr><td>오른다리</td><td>RightUpperLeg, RightLowerLeg, RightFoot, RightToes</td></tr>
</tbody></table>
<h3>2.7 FPS 모드 동기화</h3>
<p>아바타를 월드 내에서 WASD로 이동할 때의 동기화 데이터:</p>
<table>
<thead><tr><th>데이터</th><th>설명</th></tr></thead>
<tbody>
<tr><td>IsFPSMode</td><td>FPS 모드 활성화 여부</td></tr>
<tr><td>FPSPosition</td><td>FPS 위치</td></tr>
<tr><td>FPSRotation</td><td>FPS 회전</td></tr>
<tr><td>FPSSpeed</td><td>이동 속도</td></tr>
<tr><td>FPSAnimationState</td><td>애니메이션 상태 (Idle/Walk/Jump/Run)</td></tr>
</tbody></table>
<h3>2.8 Props 동기화</h3>
<p>Vicon 등 전문 장비에서 소품(Props) 트래킹 시 동기화:</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>최대 수량</td><td>20개</td></tr>
<tr><td>동기화 데이터</td><td>이름, 위치, 회전</td></tr>
</tbody></table>
<h3>2.9 Sync 모드 (동기화 품질)</h3>
<p>네트워크 동기화 품질은 <strong>Live</strong>와 <strong>Ultra</strong> 두 가지 모드로 구분되며, 구독 플랜에 따라 제공 범위가 달라진다.</p>
<table>
<thead><tr><th>모드</th><th>대상 플랜</th><th>특징</th><th>용도</th></tr></thead>
<tbody>
<tr><td><strong>Live Sync</strong></td><td>모든 플랜</td><td>경량 모션 데이터, 비용 효율적</td><td>일반 방송, 개인 사용</td></tr>
<tr><td><strong>Ultra Sync</strong></td><td>Enterprise 전용</td><td>고품질 모션 데이터, 높은 대역폭</td><td>공연, 특수 연출, 전문 프로덕션</td></tr>
</tbody></table>
<h4>Live Sync</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>대상</td><td>모든 구독 플랜 (무료 포함)</td></tr>
<tr><td>데이터 전송량</td><td>경량화된 모션 데이터</td></tr>
<tr><td>비용 효율</td><td>높음</td></tr>
<tr><td>품질</td><td>일반 사용에 충분한 수준</td></tr>
</tbody></table>
<h4>Ultra Sync</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>대상</td><td>Enterprise 플랜 전용</td></tr>
<tr><td>데이터 전송량</td><td>고용량 모션 데이터</td></tr>
<tr><td>비용 효율</td><td>낮음 (대역폭 비용 높음)</td></tr>
<tr><td>품질</td><td>전문 프로덕션 수준</td></tr>
<tr><td>조건</td><td>네트워크 품질 기준 충족 필요</td></tr>
</tbody></table>
<h4>Sync 모드 설계 원칙</h4>
<ul>
<li>Sync 품질은 기술 옵션이 아닌 <strong>비용 및 계약 개념</strong>으로 관리</li>
<li>현재 사용 중인 고용량 모션 데이터는 일반 사용에 부적합</li>
<li>Live Sync 전용으로 최적화된 경량 모션 데이터 개발 필요</li>
<li>Ultra Sync 네트워크 조건 미달 시 Live로 자동 전환</li>
</ul>
<blockquote>Sync 모드별 구독 플랜은 라이선스 체계 참조</blockquote>
<h3>2.10 데이터 압축</h3>
<p>네트워크 대역폭 절감을 위해 다양한 압축 기법을 적용한다.</p>
<table>
<thead><tr><th>데이터 유형</th><th>원본 크기</th><th>압축 후</th><th>절감률</th></tr></thead>
<tbody>
<tr><td>Quaternion (본 회전)</td><td>16 bytes</td><td>8 bytes (short×4)</td><td>50%</td></tr>
<tr><td>BlendShape (표정)</td><td>4 bytes</td><td>1 byte (sbyte)</td><td>75%</td></tr>
<tr><td>Position (위치)</td><td>Accuracy(0.1f) 양자화</td><td>가변</td><td>가변</td></tr>
</tbody></table>
<p>추가 최적화:</p>
<ul>
<li>변경 감지: 유의미한 변경이 있는 데이터만 전송</li>
<li>분산 액터 업데이트: 프레임당 최대 3명의 액터만 서버에 업데이트 (라운드 로빈)</li>
</ul>
<h3>2.11 보간 시스템</h3>
<p>원격 플레이어의 움직임을 부드럽게 표시하기 위한 보간 처리:</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>히스토리 버퍼</td><td>2프레임 히스토리</td></tr>
<tr><td>본 회전</td><td>Quaternion Slerp 보간</td></tr>
<tr><td>위치</td><td>선형 보간</td></tr>
<tr><td>업데이트 주기</td><td>StateAuthority: FixedUpdate / Proxy: Render</td></tr>
</tbody></table>
<h3>2.12 채팅 시스템</h3>
<p>Photon Chat을 활용한 텍스트 채팅 및 소셜 기능:</p>
<h4>채팅 기능</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td>전체 채팅</td><td>세션 내 모든 사용자에게 메시지 전송</td></tr>
<tr><td>팀 채팅</td><td>팀원에게만 메시지 전송</td></tr>
</tbody></table>
<h4>소셜 명령</h4>
<table>
<thead><tr><th>명령</th><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td>/invite</td><td>초대</td><td>친구에게 현재 세션 참가 요청</td></tr>
<tr><td>/follow</td><td>따라가기</td><td>친구가 있는 세션에 참가 요청</td></tr>
<tr><td>/bring</td><td>데려오기</td><td>친구를 내 세션으로 이동</td></tr>
</tbody></table>
<h4>재연결 전략</h4>
<table>
<thead><tr><th>시도</th><th>대기 시간</th></tr></thead>
<tbody>
<tr><td>1~6회</td><td>5초</td></tr>
<tr><td>7회 이상</td><td>60초</td></tr>
<tr><td>최대 시도 초과</td><td>연결 실패 알림</td></tr>
</tbody></table>
<h3>2.13 RPC 사용 패턴</h3>
<p>주요 데이터 동기화에 사용되는 RPC 패턴:</p>
<table>
<thead><tr><th>용도</th><th>방향</th><th>채널</th></tr></thead>
<tbody>
<tr><td>플레이어 초기화</td><td>StateAuthority → All</td><td>Reliable</td></tr>
<tr><td>채팅 메시지</td><td>All → All</td><td>Reliable</td></tr>
<tr><td>라이팅 동기화</td><td>StateAuthority → Proxies</td><td>Reliable</td></tr>
<tr><td>Channel Link 요청</td><td>All → StateAuthority</td><td>Reliable</td></tr>
<tr><td>스폰포인트 제어</td><td>All → StateAuthority</td><td>Reliable</td></tr>
</tbody></table>
<h3>2.14 Light / PostProcess 네트워크 동기화</h3>
<p>세션 내 Directional Light와 PostProcess 파라미터는 모든 유저에게 공유되는 세션 전역 상태이다. 어떤 유저든 Slider UI를 통해 값을 변경하면 RPC로 전체 세션에 전파된다.</p>
<h4>동기화 대상</h4>
<table>
<thead><tr><th>기능</th><th>파라미터</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>Directional Light</strong></td><td>Intensity</td><td>광원 강도 (0~10)</td></tr>
<tr><td><strong>Directional Light</strong></td><td>Rotation X</td><td>수직 회전 / 태양 고도 (0°~360°)</td></tr>
<tr><td><strong>Directional Light</strong></td><td>Rotation Y</td><td>수평 회전 / 태양 방위 (0°~360°)</td></tr>
<tr><td><strong>Bloom</strong></td><td>Threshold, Intensity, Scatter, Enable</td><td>블룸 효과 파라미터</td></tr>
<tr><td><strong>Color Adjustments</strong></td><td>Post Exposure, Contrast, Saturation, Enable</td><td>색감 보정 파라미터</td></tr>
</tbody></table>
<h4>동기화 플로우</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>유저가 Slider UI로 Light 또는 PostProcess 파라미터를 변경</td></tr>
<tr><td>2</td><td>로컬에 즉시 적용 (조작자 화면에 바로 반영)</td></tr>
<tr><td>3</td><td>StateAuthority → 모든 Proxy로 Reliable RPC 전송</td></tr>
<tr><td>4</td><td>수신한 모든 유저의 화면에 동일한 값 적용</td></tr>
</tbody></table>
<h4>동기화 특성</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>방향</td><td>StateAuthority → Proxies</td></tr>
<tr><td>채널</td><td>Reliable</td></tr>
<tr><td>제어 권한</td><td>세션 내 모든 유저가 조작 가능</td></tr>
<tr><td>충돌 정책</td><td>Last-Write-Wins (마지막 RPC가 최종값)</td></tr>
<tr><td>후속 참가자</td><td>세션 참가 시 현재 상태값을 수신하여 동기화 상태로 시작</td></tr>
</tbody></table>
<h3>2.15 스폰포인트 네트워크 제어</h3>
<p>월드의 스폰포인트 위치를 네트워크를 통해 제어할 수 있다.</p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>위치/회전</td><td>네트워크로 동기화</td></tr>
<tr><td>제어권</td><td>한 번에 1명만 스폰포인트 제어 가능</td></tr>
<tr><td>요청 방식</td><td>RPC로 StateAuthority에 제어권 요청</td></tr>
</tbody></table>
<h3>2.16 세션 관리 전환 검토 (서버 개발자 회의 기반)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시, 세션 생성/종료가 Backend를 경유하고 Photon Webhook으로 상태를 동기화하는 구조로 변경된다.</p>
<h4>전환 후 세션 생성 흐름 (검토 중)</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Client(A)가 Backend에 세션 생성 요청</td></tr>
<tr><td>2</td><td>Backend에서 세션 정보 생성 + 8자리 joinCode 발급</td></tr>
<tr><td>3</td><td>Client(A)가 Photon Room 생성</td></tr>
<tr><td>4</td><td>Photon → Backend Webhook: Room Created → photonRoomId 매핑 저장</td></tr>
<tr><td>5</td><td>다른 Client(B, C)가 joinCode로 참가</td></tr>
<tr><td>6</td><td>Photon → Backend Webhook: Player Joined → currentParticipants 증가</td></tr>
</tbody></table>
<h4>전환 후 세션 종료 흐름 (검토 중)</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Host가 Backend에 세션 종료 요청</td></tr>
<tr><td>2</td><td>Backend → Photon Server API: Close Room 명령</td></tr>
<tr><td>3</td><td>Photon → Backend Webhook: Room Closed</td></tr>
<tr><td>4</td><td>Backend에서 세션 상태 CLOSED 업데이트, closedAt 기록</td></tr>
</tbody></table>
<h4>Photon Webhook 이벤트 (검토 중)</h4>
<table>
<thead><tr><th>이벤트</th><th>발생 시점</th><th>Backend 처리</th></tr></thead>
<tbody>
<tr><td>PathCreate</td><td>Room 생성 시</td><td>photonRoomId 저장, 세션 상태 ACTIVE</td></tr>
<tr><td>PathJoin</td><td>플레이어 입장 시</td><td>currentParticipants 증가, 참가자 기록</td></tr>
<tr><td>PathLeave</td><td>플레이어 퇴장 시</td><td>currentParticipants 감소</td></tr>
<tr><td>PathClose</td><td>Room 종료 시</td><td>세션 상태 CLOSED, closedAt 기록</td></tr>
</tbody></table>
<h4>세션 데이터 모델 (검토 중)</h4>
<p>Backend에서 관리하는 세션 데이터 구조:</p>
<table>
<thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead>
<tbody>
<tr><td>id</td><td>Long</td><td>세션 고유 ID</td></tr>
<tr><td>tenantId</td><td>Long</td><td>소속 테넌트</td></tr>
<tr><td>worldId</td><td>Long</td><td>사용 중인 월드</td></tr>
<tr><td>joinCode</td><td>String (8자리)</td><td>참가 코드 (고유)</td></tr>
<tr><td>photonRoomId</td><td>String</td><td>Photon에서 부여한 Room ID</td></tr>
<tr><td>status</td><td>Enum</td><td>WAITING / ACTIVE / CLOSED</td></tr>
<tr><td>maxParticipants</td><td>Integer</td><td>최대 인원 (플랜에 따라)</td></tr>
<tr><td>currentParticipants</td><td>Integer</td><td>현재 인원</td></tr>
<tr><td>hostUserId</td><td>Long</td><td>방장</td></tr>
</tbody></table>
<h4>Photon Custom Authentication (검토 중)</h4>
<p>Photon 접속 시 Backend를 통한 인증을 필수로 설정하여, AppID 탈취로 인한 무단 사용을 방지한다. 클라이언트는 Photon 연결 시 JWT를 전달하고, Photon은 Backend에 인증을 위임한다.</p>
<h4>미확정 사항</h4>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>호스트 이탈 시 처리</td><td>📋 논의 필요</td><td>호스트 마이그레이션 vs 세션 종료</td></tr>
<tr><td>비정상 종료 감지</td><td>📋 논의 필요</td><td>Heartbeat + Timeout으로 좀비 세션 정리</td></tr>
<tr><td>joinCode 길이</td><td>📋 미확정</td><td>현행 4자리 → 8자리로 변경 검토</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 Shared Mode 특성</h3>
<p>Photon Fusion Shared Mode를 사용하므로:</p>
<ul>
<li>각 플레이어가 자신의 오브젝트에 대한 StateAuthority를 가짐</li>
<li>서버가 아닌 클라이언트가 자신의 데이터를 직접 업데이트</li>
<li>호스트 없이 모든 클라이언트가 동등한 권한</li>
</ul>
<h3>3.2 대역폭 관리</h3>
<p>다수의 Actor가 동시 접속 시 데이터 양이 급증하므로:</p>
<ul>
<li>프레임당 최대 3명의 액터만 서버 업데이트 (분산 처리)</li>
<li>Quaternion 50% 압축 + BlendShape 75% 압축</li>
<li>유의미한 변경만 전송 (변경 감지)</li>
<li>위치 데이터 양자화</li>
</ul>
<h3>3.3 버전 호환성</h3>
<p>로비 이름에 버전을 포함 (VIRDY.{버전})하여 서로 다른 버전의 클라이언트가 같은 세션에 접속하는 것을 방지한다.</p>
<h3>3.4 세션 속성</h3>
<p>세션에 worldId를 포함시켜 참가자가 올바른 월드를 다운로드하도록 보장한다.</p>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>세션 코드 오류 (존재하지 않는 코드)</td><td>"세션을 찾을 수 없습니다" 오류 표시</td></tr>
<tr><td>연결 대기 타임아웃 (30초)</td><td>자동 연결 해제, 오류 알림, 로비 복귀</td></tr>
<tr><td>월드 다운로드 실패</td><td>연결 해제, 오류 알림</td></tr>
<tr><td>예기치 않은 연결 끊김</td><td>자동 연결 해제, 로비 복귀</td></tr>
<tr><td>Chat 연결 끊김</td><td>지수 백오프 자동 재연결 (5초 → 60초)</td></tr>
<tr><td>Chat 재연결 최대 시도 초과</td><td>연결 실패 알림 표시</td></tr>
<tr><td>이중 Channel Link 시도</td><td>"이중 공유는 불가능합니다" 경고</td></tr>
<tr><td>스폰포인트 제어 충돌</td><td>이미 다른 사용자가 제어 중이면 요청 거부</td></tr>
<tr><td>세션 최대 Actor 초과</td><td>참가 거부, 안내 메시지 (호스트 플랜 기준)</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>음성 채팅</strong></td><td>세션 내 실시간 음성 통화</td><td>중간</td></tr>
<tr><td><strong>세션 녹화/재생</strong></td><td>모션 데이터 녹화 및 재생</td><td>중간</td></tr>
<tr><td><strong>로컬 모드</strong></td><td>네트워크 없이 단독 사용</td><td>중간</td></tr>
<tr><td><strong>서버 리전 선택</strong></td><td>사용자가 가까운 서버 선택</td><td>낮음</td></tr>
<tr><td><strong>관전 모드</strong></td><td>참가하지 않고 세션 관전</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>월드 시스템</li>
<li>카메라 시스템</li>
<li>사용자 플로우</li>
<li>기술 아키텍처</li>
<li>라이선스 체계</li>
<li>리스크 관리</li>
<li>보안 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-02_Features_06_SDK">
            <div class="section-header">
                <h2>⚙️ SDK</h2>
            </div>
            <h1>SDK</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY SDK는 월드 및 아바타 크리에이터가 커스텀 인터랙티브 콘텐츠를 제작할 수 있도록 제공하는 Unity 패키지이다. SDK를 사용하면 3D 월드를 AssetBundle로 빌드하고, 네트워크 동기화가 가능한 인터랙티브 오브젝트를 추가하며, 자체 확장자 아바타를 빌드할 수 있다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 SDK 패키지 정보</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td>패키지 이름</td><td>com.parable.virdy-sdk</td></tr>
<tr><td>표시 이름</td><td>VIRDY SDK</td></tr>
<tr><td>지원 Unity</td><td>2022.3 LTS</td></tr>
<tr><td>의존성</td><td>Cinemachine 2.9.7</td></tr>
<tr><td>배포 상태</td><td>🚧 개발 중 (외부 배포 예정)</td></tr>
</tbody></table>
<h3>2.2 SDK 구성</h3>
<table>
<thead><tr><th>폴더</th><th>내용</th></tr></thead>
<tbody>
<tr><td>Editor/</td><td>에디터 전용 도구 (빌드, 인스펙터)</td></tr>
<tr><td>Runtime/</td><td>핵심 SDK 컴포넌트</td></tr>
<tr><td>Runtime/ShaderController/</td><td>셰이더 및 비주얼 제어 컴포넌트</td></tr>
<tr><td>Runtime/EX/</td><td>확장 기능 (PostIt 등)</td></tr>
<tr><td>Plugins/uWindowCapture/</td><td>윈도우 캡처 통합</td></tr>
<tr><td>Samples/</td><td>예제 씬 및 프리팹</td></tr>
<tr><td>Resources/Settings/</td><td>기본 설정</td></tr>
</tbody></table>
<h3>2.3 베이스 클래스</h3>
<p>SDK의 모든 인터랙티브 컴포넌트는 아래 2개 베이스 클래스 중 하나를 상속한다.</p>
<h4>VIRDYBehaviour (비네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>용도</td><td>네트워크 동기화가 필요 없는 인터랙티브 컴포넌트</td></tr>
<tr><td>생명주기</td><td>Initialize (월드 로드 시) → DeInitialize (월드 언로드 시)</td></tr>
<tr><td>기능</td><td>Transform 위치/회전 원본 저장 및 복원</td></tr>
<tr><td>사용 예시</td><td>애니메이션, UI, 조명 효과, 시각 전용 오브젝트</td></tr>
</tbody></table>
<h4>VIRDYNetworkBehaviour (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>용도</td><td>네트워크 동기화가 필요한 인터랙티브 컴포넌트</td></tr>
<tr><td>상속</td><td>Photon Fusion의 NetworkBehaviour</td></tr>
<tr><td>생명주기</td><td>Initialize → DeInitialize (VIRDYBehaviour와 동일)</td></tr>
<tr><td>필수 요구</td><td>NetworkObject 컴포넌트 필요</td></tr>
<tr><td>기능</td><td>Networked 속성, RPC 메서드 사용 가능</td></tr>
<tr><td>사용 예시</td><td>문, 스위치, 동기화 오브젝트, 공유 UI</td></tr>
</tbody></table>
<h3>2.4 VIRDYWorldDescriptor</h3>
<p>월드 씬에 필수적인 싱글톤 컴포넌트로, 월드 설정과 초기화를 관리한다.</p>
<table>
<thead><tr><th>설정</th><th>설명</th></tr></thead>
<tbody>
<tr><td>SpawnPoint</td><td>아바타 스폰 위치</td></tr>
<tr><td>RendererData</td><td>URP 렌더러 설정 (오버라이드 가능)</td></tr>
<tr><td>GlobalVolume</td><td>포스트 프로세싱 볼륨</td></tr>
<tr><td>CustomDirectionalLight</td><td>방향광 설정</td></tr>
<tr><td>UnityVersion / URPVersion</td><td>빌드 환경 버전 정보</td></tr>
</tbody></table>
<p>초기화 시 씬 내 모든 VIRDYBehaviour 및 VIRDYNetworkBehaviour를 탐색하여 Initialize를 호출한다.</p>
<p>에디터 생성: Hierarchy 우클릭 → GameObject/VIRDY/VIRDYWorldDescriptor</p>
<h3>2.5 인터랙티브 컴포넌트</h3>
<h4>VIRDYObjectActivator</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>이름으로 오브젝트 그룹 활성화/비활성화</td></tr>
<tr><td>네트워크</td><td>불필요</td></tr>
<tr><td>사용 예시</td><td>버튼으로 조명/파티클 그룹 토글</td></tr>
</tbody></table>
<h4>VIRDYGlobalFunction (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>키 기반 함수를 모든 플레이어에게 브로드캐스트</td></tr>
<tr><td>네트워크</td><td>필요 (RPC)</td></tr>
<tr><td>지원 인자</td><td>없음 / int / string</td></tr>
<tr><td>사용 예시</td><td>특수 효과 활성화, 애니메이션 트리거, 이벤트 전파</td></tr>
</tbody></table>
<h4>VIRDYMultiObjectControl</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>오브젝트 배열을 순차적으로 활성화/비활성화</td></tr>
<tr><td>네트워크</td><td>불필요</td></tr>
<tr><td>사용 예시</td><td>갤러리 이전/다음, 캐러셀 디스플레이</td></tr>
</tbody></table>
<h4>VIRDYVideoPlayer</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>비디오 클립 재생, 페이드 전환, RenderTexture 출력</td></tr>
<tr><td>네트워크</td><td>불필요</td></tr>
<tr><td>구성</td><td>VideoClip + RenderTexture + FadeUI 1:1 매핑</td></tr>
</tbody></table>
<h4>VIRDYRoulette (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>이징 커브 기반 회전 룰렛</td></tr>
<tr><td>네트워크</td><td>필요 (동기화된 랜덤 결과)</td></tr>
<tr><td>사용 예시</td><td>복권, 스핀 게임, 랜덤 결과 표시</td></tr>
</tbody></table>
<h4>VIRDYInputFieldSync (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>텍스트 입력을 여러 UI에 네트워크 브로드캐스트</td></tr>
<tr><td>네트워크</td><td>필요</td></tr>
<tr><td>사용 예시</td><td>자막 디스플레이, 공유 채팅</td></tr>
</tbody></table>
<h3>2.6 조명 제어 컴포넌트</h3>
<h4>VIRDYLightController</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>포인트 라이트 프리셋 전환, 파티클 효과 토글</td></tr>
<tr><td>라이트 수</td><td>최대 3개 포인트 라이트</td></tr>
<tr><td>프리셋</td><td>색상(3개), 강도, 범위 조합</td></tr>
<tr><td>전환</td><td>부드러운 색상 전환 (Lerp)</td></tr>
</tbody></table>
<h4>VIRDYMirrorBall</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>HSV 색상 순환 + 회전 + 밝기 제어</td></tr>
<tr><td>제어</td><td>MusicStart / MusicStop (페이드아웃)</td></tr>
</tbody></table>
<h3>2.7 셰이더 및 VFX 컴포넌트</h3>
<h4>VIRDYMaterialController (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>머티리얼 셰이더 속성을 네트워크로 동기화</td></tr>
<tr><td>입력</td><td>UI 슬라이더(VIRDYMaterialSlider) 또는 직접 float 값</td></tr>
<tr><td>사용 예시</td><td>조명 색상/강도 제어, 투명도, 셰이더 파라미터</td></tr>
</tbody></table>
<h4>VIRDYVFXController (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>Visual Effect Graph 파라미터를 네트워크로 제어</td></tr>
<tr><td>지원 속성</td><td>Float, Slider(0~1), Vector2, Gradient(색상 프리셋)</td></tr>
</tbody></table>
<h4>EmissionController</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>이름 매칭으로 머티리얼 발광 강도 제어</td></tr>
<tr><td>사용 예시</td><td>캐릭터 머티리얼 발광, 네온 효과</td></tr>
</tbody></table>
<h3>2.8 UI 컴포넌트</h3>
<h4>VIRDYWorldUI</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>World Space Canvas를 VIRDY 이벤트 카메라에 자동 연결</td></tr>
<tr><td>설정</td><td>컴포넌트 추가만으로 자동 설정</td></tr>
<tr><td>카메라 전환</td><td>카메라 변경 시 자동 업데이트</td></tr>
</tbody></table>
<h4>VIRDYScreenUI</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>Screen Space Camera Canvas 자동 설정</td></tr>
<tr><td>설정</td><td>렌더 모드, 레이어, Z-오더 자동 관리</td></tr>
</tbody></table>
<h4>VIRDYFadeUI</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>UI 페이드 인/아웃 + 선택적 위치 이동</td></tr>
<tr><td>애니메이션</td><td>DOTween 기반 (조건부 컴파일: VIRDY_DOTWEEN)</td></tr>
<tr><td>설정</td><td>Duration, Ease In/Out, 위치 시작/끝</td></tr>
</tbody></table>
<h4>VIRDYCinemachineTrack</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>Timeline 재생을 활성 카메라 Brain에 자동 바인딩</td></tr>
<tr><td>사용 예시</td><td>플레이어 카메라 변경에 적응하는 시네마틱 시퀀스</td></tr>
</tbody></table>
<h3>2.9 확장 컴포넌트</h3>
<h4>BlendShapeManager</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>VRM 아바타 BlendShape + 연계 GameObject 제어</td></tr>
<tr><td>설정</td><td>대상 인덱스, VRM 메타 타이틀, BlendShape 경로/이름</td></tr>
<tr><td>사용 예시</td><td>아바타 커스텀 표정, 바디 모프</td></tr>
</tbody></table>
<h4>VIRDYPostItController</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>물리 기반 포스트잇 부착/분리 시스템</td></tr>
<tr><td>구성</td><td>PostItStickyController (개별) + VIRDYPaperAero (종이비행기)</td></tr>
<tr><td>연동</td><td>NetworkActor.WriteBuffer에서 틱 호출</td></tr>
</tbody></table>
<h4>VIRDYVelocity (네트워크)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>네트워크 동기화 물리 힘 (선형 속도 + 토크)</td></tr>
<tr><td>필수</td><td>NetworkObject + NetworkRigidbody + Rigidbody</td></tr>
<tr><td>사용 예시</td><td>물리 오브젝트, 공, 인터랙티브 소품</td></tr>
</tbody></table>
<h4>VIRDYTimer</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>경과 시간 또는 현재 시간 표시</td></tr>
<tr><td>출력</td><td>시/분/초/밀리초 별도 TextMeshPro</td></tr>
<tr><td>제어</td><td>Start / Stop / Reset / GetCurrentTime</td></tr>
</tbody></table>
<h4>OSCReceiver</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>기능</td><td>외부 OSC 메시지를 VIRDYGlobalFunction으로 라우팅</td></tr>
<tr><td>연동</td><td>VSeeFace, Resolume 등 OSC 앱</td></tr>
<tr><td>지원</td><td>인자 없음, int, string 메시지</td></tr>
</tbody></table>
<h3>2.10 에디터 도구</h3>
<h4>VIRDYWorldDescriptorEditor</h4>
<table>
<thead><tr><th>기능</th><th>설명</th></tr></thead>
<tbody>
<tr><td>렌더러 상태 표시</td><td>URP 기능 목록 (SSAO, HBAO, Volumetric 등)</td></tr>
<tr><td>월드 빌더</td><td>출력 경로 설정 + 원클릭 AssetBundle 빌드</td></tr>
<tr><td>빌드 방식</td><td>ChunkBasedCompression, 매니페스트 정리</td></tr>
</tbody></table>
<h4>컴포넌트별 에디터</h4>
<table>
<thead><tr><th>에디터</th><th>기능</th></tr></thead>
<tbody>
<tr><td>VIRDYFadeUIEditor</td><td>에디터에서 페이드 애니메이션 테스트</td></tr>
<tr><td>VIRDYVideoPlayerEditor</td><td>비디오 클립 재생 테스트</td></tr>
<tr><td>VIRDYLightTransitionEditor</td><td>라이트 프리셋 전환 테스트</td></tr>
</tbody></table>
<h3>2.11 샘플 프리팹</h3>
<table>
<thead><tr><th>프리팹</th><th>설명</th></tr></thead>
<tbody>
<tr><td>VIRDYWorld.prefab</td><td>Descriptor 사전 설정된 템플릿 월드</td></tr>
<tr><td>VIRDYMaterialController.prefab</td><td>셰이더 제어 설정 예제</td></tr>
<tr><td>VIRDYUwc.prefab</td><td>윈도우 캡처 통합 예제</td></tr>
<tr><td>uWC Window List Item.prefab</td><td>윈도우 선택 UI</td></tr>
</tbody></table>
<h3>2.12 조건부 컴파일 심볼</h3>
<table>
<thead><tr><th>심볼</th><th>설명</th></tr></thead>
<tbody>
<tr><td>VIRDY_CORE</td><td>프레임워크 빌드 (Context 접근 가능)</td></tr>
<tr><td>VIRDY_DOTWEEN</td><td>DOTween 애니메이션 활성화</td></tr>
<tr><td>VIRDY_HORIZONBASEDAMBIENTOCCLUSION</td><td>HBAO 렌더러</td></tr>
<tr><td>VIRDY_OCCASOFTWARE_ALTOS</td><td>Altos 렌더러</td></tr>
<tr><td>VIRDY_VOLUMETRICLIGHTS</td><td>볼류메트릭 라이트</td></tr>
<tr><td>VIRDY_VOLUMETRICFOGANDMIST2</td><td>볼류메트릭 포그</td></tr>
</tbody></table>
<h3>2.13 월드 빌드 워크플로우</h3>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Unity 씬 생성, VIRDYWorldDescriptor 추가</td></tr>
<tr><td>2</td><td>스폰 포인트, Directional Light, GlobalVolume 설정</td></tr>
<tr><td>3</td><td>인터랙티브 컴포넌트 추가 (VIRDYBehaviour/VIRDYNetworkBehaviour 상속)</td></tr>
<tr><td>4</td><td>에디터에서 테스트</td></tr>
<tr><td>5</td><td>VIRDYWorldDescriptorEditor의 "Build" 클릭 → AssetBundle 생성</td></tr>
<tr><td>6</td><td>VIRDY 로비에서 AssetBundle 업로드</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 SDK 외부 배포</h3>
<ul>
<li>SDK는 외부 크리에이터에게 웹사이트/문서를 통해 배포 예정</li>
<li>월드 빌드 + 아바타 빌드(자체 확장자) 기능 포함</li>
<li>외부 배포 시 VIRDY_CORE 심볼 없이 사용 가능해야 함</li>
</ul>
<h3>3.2 네트워크 컴포넌트의 NetworkObject 요구</h3>
<p>VIRDYNetworkBehaviour를 사용하는 모든 오브젝트는 NetworkObject 컴포넌트가 필수이다. 이를 누락하면 네트워크 동기화가 작동하지 않으므로, RequireComponent 어트리뷰트로 강제한다.</p>
<h3>3.3 월드 내 충돌 방지</h3>
<p>월드 AssetBundle에 포함된 EventSystem, Camera, AudioListener는 VIRDY 메인 시스템과 충돌하므로 자동 비활성화된다. SDK 사용자에게 이 제약을 명확히 안내해야 한다.</p>
<h3>3.4 프레임워크 통합 포인트</h3>
<p>SDK 컴포넌트는 VIRDY 프레임워크와 아래 지점에서 연결된다:</p>
<table>
<thead><tr><th>연결</th><th>설명</th></tr></thead>
<tbody>
<tr><td>카메라 이벤트</td><td>VIRDYWorldUI, VIRDYCinemachineTrack이 카메라 전환을 감지</td></tr>
<tr><td>생명주기</td><td>VIRDYWorldDescriptor가 월드 로드/언로드 시 모든 컴포넌트 초기화/정리</td></tr>
<tr><td>네트워크</td><td>VIRDYNetworkBehaviour가 Photon Fusion 세션에 자동 참여</td></tr>
<tr><td>PostIt</td><td>VIRDYPostItController가 NetworkActor.WriteBuffer에서 틱 호출</td></tr>
</tbody></table>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>VIRDYWorldDescriptor 누락 월드</td><td>기본값으로 동작 (스폰 포인트 = 원점)</td></tr>
<tr><td>NetworkObject 없이 VIRDYNetworkBehaviour 사용</td><td>RequireComponent로 자동 추가 강제</td></tr>
<tr><td>월드에 EventSystem/Camera/AudioListener 포함</td><td>자동 비활성화</td></tr>
<tr><td>SDK 버전과 클라이언트 버전 불일치</td><td>VIRDYWorldDescriptor의 UnityVersion/URPVersion으로 감지</td></tr>
<tr><td>DOTween 미설치 상태에서 FadeUI 사용</td><td>VIRDY_DOTWEEN 심볼 미정의 시 DOTween 코드 비활성화</td></tr>
<tr><td>다수의 VIRDYWorldDescriptor 존재</td><td>싱글톤으로 하나만 유지</td></tr>
<tr><td>OSC 포트 충돌</td><td>사용자에게 포트 변경 안내</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>외부 SDK 배포</strong></td><td>웹사이트/문서를 통한 외부 크리에이터 배포</td><td>높음</td></tr>
<tr><td><strong>자체 아바타 확장자</strong></td><td>애니메이션/스크립트 내장 아바타 빌드 기능</td><td>높음</td></tr>
<tr><td><strong>SDK 문서화</strong></td><td>API 레퍼런스, 튜토리얼, 예제 프로젝트</td><td>높음</td></tr>
<tr><td><strong>커스텀 컴포넌트 추가</strong></td><td>투표, 리더보드, 미니게임 등</td><td>중간</td></tr>
<tr><td><strong>비주얼 스크립팅</strong></td><td>코드 없이 인터랙션 설정</td><td>장기</td></tr>
<tr><td><strong>월드/아바타 마켓플레이스</strong></td><td>커뮤니티 콘텐츠 공유/판매</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>월드 시스템</li>
<li>네트워크 시스템</li>
<li>아바타 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_01_User_Roles">
            <div class="section-header">
                <h2>🔒 사용자 역할</h2>
            </div>
            <h1>사용자 역할</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY는 Creator와 Manager 두 가지 역할을 제공하여 프로덕션급 워크플로우를 지원한다. Creator는 아바타와 모션캡처를 포함한 전체 기능을 사용하며, Manager는 카메라/조명 등 프로덕션 지원에 집중한다. 역할은 회원가입 시 선택되며 계정에 고정된다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 역할 정의</h3>
<table>
<thead><tr><th>구분</th><th>Creator</th><th>Manager</th></tr></thead>
<tbody>
<tr><td>핵심 정의</td><td>아바타 + 모캡을 갖춘 전체 기능 사용자</td><td>프로덕션 제어에 집중하는 지원 사용자</td></tr>
<tr><td>리소스 사용</td><td>높음 (아바타, 애니메이션, 모캡 처리)</td><td>낮음 (아바타/모캡 없음)</td></tr>
<tr><td>세션 Actor 계산</td><td>1 Actor로 계산</td><td><strong>1 Actor로 계산</strong> (아바타 없어도 동일)</td></tr>
<tr><td>주 사용 대상</td><td>콘텐츠 크리에이터, VTuber, 출연자</td><td>카메라맨, PD, 조명 기술자</td></tr>
</tbody></table>
<blockquote><strong>중요</strong>: Manager도 세션 최대 Actor 수에 포함된다. 아바타 없이 참여하더라도 1 Actor로 계산되어 세션 자원을 점유한다. 이는 네트워크 부하 계산과 세션 관리를 일관되게 하기 위함이다.</blockquote>
<h3>2.2 역할별 기능 권한</h3>
<table>
<thead><tr><th>기능</th><th>Creator</th><th>Manager</th><th>비고</th></tr></thead>
<tbody>
<tr><td>아바타 인스턴스화</td><td>✅</td><td>❌</td><td>핵심 차이점</td></tr>
<tr><td>모션캡처 장비 연결</td><td>✅</td><td>❌</td><td>Facial/Body/Hand</td></tr>
<tr><td>FreeCam 카메라</td><td>✅</td><td>✅</td><td></td></tr>
<tr><td>고정 카메라 (1~9)</td><td>✅</td><td>✅</td><td></td></tr>
<tr><td>Channel Link 송신/수신</td><td>✅</td><td>✅</td><td></td></tr>
<tr><td>조명 제어</td><td>✅</td><td>✅</td><td>방향광</td></tr>
<tr><td>포스트 프로세싱 제어</td><td>✅</td><td>✅</td><td>Bloom, Color</td></tr>
<tr><td>세션 생성</td><td>✅</td><td>✅</td><td>Pro 이상 플랜만 (역할 무관)</td></tr>
<tr><td>월드 참가</td><td>✅</td><td>✅</td><td>세션 코드로 참가</td></tr>
<tr><td>아바타 설정 패널</td><td>✅</td><td>❌</td><td></td></tr>
<tr><td>트래커 설정 패널</td><td>✅</td><td>❌</td><td></td></tr>
<tr><td>전체 채팅</td><td>✅</td><td>✅</td><td></td></tr>
<tr><td>팀 채팅</td><td>✅</td><td>✅</td><td>역할별 분리</td></tr>
</tbody></table>
<h3>2.3 플랜별 역할 제한</h3>
<table>
<thead><tr><th>플랜</th><th>로컬 사용</th><th>세션 참가 시 역할</th><th>세션 생성</th></tr></thead>
<tbody>
<tr><td>Free</td><td>✅</td><td><strong>Manager로만 참가</strong></td><td>❌</td></tr>
<tr><td>Starter</td><td>✅</td><td><strong>Manager로만 참가</strong></td><td>❌</td></tr>
<tr><td>Pro 이상</td><td>✅</td><td>Creator/Manager 선택 가능</td><td>✅</td></tr>
</tbody></table>
<p><strong>Free/Starter 플랜 제한</strong>:</p>
<ul>
<li>로컬에서는 Creator로 아바타/모캡 사용 가능</li>
<li>멀티플레이어 세션에 <strong>초대받아 참가</strong>할 때는 <strong>Manager로만 참여</strong></li>
<li>세션에서 Creator(아바타 있음)로 참여하려면 Pro 이상 플랜 필요</li>
</ul>
<h3>2.3 역할 선택 및 저장</h3>
<h4>선택 시점</h4>
<p>회원가입 시 Creator 또는 Manager를 선택한다. 상호 배타적이며, 선택 후 계정에 고정된다.</p>
<h4>저장 구조</h4>
<table>
<thead><tr><th>위치</th><th>저장 방식</th></tr></thead>
<tbody>
<tr><td>Firebase Firestore</td><td>users/{userId}/isCreator (boolean)</td></tr>
<tr><td>로컬 캐시</td><td>UserData.IsCreator</td></tr>
<tr><td>네트워크 동기화</td><td>NetworkPlayer.IsCreator (RPC)</td></tr>
</tbody></table>
<h4>네트워크 동기화</h4>
<p>월드 입장 시 RPC를 통해 모든 접속자에게 역할이 전파된다. 이를 통해:</p>
<ul>
<li>플레이어 목록에서 역할별 색상 표시</li>
<li>팀 채팅 라우팅</li>
<li>UI 기능 접근 제어</li>
</ul>
<h3>2.4 팀 채팅 시스템</h3>
<p>역할 기반으로 팀 채팅이 분리된다.</p>
<table>
<thead><tr><th>채팅 모드</th><th>수신 대상</th><th>설명</th></tr></thead>
<tbody>
<tr><td>전체 채팅 [All]</td><td>모든 접속자</td><td>역할 무관</td></tr>
<tr><td>Creator 팀 [Creator]</td><td>Creator만</td><td>Creator 역할 사용자에게만 전송</td></tr>
<tr><td>Manager 팀 [Manager]</td><td>Manager만</td><td>Manager 역할 사용자에게만 전송</td></tr>
</tbody></table>
<h4>시각적 구분</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>플레이어 목록 색상</td><td>Creator/Manager 별도 색상</td></tr>
<tr><td>채팅 메시지 접두사</td><td>팀 채팅 시 (Creator) 또는 (Manager) 표시</td></tr>
<tr><td>채팅 입력 모드 표시</td><td>[All] / [Creator] / [Manager]</td></tr>
</tbody></table>
<h3>2.5 프로덕션 워크플로우</h3>
<h4>가상 방송 스튜디오 시나리오</h4>
<table>
<thead><tr><th>역할</th><th>담당자</th><th>주요 업무</th></tr></thead>
<tbody>
<tr><td>Creator</td><td>출연자</td><td>아바타 연기, 모션캡처 수행</td></tr>
<tr><td>Manager</td><td>PD</td><td>카메라 스위칭, 방송 송출 결정</td></tr>
<tr><td>Manager</td><td>카메라맨 A</td><td>CAM 1~3 촬영</td></tr>
<tr><td>Manager</td><td>카메라맨 B</td><td>CAM 4~6 촬영</td></tr>
<tr><td>Manager</td><td>카메라맨 C</td><td>CAM 7~9 촬영</td></tr>
<tr><td>Manager</td><td>조명 기술자</td><td>방향광, 포스트 프로세싱 조절</td></tr>
</tbody></table>
<h3>2.6 테넌트 내 권한 체계 검토 (서버 개발자 회의 기반)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시, 기존 Creator/Manager 역할 외에 <strong>테넌트 내 관리 권한 체계</strong>가 추가된다. Creator/Manager는 프로덕션 워크플로우 역할이고, Owner/Admin/Member는 테넌트 내 에셋/멤버 관리 권한이다.</p>
<h4>테넌트 관리 권한 (검토 중)</h4>
<table>
<thead><tr><th>권한</th><th>설명</th><th>주요 기능</th></tr></thead>
<tbody>
<tr><td><strong>Owner</strong></td><td>테넌트 소유자 (최초 생성자)</td><td>모든 권한 + 테넌트 삭제 + 멤버 관리</td></tr>
<tr><td><strong>Admin</strong></td><td>관리자</td><td>에셋 관리 + 멤버 초대 (Owner 제외)</td></tr>
<tr><td><strong>Member</strong></td><td>일반 멤버</td><td>에셋 사용 + 세션 참여</td></tr>
</tbody></table>
<h4>역할 체계 관계</h4>
<table>
<thead><tr><th>차원</th><th>역할</th><th>용도</th></tr></thead>
<tbody>
<tr><td>프로덕션 워크플로우</td><td>Creator / Manager</td><td>월드 내 기능 접근 (아바타, 카메라, 모캡)</td></tr>
<tr><td>테넌트 관리</td><td>Owner / Admin / Member</td><td>에셋/멤버/구독 관리 권한</td></tr>
</tbody></table>
<p>한 사용자는 두 차원의 역할을 동시에 갖는다. 예: Creator이면서 Admin, Manager이면서 Member 등.</p>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 역할 고정 정책</h3>
<p>역할은 회원가입 시 1회 선택하며 변경 불가. 이는 역할 기반 리소스 할당과 UI 구성을 단순화하기 위함이다. 향후 역할 변경 기능 추가를 고려할 수 있다.</p>
<h3>3.2 리소스 최적화</h3>
<p>Manager는 아바타/모캡 없이 동작하므로 PC 리소스 사용이 상대적으로 낮다. 프로덕션 환경에서 카메라맨/PD 용도의 PC에 최적화된 구성이 가능하다.</p>
<h3>3.3 Channel Link와 역할</h3>
<p>Channel Link는 역할에 관계없이 동등한 기능을 제공한다. Creator와 Manager 모두 카메라 송출/수신이 가능하다.</p>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>Free 플랜에서 세션 생성 시도</td><td>UI에서 버튼 비활성화, 업그레이드 안내</td></tr>
<tr><td>Manager가 아바타 설정 접근</td><td>로비에서 아바타/트래커 패널 숨김</td></tr>
<tr><td>Creator 없이 Manager만 세션에 존재</td><td>정상 동작 (카메라 조작만 가능)</td></tr>
<tr><td>역할 변경 요청</td><td>현재 미지원, 새 계정 생성 안내</td></tr>
<tr><td>팀 채팅에서 상대 역할 메시지 확인</td><td>팀 채팅은 같은 역할에게만 전송</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>역할 변경</strong></td><td>프로필에서 역할 변경 기능</td><td>낮음</td></tr>
<tr><td><strong>관전자 역할</strong></td><td>방송 관전만 가능한 역할</td><td>장기</td></tr>
<tr><td><strong>커스텀 역할</strong></td><td>프로덕션팀별 세밀한 권한 설정</td><td>장기</td></tr>
<tr><td><strong>역할별 라이선스</strong></td><td>Creator/Manager 별도 가격 정책</td><td>중간</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>제품 개요</li>
<li>사용자 플로우</li>
<li>카메라 시스템</li>
<li>UI 기획</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_02_License_System">
            <div class="section-header">
                <h2>🔒 라이선스 체계</h2>
            </div>
            <h1>라이선스 체계</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY의 라이선스 체계는 SaaS 구독 모델을 기반으로 설계된다. <strong>Free / Starter / Pro / Studio / Enterprise</strong> 5단계 티어로 구성되며, 각 티어는 사용자 세그먼트(체험자, 입문자, 개인 크리에이터, 프로덕션 스튜디오, 기업)별 차별화된 기능과 비용 구조를 제공한다.</p>
<blockquote>🚧 모든 아바타/월드 데이터는 <strong>서버에 저장</strong>되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 서버에서 다운로드 받아 사용한다.</blockquote>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 구독 플랜 티어</h3>
<table>
<thead><tr><th>항목</th><th>Free</th><th>Starter</th><th>Pro</th><th>Studio</th><th>Enterprise</th></tr></thead>
<tbody>
<tr><td><strong>대상</strong></td><td>체험자</td><td>입문자</td><td>개인 크리에이터</td><td>중규모 팀 / 스튜디오</td><td>기업/대규모 프로덕션</td></tr>
<tr><td><strong>방 생성</strong></td><td>❌</td><td>❌</td><td>✅</td><td>✅</td><td>✅</td></tr>
<tr><td><strong>세션 최대 Actor</strong></td><td>-</td><td>-</td><td>3</td><td>6</td><td>10+</td></tr>
<tr><td><strong>동시 방 보유</strong></td><td>0개</td><td>0개</td><td>1개</td><td>1개</td><td>협의</td></tr>
<tr><td><strong>매니저 모드</strong></td><td>수정중 (RPC 리스트업)</td></tr>
<tr><td><strong>Sync 모드</strong></td><td>Live</td><td>Live</td><td>Live</td><td>Live</td><td>Live / Ultra</td></tr>
<tr><td><strong>아바타 슬롯</strong></td><td>3개</td><td>10개</td><td>50개</td><td>50개</td><td>협의</td></tr>
<tr><td><strong>아바타 용량 제한</strong></td><td>200MB/개</td><td>200MB/개</td><td>200MB/개</td><td>200MB/개</td><td>협의</td></tr>
<tr><td><strong>월드 용량 제한</strong></td><td>-</td><td>300MB</td><td>800MB</td><td>800MB</td><td>협의</td></tr>
<tr><td><strong>상업적 사용</strong></td><td>제한적 허용</td></tr>
</tbody></table>
<blockquote><strong>동시 방 보유 정책</strong>: 비용 및 운영 복잡도를 고려하여, 모든 개인 플랜(Starter/Pro/Studio)의 동시 방 보유 수는 <strong>1개로 고정</strong>한다. 기존 세션이 있는 상태에서 새 세션 생성 시, 기존 세션 종료 후 생성하도록 안내한다.</blockquote>
<blockquote><strong>상업적 사용 정책</strong>: 상업적 사용이라 함은 콘서트, MV, 영상물 등 기업에서 상업적 사용을 목적으로 할 때에 제한적으로 둔다. 대체로 허용되는 수준이오나 특정 구간, 콘텐츠에서의 상업 제한이 필요할지는 검토 필요</blockquote>
<h3>2.2 Sync 모드</h3>
<p>네트워크 동기화 품질은 <strong>Live</strong>와 <strong>Ultra</strong> 두 가지 모드로 구분된다.</p>
<table>
<thead><tr><th>모드</th><th>대상 플랜</th><th>특징</th><th>용도</th></tr></thead>
<tbody>
<tr><td><strong>Live</strong></td><td>모든 플랜</td><td>경량 모션 데이터, 비용 효율적</td><td>일반 방송, 개인 사용</td></tr>
<tr><td><strong>Ultra</strong></td><td>Enterprise 전용</td><td>고품질 모션 데이터, 높은 대역폭</td><td>공연, 특수 연출, 전문 프로덕션</td></tr>
</tbody></table>
<p><strong>Sync 모드 설계 원칙:</strong></p>
<ul>
<li>Sync 품질은 기술 옵션이 아닌 <strong>비용 및 계약 개념</strong>으로 관리</li>
<li>현재 사용 중인 고용량 모션 데이터는 일반 사용에 부적합</li>
<li>Live Sync 전용으로 최적화된 경량 모션 데이터 개발 필요</li>
</ul>
<h3>2.3 스토리지 정책</h3>
<p>모든 아바타/월드 데이터는 <strong>서버(클라우드)에만 저장</strong>되며, 로컬 저장 방식은 사용하지 않는다. 클라이언트는 로비 진입 시 서버에서 데이터를 다운로드하여 사용한다.</p>
<p>아바타 슬롯 수 제한은 사용자에게 직접 노출하지 않고, 내부적으로만 관리한다. 실질적으로 제한이 없는 수준(50개)으로 설정하여 사용자 경험을 해치지 않는다.</p>
<table>
<thead><tr><th>티어</th><th>아바타 보관</th><th>아바타 용량</th><th>월드 용량</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Free</td><td>3개</td><td>200MB/개</td><td>-</td><td>체험용, 월드 업로드 불가</td></tr>
<tr><td>Starter</td><td>10개</td><td>200MB/개</td><td>300MB</td><td>입문자용</td></tr>
<tr><td>Pro</td><td>50개</td><td>200MB/개</td><td>800MB</td><td>사실상 무제한</td></tr>
<tr><td>Studio</td><td>50개</td><td>200MB/개</td><td>800MB</td><td>팀 사용 지원</td></tr>
<tr><td>Enterprise</td><td>협의</td><td>협의</td><td>협의</td><td>맞춤 계약</td></tr>
</tbody></table>
<h3>2.4 Studio / Enterprise 플랜</h3>
<p>Studio와 Enterprise 플랜은 팀 또는 기업 단위 사용을 고려한 플랜이다.</p>
<table>
<thead><tr><th>항목</th><th>Studio</th><th>Enterprise</th></tr></thead>
<tbody>
<tr><td>대상</td><td>규모 있는 개인 크리에이터, 소규모 팀</td><td>기업, 대규모 프로덕션</td></tr>
<tr><td>조직 관리</td><td>📋 검토 중</td><td>✅ 조직 시트 기반</td></tr>
<tr><td>Ultra Sync</td><td>❌</td><td>✅ (공연, 특수 연출)</td></tr>
<tr><td>맞춤 계약</td><td>❌</td><td>✅</td></tr>
</tbody></table>
<p><strong>Enterprise 조직 시트</strong>:</p>
<ul>
<li>관리자가 멤버를 이메일로 초대하여 시트 할당</li>
<li>어드민 페이지에서 멤버 추가/제거/권한 관리</li>
<li>시트별 권한 할당 가능</li>
</ul>
<p><strong>Studio 조직 시트 검토 사항</strong>:</p>
<ul>
<li>Studio는 기업뿐 아니라 개인 크리에이터도 사용 가능</li>
<li>개인 방송인에게 조직 관리 기능 제공이 불필요할 수 있음</li>
<li>조직 시트 제공 여부 추가 논의 필요</li>
</ul>
<h3>2.5 Actor 및 Seat 개념</h3>
<p>플랜별 Actor 수 제한은 서버 측에서 검증되며, 유료 테넌트에는 Seat(멤버 초대 가능 수) 개념이 도입된다.</p>
<h4>Actor 개념</h4>
<p><strong>Actor</strong>는 아바타 + 트래커 조합의 단위이다. 1명의 사용자가 여러 개의 Actor를 동시에 운용할 수 있다.</p>
<table>
<thead><tr><th>용어</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>개인 Actor 수</strong></td><td>한 사용자가 자신의 PC에서 동시에 운용할 수 있는 Actor 수 (플랜별 상이)</td></tr>
<tr><td><strong>세션 최대 Actor</strong></td><td>한 세션(방)에 동시에 입장할 수 있는 총 Actor 수 (호스트 플랜 기준)</td></tr>
</tbody></table>
<p><strong>매니저(Manager)도 1 Actor로 계산</strong>: 아바타 없이 매니저로 참여하는 사용자도 세션 최대 Actor 수에 포함된다. 이는 세션 자원 관리를 단순화하고, 네트워크 부하 계산을 일관되게 하기 위함이다.</p>
<p><strong>시나리오 예시</strong>:</p>
<ul>
<li>Pro 플랜 호스트가 세션을 생성 (세션 최대 Actor: 3)</li>
<li>호스트가 Actor 2개를 사용 → 남은 슬롯 1개</li>
<li>다른 사용자가 Creator(아바타 있음)로 참여 시: 1 Actor 차지 → 세션 가득 참</li>
<li>다른 사용자가 Manager(아바타 없음)로 참여 시: 동일하게 1 Actor 차지 → 세션 가득 참</li>
</ul>
<h4>플랜별 개인 Actor 수</h4>
<table>
<thead><tr><th>플랜</th><th>개인 Actor 수</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Free</td><td>1개</td><td>단일 사용자</td></tr>
<tr><td>Starter</td><td>1개</td><td>단일 사용자</td></tr>
<tr><td>Pro</td><td>2개</td><td>권장 사양 (1 PC 기준 최적 성능)</td></tr>
<tr><td>Studio</td><td>4개</td><td>고사양 PC 필요</td></tr>
<tr><td>Enterprise</td><td>6개+</td><td>고사양 PC, 상황에 따라 워크스테이션 필요</td></tr>
</tbody></table>
<h4>Seat 개념 (검토 중)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>정의</td><td>유료 테넌트의 멤버 초대 가능 수</td></tr>
<tr><td>적용 범위</td><td>유료 플랜 (Enterprise 중심)</td></tr>
<tr><td>관리</td><td>테넌트 Owner/Admin이 Seat 할당 및 초대</td></tr>
</tbody></table>
<h3>2.6 방 생성 및 세션 제한</h3>
<p>비용 및 운영 복잡도를 고려하여, <strong>계정당 방 보유 수는 1개로 고정</strong>한다.</p>
<table>
<thead><tr><th>제한 항목</th><th>Free</th><th>Starter</th><th>Pro</th><th>Studio</th><th>Enterprise</th></tr></thead>
<tbody>
<tr><td>동시 세션 생성</td><td>0</td><td>0</td><td>1</td><td>1</td><td>협의</td></tr>
<tr><td>세션 최대 Actor</td><td>-</td><td>-</td><td>3</td><td>6</td><td>10+</td></tr>
</tbody></table>
<p><strong>세션 유지 조건:</strong></p>
<ul>
<li><strong>Pro 이상 플랜 사용자</strong>가 최소 1명 이상 접속 중일 때만 세션 유지</li>
<li>Free/Starter 사용자만 남은 세션은 "0명" 취급 → 10분 유예 후 파기</li>
<li>세션 소유자 퇴장 시 남은 <strong>Pro 이상 플랜 사용자</strong>에게 소유권 자동 이전</li>
<ul>
<li>Creator/Manager 역할 구분 없이 <strong>플랜 등급만 확인</strong></li>
<li>Pro 플랜 Manager도 세션 소유권 이전 대상에 포함됨</li>
</ul>
</ul>
<p><strong>세션 권한 이전 시나리오</strong>:</p>
<ul>
<li>Pro Creator 2명 + Pro Manager 1명이 세션에 참가 중</li>
<li>Pro Creator 2명이 모두 퇴장 → Pro Manager에게 세션 소유권 이전</li>
<li>Pro Manager는 Pro 플랜이므로 세션 유지 (10분 유예 적용 안 됨)</li>
<li>이후 Pro Manager도 퇴장하면 → Free/Starter만 남으면 10분 유예 후 세션 종료</li>
</ul>
<p><strong>세션 관리 기능:</strong></p>
<ul>
<li>유료 플랜 사용자는 로비에서 "내 세션" 패널을 통해 활성 세션 관리</li>
<li>세션 리스트 조회, 재접속, 강제 종료 가능</li>
<li><strong>기존 세션이 있는 상태에서 새 월드 생성 시</strong>: 기존 세션 강제 종료 안내 → 확인 후 새 세션 생성</li>
</ul>
<blockquote>세션 생명주기 상세 정책은 데이터 생명주기 참조</blockquote>
<h3>2.7 Free / Starter 플랜 설계 원칙</h3>
<p><strong>Free 플랜</strong>은 체험용으로, 기능 및 사용성에 제한을 두어 유료 전환을 유도한다. <strong>Starter 플랜</strong>은 월 구독 중 가장 저렴한 옵션으로, 편안하게 사용할 수 있는 입문 버전이다.</p>
<table>
<thead><tr><th>항목</th><th>Free</th><th>Starter</th></tr></thead>
<tbody>
<tr><td>방 생성</td><td>❌</td><td>❌</td></tr>
<tr><td>세션 참가</td><td>✅ (매니저로만)</td><td>✅ (매니저로만)</td></tr>
<tr><td>세션 참가 시 역할</td><td>Manager 전용</td><td>Manager 전용</td></tr>
<tr><td>로컬 사용</td><td>✅</td><td>✅</td></tr>
<tr><td>아바타 슬롯</td><td>3개</td><td>10개</td></tr>
<tr><td>월드 업로드</td><td>❌</td><td>✅</td></tr>
<tr><td>트래커 사용</td><td>✅ (로컬)</td><td>✅ (로컬)</td></tr>
<tr><td>채팅 참여</td><td>✅</td><td>✅</td></tr>
<tr><td>상업적 사용</td><td>❌</td><td>❌</td></tr>
</tbody></table>
<p><strong>Free / Starter 세션 참가 제한</strong>:</p>
<ul>
<li>Free/Starter 사용자는 <strong>로컬에서만 Creator(아바타 있음)로 사용</strong> 가능</li>
<li>멀티플레이어 세션에 초대받아 참가할 때는 <strong>Manager(아바타 없음)로만 참여</strong> 가능</li>
<li>Manager로 참여해도 <strong>1 Actor로 계산</strong>되어 세션 최대 Actor에 포함됨</li>
<li>세션 내에서 카메라 조작, 채팅 등 Manager 기능은 모두 사용 가능</li>
</ul>
<p><strong>Free → Starter/Pro 전환 유도 전략 (검토 중)</strong>:</p>
<p>Free 플랜에서 충분히 기능을 체험할 수 있지만, 다음과 같은 제한으로 유료 전환을 유도한다:</p>
<table>
<thead><tr><th>제한 방식</th><th>설명</th><th>장점</th><th>단점</th></tr></thead>
<tbody>
<tr><td>방 생성 불가</td><td>초대받아서만 참여 가능</td><td>명확한 차별점</td><td>멀티가 필요없는 유저라면 제한이 아님</td></tr>
<tr><td>워터마크</td><td>화면에 VIRDY 로고 표시</td><td>바이럴 효과</td><td>사용자 불편</td></tr>
<tr><td>기능 잠금</td><td>일부 고급 기능 잠금 (예: 조명 제어)</td><td>핵심 기능은 체험 가능</td><td>제한 기준 설정 어려움</td></tr>
</tbody></table>
<blockquote>📋 각 플랜의 구체적인 제한 범위는 추가 논의가 필요하다.</blockquote>
<h3>2.8 가격 정책 (검토 중)</h3>
<table>
<thead><tr><th>모델</th><th>설명</th><th>상태</th></tr></thead>
<tbody>
<tr><td>SaaS 구독</td><td>월간/연간 구독</td><td>📋 주력 검토</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 비용 산정 원칙</h3>
<p>비용 산정은 항상 <strong>최악의 경우(Worst Case)</strong>를 기준으로 고려한다.</p>
<table>
<thead><tr><th>비용 요소</th><th>중요도</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>Photon 서버 비용</strong></td><td>높음</td><td>동시 접속자 수, 세션 수에 비례</td></tr>
<tr><td><strong>다운로드 트래픽</strong></td><td>높음</td><td>월드/아바타 다운로드 (현재 1GB당 약 150원)</td></tr>
<tr><td><strong>스토리지 비용</strong></td><td>중간</td><td>비활성 계정 데이터 장기 보관 시 누적</td></tr>
</tbody></table>
<blockquote>상세 비용 산출, 플랜별 마진 분석, 손익분기점(BEP)은 비용 분석 참조</blockquote>
<h3>3.2 리전별 비용 차이</h3>
<p>Firebase Storage 다운로드 비용은 리전에 따라 다르므로, 서비스 리전 선택 시 비용 확인 필요.</p>
<h3>3.3 플랜 등급 하락 정책</h3>
<p>Enterprise → 하위 플랜으로 등급 하락 시:</p>
<table>
<thead><tr><th>정책</th><th>설명</th></tr></thead>
<tbody>
<tr><td>즉시 삭제</td><td>❌ 부적절</td></tr>
<tr><td>유예 기간</td><td>일정 기간 데이터 다운로드 가능</td></tr>
<tr><td>Archive/Frozen</td><td>아카이브로 데이터 이동 (서버 비용 감축)</td></tr>
<tr><td>장기 미복귀</td><td>6~12개월 후 데이터 삭제</td></tr>
</tbody></table>
<blockquote>상세 정책은 데이터 생명주기 문서 참조</blockquote>
<h3>3.4 결제 시스템 (미구현)</h3>
<p>현재 코드베이스에 결제/빌링 시스템이 없다. 향후 구현 시 고려할 사항:</p>
<ul>
<li>Stripe 또는 결제 게이트웨이 통합</li>
<li>구독 상태 관리 (Firebase Functions)</li>
<li>라이선스 키 발급 및 검증</li>
<li>평가판 기간 로직</li>
<li>Steam DRM / 가격 정책 연동</li>
</ul>
<h3>3.5 보안 취약점</h3>
<table>
<thead><tr><th>취약점</th><th>설명</th></tr></thead>
<tbody>
<tr><td>클라이언트 측 제한만 적용</td><td>서버 측 검증 없음</td></tr>
<tr><td>메모리 해킹 가능</td><td>MaxActorSize 런타임 변경 가능</td></tr>
</tbody></table>
<p>향후 서버 측 라이선스 검증, 암호화된 라이선스 토큰, 주기적 라이선스 확인이 필요하다.</p>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>무료 플랜에서 방 생성 시도</td><td>UI에서 비활성화 + 업그레이드 안내</td></tr>
<tr><td>구독 만료 시</td><td>데이터 손실 없이 기능 차단, 갱신 안내</td></tr>
<tr><td>동시 방 한도 초과</td><td>새 방 생성 차단, 기존 방 종료 유도</td></tr>
<tr><td>Enterprise → Pro 등급 하락</td><td>유예 기간 제공, 데이터 아카이브</td></tr>
<tr><td>결제 실패</td><td>유예 기간 제공 후 기능 제한</td></tr>
<tr><td>Ultra Sync 네트워크 조건 미달</td><td>Live로 자동 전환 + 안내</td></tr>
</tbody></table>
<hr>
<h2 id="5-미결정-쟁점">5. 미결정 쟁점</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Free 플랜 제한 방식</td><td>📋 논의 필요</td><td>워터마크 / 세션 시간 제한 / 기능 잠금 등</td></tr>
<tr><td>Studio 플랜 조직 시트 제공 여부</td><td>📋 논의 필요</td><td>개인 크리에이터에게 불필요할 수 있음</td></tr>
<tr><td>구독 종료 후 데이터 보관 기간</td><td>📋 논의 필요</td><td>Google Drive 등 벤치마킹</td></tr>
<tr><td>Enterprise 시트 구조의 구체적 운영 방식</td><td>📋 논의 필요</td><td>어드민 페이지 기능 범위</td></tr>
<tr><td>플랜별 가격</td><td>📋 논의 필요</td><td>-</td></tr>
<tr><td>Starter/Pro 플랜의 정확한 포지셔닝</td><td>📋 논의 필요</td><td>Free와 Pro 사이 차별점 명확화</td></tr>
</tbody></table>
<hr>
<h2 id="6-향후-확장-가능성">6. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>5티어 플랜 기능 제한/구현</strong></td><td>Free/Starter/Pro/Studio/Enterprise</td><td>높음</td></tr>
<tr><td><strong>결제 시스템</strong></td><td>Stripe/Steam 결제 연동</td><td>높음</td></tr>
<tr><td><strong>조직 관리 페이지</strong></td><td>Enterprise 어드민 페이지 (멤버 초대/관리)</td><td>높음</td></tr>
<tr><td><strong>라이선스 서버</strong></td><td>서버 측 라이선스 검증</td><td>중간</td></tr>
<tr><td><strong>평가판</strong></td><td>기간 한정 Pro/Studio 체험</td><td>중간</td></tr>
<tr><td><strong>Ultra Sync 구현</strong></td><td>Enterprise 전용 고품질 동기화</td><td>중간</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>제품 개요</li>
<li>사용자 역할</li>
<li>보안 시스템</li>
<li>데이터 생명주기</li>
<li>리스크 관리</li>
<li>계정 시스템</li>
<li>네트워크 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_03_Security">
            <div class="section-header">
                <h2>🔒 보안 시스템</h2>
            </div>
            <h1>보안 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY의 보안 시스템은 인증, 데이터 보호, 아바타 저작권 보호를 중심으로 설계된다. 현행 시스템은 Firebase 서비스(Auth, Firestore 보안 규칙, Functions)를 기반으로 하며, 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에 따라 JWT 기반 인증, Photon Webhook 보안, Signed URL 기반 파일 접근 제어가 추가될 수 있다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 보안 아키텍처</h3>
<table>
<thead><tr><th>계층</th><th>서비스</th><th>역할</th></tr></thead>
<tbody>
<tr><td>인증</td><td>Firebase Auth</td><td>이메일/비밀번호 인증, 토큰 관리</td></tr>
<tr><td>데이터 보호</td><td>Firestore 보안 규칙</td><td>사용자/월드/아바타 데이터 접근 제어</td></tr>
<tr><td>서버 로직</td><td>Firebase Functions</td><td>서버 측 검증, 민감 작업 처리</td></tr>
<tr><td>파일 저장</td><td>Firebase Storage</td><td>보안 규칙 기반 파일 접근 제어</td></tr>
<tr><td>아바타 보호</td><td>VRM 암호화</td><td>아바타 파일 암호화 저장</td></tr>
</tbody></table>
<h3>2.2 인증 시스템</h3>
<h4>이메일 기반 인증</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>회원가입</td><td>Firebase Functions (signUpV2)를 통해 계정 생성</td></tr>
<tr><td>이메일 인증</td><td>Firebase Auth 이메일 인증 발송 → 인증 완료 필수</td></tr>
<tr><td>로그인</td><td>이메일 + 비밀번호로 인증, 이메일 인증 완료 확인</td></tr>
<tr><td>사용자명 로그인</td><td>사용자명 → Firebase Function으로 이메일 조회 → 이메일 로그인</td></tr>
<tr><td>비밀번호 리셋</td><td>Firebase Auth 비밀번호 리셋 이메일 발송</td></tr>
</tbody></table>
<h4>인증 토큰</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>토큰 방식</td><td>Firebase Auth 토큰 (자동 갱신)</td></tr>
<tr><td>세션 유지</td><td>Firebase SDK가 토큰 수명주기 관리</td></tr>
<tr><td>로그아웃</td><td>Firebase Auth 로그아웃 → 토큰 무효화</td></tr>
</tbody></table>
<h3>2.3 Firestore 보안 규칙</h3>
<p>Firestore 보안 규칙을 통해 데이터 접근을 제어한다.</p>
<h4>사용자 데이터</h4>
<table>
<thead><tr><th>규칙</th><th>설명</th></tr></thead>
<tbody>
<tr><td>읽기</td><td>인증된 사용자만 자신의 데이터 읽기</td></tr>
<tr><td>쓰기</td><td>Firebase Functions를 통해서만 수정 (직접 쓰기 차단)</td></tr>
</tbody></table>
<h4>월드 데이터</h4>
<table>
<thead><tr><th>유형</th><th>읽기 규칙</th><th>쓰기 규칙</th></tr></thead>
<tbody>
<tr><td>Public 월드</td><td>모든 인증 사용자</td><td>제작자만 (Functions 경유)</td></tr>
<tr><td>Private 월드</td><td>제작자만</td><td>제작자만 (Functions 경유)</td></tr>
<tr><td>Private+ 월드</td><td>제작자 + sharedWith 목록</td><td>제작자만 (Functions 경유)</td></tr>
</tbody></table>
<h4>아바타 데이터</h4>
<table>
<thead><tr><th>규칙</th><th>설명</th></tr></thead>
<tbody>
<tr><td>읽기</td><td>소유자만</td></tr>
<tr><td>쓰기</td><td>소유자만</td></tr>
<tr><td>타인 접근</td><td>Firebase 보안 규칙으로 차단</td></tr>
</tbody></table>
<h3>2.4 Firebase Functions</h3>
<p>민감한 작업은 클라이언트에서 직접 수행하지 않고 Firebase Functions를 통해 서버 측에서 처리한다.</p>
<table>
<thead><tr><th>함수</th><th>용도</th></tr></thead>
<tbody>
<tr><td>signUpV2</td><td>회원가입 (계정 생성 + Firestore 저장)</td></tr>
<tr><td>getEmailByUsername</td><td>사용자명 → 이메일 조회</td></tr>
<tr><td>saveWorld</td><td>월드 메타데이터 저장</td></tr>
<tr><td>deleteWorld</td><td>월드 삭제 (Firestore + Storage)</td></tr>
<tr><td>getWorldData</td><td>월드 메타데이터 조회</td></tr>
</tbody></table>
<h3>2.5 아바타 파일 보호</h3>
<h4>VRM 암호화</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>대상</td><td>VRM 아바타 파일</td></tr>
<tr><td>업로드 시</td><td>암호화 후 Firebase Storage 저장</td></tr>
<tr><td>로컬 캐시</td><td>암호화 상태로 캐시 저장</td></tr>
<tr><td>로드 시</td><td>복호화 후 메모리에서 사용</td></tr>
<tr><td>목적</td><td>파일 직접 추출 방지, 저작권 보호</td></tr>
</tbody></table>
<h4>VRM 저작권 정보 존중</h4>
<table>
<thead><tr><th>메타데이터</th><th>설명</th></tr></thead>
<tbody>
<tr><td>AllowedUser</td><td>허용 사용자 범위</td></tr>
<tr><td>ViolentUsage</td><td>폭력적 사용 허용 여부</td></tr>
<tr><td>SexualUsage</td><td>성적 사용 허용 여부</td></tr>
<tr><td>CommercialUsage</td><td>상업적 사용 허용 여부</td></tr>
</tbody></table>
<h3>2.6 네트워크 보안</h3>
<h4>Photon 세션</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>세션 접근</td><td>세션 코드를 아는 사용자만 참가</td></tr>
<tr><td>로비 분리</td><td>버전별 로비 분리 (VIRDY.{버전})</td></tr>
<tr><td>데이터 전송</td><td>Photon 서버를 통한 암호화 전송</td></tr>
</tbody></table>
<h4>Chat 보안</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>인증</td><td>Firebase UserId로 Photon Chat 인증</td></tr>
<tr><td>개인 메시지</td><td>초대/따라가기/데려오기 등 명령은 Private Message로 전송</td></tr>
<tr><td>팀 채팅</td><td>역할 기반 필터링 (클라이언트 측)</td></tr>
</tbody></table>
<h3>2.7 Firebase Storage 보안</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>아바타 파일</td><td>소유자만 읽기/쓰기</td></tr>
<tr><td>월드 파일</td><td>공개 설정에 따라 접근 제어</td></tr>
<tr><td>썸네일</td><td>월드 공개 설정에 따라 공개</td></tr>
<tr><td>전송</td><td>HTTPS 암호화</td></tr>
</tbody></table>
<h3>2.8 보안 아키텍처 전환 검토 (서버 개발자 회의 기반)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시 보안 계층이 다음과 같이 강화된다.</p>
<h4>JWT 기반 인증 보안 (검토 중)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Access Token</td><td>1시간 만료, API 호출마다 서명 검증</td></tr>
<tr><td>Refresh Token</td><td>7~30일 만료 (미확정), 안전한 로컬 저장소 보관</td></tr>
<tr><td>JWT Payload</td><td>userId, tenantId, role, subscriptionPlan 포함</td></tr>
<tr><td>서버 측 검증</td><td>모든 API 요청에서 JWT 서명/만료/권한 검증 수행</td></tr>
</tbody></table>
<p>현행 Firebase Auth 토큰과 달리, JWT에 구독 플랜과 역할 정보를 직접 포함하여 API 호출마다 서버 측에서 권한을 검증할 수 있다.</p>
<h4>Photon Custom Authentication (검토 중)</h4>
<p>Photon 세션 접속 시 VIRDY Backend를 통한 인증을 필수로 설정하여, AppID 탈취로 인한 무단 사용을 방지한다.</p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Unity Client가 Photon에 연결 요청 (JWT 포함)</td></tr>
<tr><td>2</td><td>Photon이 Backend로 Auth 검증 요청 (JWT 전달)</td></tr>
<tr><td>3</td><td>Backend에서 JWT 서명/만료/구독 확인</td></tr>
<tr><td>4</td><td>인증 결과를 Photon에 반환</td></tr>
<tr><td>5</td><td>Photon이 Client에 연결 허용/거부</td></tr>
</tbody></table>
<h4>Photon Webhook 보안 (검토 중)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Webhook Secret</td><td>Photon → Backend 요청 시 Secret으로 요청 검증</td></tr>
<tr><td>이벤트 종류</td><td>Room 생성/종료, Player 입장/퇴장</td></tr>
<tr><td>Backend 처리</td><td>세션 상태 DB 저장, 참가자 수 관리</td></tr>
</tbody></table>
<h4>Cloudflare R2 Signed URL 보안 (검토 중)</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>업로드</td><td>Backend에서 시간 제한 Signed URL 발급 → 클라이언트가 R2에 직접 업로드</td></tr>
<tr><td>다운로드</td><td>Backend에서 권한 확인 후 Signed URL 발급 → 클라이언트가 R2에서 직접 다운로드</td></tr>
<tr><td>Egress 비용</td><td>Cloudflare R2는 Egress 무료 (Firebase Storage 대비 비용 절감)</td></tr>
<tr><td>URL 만료</td><td>시간 제한으로 URL 유출 시에도 재사용 불가</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 클라이언트 측 보안 한계</h3>
<p>현재 일부 검증이 클라이언트 측에서만 수행된다.</p>
<table>
<thead><tr><th>항목</th><th>현재</th><th>개선 방향</th></tr></thead>
<tbody>
<tr><td>액터 수 제한</td><td>클라이언트 상수</td><td>서버 측 검증 추가</td></tr>
<tr><td>역할 확인</td><td>Firestore 평문 저장</td><td>난독화 또는 서버 측 검증</td></tr>
<tr><td>라이선스</td><td>빌드 타임 심볼</td><td>라이선스 서버 도입</td></tr>
</tbody></table>
<h3>3.2 아바타 저작권 보호 강화</h3>
<p>VRM 파일은 암호화하지만, 메모리에서 복호화된 상태에서 추출 가능성이 있다. 추가 보호 조치:</p>
<ul>
<li>런타임 메모리 보호 (난독화)</li>
<li>워터마크 삽입</li>
<li>DRM 수준 보호 (장기)</li>
</ul>
<h3>3.3 Firebase 의존도</h3>
<p>보안이 Firebase 서비스에 강하게 의존하고 있다. Firebase 장애 시 전체 인증/데이터 접근이 불가하므로, 장기적으로 자체 인증 서버 백업을 고려할 수 있다.</p>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>이메일 인증 미완료 로그인</td><td>인증 메일 재발송 안내</td></tr>
<tr><td>비밀번호 분실</td><td>Firebase Auth 리셋 이메일 발송</td></tr>
<tr><td>Firebase Auth 토큰 만료</td><td>SDK 자동 갱신</td></tr>
<tr><td>타인의 아바타 다운로드 시도</td><td>Firebase Storage 보안 규칙으로 차단</td></tr>
<tr><td>삭제된 월드 공유 링크 접근</td><td>"월드를 찾을 수 없습니다" 오류</td></tr>
<tr><td>Private 월드 권한 없는 접근</td><td>Firestore 보안 규칙으로 차단</td></tr>
<tr><td>암호화된 아바타 파일 손상</td><td>재다운로드 안내</td></tr>
<tr><td>세션 코드 브루트포스</td><td>4자리 코드 + 버전 로비 분리로 완화</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>서버 측 라이선스 검증</strong></td><td>JWT 기반 서버 측 구독/권한 검증</td><td>높음</td></tr>
<tr><td><strong>Photon Custom Auth</strong></td><td>Backend를 통한 Photon 접속 인증</td><td>높음</td></tr>
<tr><td><strong>Webhook Secret 검증</strong></td><td>Photon Webhook 요청의 무결성 검증</td><td>높음</td></tr>
<tr><td><strong>소셜 로그인</strong></td><td>Google, Steam 등 OAuth 연동</td><td>중간</td></tr>
<tr><td><strong>2단계 인증</strong></td><td>OTP 또는 인증 앱 연동</td><td>낮음</td></tr>
<tr><td><strong>DRM 강화</strong></td><td>아바타/월드 파일 DRM 보호</td><td>장기</td></tr>
<tr><td><strong>런처 인증</strong></td><td>자동 업데이트 + 토큰 인증 런처</td><td>중간</td></tr>
<tr><td><strong>감사 로그</strong></td><td>사용자 행동 로깅 및 모니터링</td><td>중간</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>라이선스 체계</li>
<li>사용자 역할</li>
<li>계정 시스템</li>
<li>데이터 생명주기</li>
<li>리스크 관리</li>
<li>아바타 시스템</li>
<li>네트워크 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_04_Data_Lifecycle">
            <div class="section-header">
                <h2>🔒 데이터 생명주기</h2>
            </div>
            <h1>데이터 생명주기</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY 서비스 내 모든 데이터의 생성, 보관, 아카이브, 삭제에 대한 정책을 정의한다. 데이터 유형별로 보관 기간과 처리 방식을 명확히 하여 운영 비용을 최적화하고 사용자 자산을 보호한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 데이터 유형 분류</h3>
<table>
<thead><tr><th>유형</th><th>예시</th><th>복구 필요성</th><th>보관 기간</th></tr></thead>
<tbody>
<tr><td><strong>유저 자산 데이터</strong></td><td>아바타, 월드</td><td>필수</td><td>장기 (정책에 따라)</td></tr>
<tr><td><strong>계정 데이터</strong></td><td>프로필, 설정, 친구 목록</td><td>필수</td><td>계정 삭제 전까지</td></tr>
<tr><td><strong>로그성 데이터</strong></td><td>세션 로그, 접속 기록</td><td>불필요</td><td>30~90일</td></tr>
<tr><td><strong>실시간 세션 데이터</strong></td><td>방 상태, 채팅</td><td>불필요</td><td>세션 종료 즉시 파기</td></tr>
<tr><td><strong>법적/보안 로그</strong></td><td>결제 기록, 보안 이벤트</td><td>법적 요구</td><td>법적 요구 범위 내</td></tr>
</tbody></table>
<h3>2.2 유저 자산 데이터</h3>
<p>유저 자산은 바로 지우면 안 되는 데이터로, 신중한 생명주기 관리가 필요하다.</p>
<table>
<thead><tr><th>자산</th><th>저장 위치</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>아바타</strong></td><td>Firebase Storage</td><td>VRM 파일 (암호화 저장)</td></tr>
<tr><td><strong>월드</strong></td><td>Firebase Storage</td><td>AssetBundle 파일</td></tr>
<tr><td><strong>메타데이터</strong></td><td>Firestore</td><td>아바타/월드 설정, 공유 정보</td></tr>
</tbody></table>
<h3>2.3 로그성 데이터</h3>
<p>복구 불가능해도 되는 데이터:</p>
<table>
<thead><tr><th>데이터</th><th>보관 기간</th><th>비고</th></tr></thead>
<tbody>
<tr><td>세션 로그</td><td>30~90일</td><td>디버깅, 분석용</td></tr>
<tr><td>접속 기록</td><td>30~90일</td><td>익명화 가능</td></tr>
<tr><td>서버 성능 로그</td><td>30~90일</td><td>모니터링용</td></tr>
<tr><td>에러 로그</td><td>30~90일</td><td>버그 추적용</td></tr>
</tbody></table>
<hr>
<h2 id="3-구독-상태별-데이터-처리">3. 구독 상태별 데이터 처리</h2>
<h3>3.1 구독 활성 상태</h3>
<table>
<thead><tr><th>상태</th><th>데이터 처리</th></tr></thead>
<tbody>
<tr><td>구독 시작</td><td>플랜에 따른 스토리지 할당</td></tr>
<tr><td>구독 유지</td><td>정상 접근 및 사용 가능</td></tr>
</tbody></table>
<h3>3.2 구독 중단 시 처리 플로우</h3>
<pre><code class="">구독 중단
<p>↓ [N일 유예 기간]</p>
<ul>
<li>데이터 접근 가능 (읽기 전용)</li>
<li>아바타/월드 다운로드 가능</li>
</ul>
<p>↓ [유예 기간 종료]</p>
<ul>
<li>아카이브로 데이터 이동</li>
<li>서버 비용 감축 (Cold Storage)</li>
</ul>
<p>↓ [장기 미복귀: 6~12개월]</p>
<ul>
<li>데이터 삭제</li>
<li>단, 로그인 시 삭제 기간 리셋</li>
<li>아카이브 이동 기간은 리셋하지 않음</code></pre></li>
</ul>
<h3>3.3 구독 상태별 상세 정책</h3>
<table>
<thead><tr><th>단계</th><th>기간</th><th>데이터 상태</th><th>사용자 액션</th></tr></thead>
<tbody>
<tr><td><strong>유예 기간</strong></td><td>구독 종료 후 N일</td><td>읽기 전용</td><td>다운로드 가능</td></tr>
<tr><td><strong>아카이브</strong></td><td>유예 종료 후</td><td>Cold Storage 이동</td><td>재구독 시 복원</td></tr>
<tr><td><strong>삭제 대기</strong></td><td>아카이브 후 6~12개월</td><td>삭제 예정</td><td>로그인 시 기간 리셋</td></tr>
<tr><td><strong>완전 삭제</strong></td><td>삭제 대기 종료</td><td>영구 삭제</td><td>복구 불가</td></tr>
</tbody></table>
<h3>3.4 플랜 등급 하락 시</h3>
<table>
<thead><tr><th>상황</th><th>처리</th></tr></thead>
<tbody>
<tr><td>Enterprise → Studio</td><td>초과 슬롯 데이터 아카이브</td></tr>
<tr><td>Studio → Pro</td><td>초과 슬롯 데이터 아카이브</td></tr>
<tr><td>Pro → 무료</td><td>클라우드 데이터 아카이브, 로컬 다운로드 유도</td></tr>
</tbody></table>
<hr>
<h2 id="4-서버멀티-세션-생명주기">4. 서버/멀티 세션 생명주기</h2>
<blockquote><strong>용어 정리:</strong> 내부적으로는 "세션(Session)"이라는 기술 용어를 사용하지만, 사용자에게는 "월드"와 "호스트"라는 용어로 노출된다. 이 문서에서는 기술 구현 관점에서 "세션"을 사용한다.</blockquote>
<h3>4.1 세션 생성 및 호스트</h3>
<table>
<thead><tr><th>항목</th><th>정책</th></tr></thead>
<tbody>
<tr><td><strong>세션 생성 주체</strong></td><td>유료 플랜(Pro/Studio/Enterprise) 사용자만 생성 가능</td></tr>
<tr><td><strong>호스트 (세션 소유자)</strong></td><td>세션을 생성한 사용자. UI에서 👑 왕관 아이콘으로 표시</td></tr>
<tr><td><strong>동시 세션 제한</strong></td><td>Pro: 1개, Studio: 3개, Enterprise: 10개+</td></tr>
</tbody></table>
<h3>4.2 세션 유지 조건</h3>
<p>세션은 <strong>유료 플랜 사용자가 최소 1명 이상 접속</strong> 중일 때만 유지된다.</p>
<table>
<thead><tr><th>조건</th><th>세션 상태</th></tr></thead>
<tbody>
<tr><td>유료 플랜 사용자 1명 이상 접속</td><td>✅ 정상 유지</td></tr>
<tr><td>Free 사용자만 남음</td><td>⚠️ "0명" 취급 → 10분 유예 시작</td></tr>
<tr><td>접속 인원 0명</td><td>⚠️ 10분 유예 시작</td></tr>
</tbody></table>
<p><strong>핵심 원칙:</strong></p>
<ul>
<li>Free 사용자는 세션 유지 인원으로 <strong>카운트되지 않음</strong></li>
<li>Free 사용자만 남은 세션 = 실질적으로 "빈 세션"으로 취급</li>
<li>10분 유예 기간 내 유료 사용자 재접속 시 세션 유지</li>
</ul>
<h3>4.3 호스트 퇴장 시 처리</h3>
<p>호스트가 퇴장(팅김/나감)할 때의 처리 규칙:</p>
<table>
<thead><tr><th>상황</th><th>처리</th></tr></thead>
<tbody>
<tr><td>호스트 퇴장 + 다른 유료 사용자 있음</td><td><strong>즉시 이전하지 않음</strong> → 10분 유예 시작</td></tr>
<tr><td>호스트 퇴장 + Free 사용자만 남음</td><td>10분 유예 후 세션 파기</td></tr>
<tr><td>호스트 퇴장 + 아무도 없음</td><td>10분 유예 후 세션 파기</td></tr>
</tbody></table>
<p><strong>호스트 퇴장 후 유예 기간 (10분):</strong></p>
<ul>
<li>호스트가 재접속하면 그대로 호스트 유지</li>
<li>유예 기간 종료 시 남은 유료 사용자에게 호스트 자동 이전</li>
<li>Free 사용자만 남은 경우 세션 파기</li>
</ul>
<h3>4.4 호스트 이전 정책</h3>
<h4>4.4.1 자동 이전 (유예 기간 종료 시)</h4>
<p>호스트가 10분 유예 기간 내 복귀하지 않으면, 남은 유료 사용자 중 한 명에게 자동 이전된다.</p>
<p><strong>이전 대상 선정 우선순위:</strong> 1. 동시 세션에 여유가 있는 사용자 (현재 호스트 중인 세션 수 < 플랜 제한) 2. 더 높은 플랜 (Enterprise > Studio > Pro) 3. 접속 시간이 가장 오래된 사용자</p>
<p><strong>이전 불가 시:</strong></p>
<ul>
<li>모든 유료 사용자가 동시 세션 제한에 걸린 경우 → 세션 파기</li>
</ul>
<h4>4.4.2 강제 이전 (호스트가 새 월드 생성 시)</h4>
<p>호스트가 유예 기간 중 새 월드를 열려고 할 때:</p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>"월드 열기" 시도</td></tr>
<tr><td>2</td><td>동시 세션 제한 확인 → 기존 세션 존재</td></tr>
<tr><td>3</td><td>"기존 월드 닫기" 확인 팝업</td></tr>
<tr><td>4</td><td>확인 시: 남은 유료 사용자에게 호스트 이전 후 새 세션 생성</td></tr>
</tbody></table>
<p><strong>핵심:</strong> 호스트 입장에서는 "월드 닫기"지만, 실제로는 남은 유료 사용자에게 호스트가 이전되는 동작이다.</p>
<h3>4.5 호스트 표시 (UI)</h3>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>왕관 아이콘 👑</strong></td><td>플레이어 목록에서 호스트 옆에 표시</td></tr>
<tr><td><strong>실시간 반영</strong></td><td>호스트 이전 시 왕관도 즉시 이동</td></tr>
<tr><td><strong>이전 알림</strong></td><td>"호스트가 변경되었습니다" 토스트 메시지</td></tr>
</tbody></table>
<h3>4.6 세션 파기 조건</h3>
<table>
<thead><tr><th>조건</th><th>유예 기간</th><th>결과</th></tr></thead>
<tbody>
<tr><td>유료 사용자 0명 (실질적 0명)</td><td>10분</td><td>세션 파기</td></tr>
<tr><td>물리적 접속 인원 0명</td><td>10분</td><td>세션 파기</td></tr>
<tr><td>호스트가 월드 닫기 (이전 대상 없음)</td><td>즉시</td><td>세션 파기</td></tr>
<tr><td>호스트가 월드 닫기 (이전 대상 있음)</td><td>즉시</td><td>호스트 이전 후 세션 유지</td></tr>
</tbody></table>
<p><strong>유예 기간 동작:</strong></p>
<ul>
<li>10분 카운트다운 시작</li>
<li>유예 기간 내 유료 사용자 재접속 시 카운트다운 리셋</li>
<li>Free 사용자 접속은 카운트다운에 영향 없음</li>
<li>10분 경과 시 세션 자동 파기 또는 호스트 이전</li>
</ul>
<h3>4.7 세션 관리 UI</h3>
<blockquote><strong>참고:</strong> 세션 관리 UI 구성은 현재 검토 중이다. 상세 내용은 UI 기획 참조.</blockquote>
<h3>4.8 세션 메타데이터</h3>
<p>세션 종료 후에도 보존되는 데이터:</p>
<table>
<thead><tr><th>데이터</th><th>저장 방식</th><th>설명</th></tr></thead>
<tbody>
<tr><td>룸 설정</td><td>계정 데이터</td><td>방 생성 시 재사용 가능</td></tr>
<tr><td>권한 설정</td><td>계정 데이터</td><td>매니저 권한 등</td></tr>
<tr><td>프리셋</td><td>계정 데이터</td><td>카메라, 조명 프리셋</td></tr>
</tbody></table>
<hr>
<h2 id="5-데이터-삭제-후-서버-보관-기간">5. 데이터 삭제 후 서버 보관 기간</h2>
<table>
<thead><tr><th>데이터 유형</th><th>삭제 요청 후 보관</th><th>비고</th></tr></thead>
<tbody>
<tr><td>실시간 세션 데이터</td><td>종료 즉시 파기</td><td>-</td></tr>
<tr><td>로그성 데이터</td><td>최대 90일</td><td>디버깅/분석 후 파기</td></tr>
<tr><td>유저 자산 데이터</td><td>N일 보관 후 파기</td><td>복구 요청 대비</td></tr>
<tr><td>법적/보안 로그</td><td>법적 요구 범위 내</td><td>결제, 보안 이벤트</td></tr>
</tbody></table>
<hr>
<h2 id="6-설계-시-고려사항">6. 설계 시 고려사항</h2>
<h3>6.1 비용 최적화</h3>
<table>
<thead><tr><th>전략</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>Cold Storage 활용</strong></td><td>아카이브 데이터는 저비용 스토리지로 이동</td></tr>
<tr><td><strong>개수 기반 제한</strong></td><td>용량(GB)이 아닌 개수로 관리하여 예측 가능성 확보</td></tr>
<tr><td><strong>자동 정리</strong></td><td>비활성 계정 데이터 자동 아카이브/삭제</td></tr>
</tbody></table>
<h3>6.2 사용자 경험</h3>
<table>
<thead><tr><th>원칙</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>데이터 손실 방지</strong></td><td>구독 종료 시 즉시 삭제 금지</td></tr>
<tr><td><strong>충분한 유예 기간</strong></td><td>다운로드 및 백업 시간 제공</td></tr>
<tr><td><strong>명확한 안내</strong></td><td>삭제 예정 시 사전 알림</td></tr>
</tbody></table>
<h3>6.3 벤치마킹 대상</h3>
<table>
<thead><tr><th>서비스</th><th>참고 정책</th></tr></thead>
<tbody>
<tr><td>Google Drive</td><td>구독 종료 후 데이터 보관 정책</td></tr>
<tr><td>Dropbox</td><td>계정 비활성 시 처리 정책</td></tr>
<tr><td>Adobe Creative Cloud</td><td>플랜 다운그레이드 시 파일 처리</td></tr>
</tbody></table>
<hr>
<h2 id="7-엣지-케이스-및-예외-처리">7. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>구독 종료 직전 대용량 업로드</td><td>유예 기간 내 다운로드 안내</td></tr>
<tr><td>아카이브 중 재구독</td><td>데이터 즉시 복원</td></tr>
<tr><td>삭제 대기 중 로그인</td><td>삭제 기간 리셋 (아카이브 기간은 유지)</td></tr>
<tr><td>법적 요청으로 데이터 보존 필요</td><td>삭제 일시 중지, 법적 절차 따름</td></tr>
<tr><td>사용자 명시적 삭제 요청</td><td>즉시 접근 차단, 유예 후 완전 삭제</td></tr>
</tbody></table>
<hr>
<h2 id="8-미결정-쟁점">8. 미결정 쟁점</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>유예 기간 구체적 일수</td><td>📋 논의 필요</td><td>7일? 14일? 30일?</td></tr>
<tr><td>아카이브 후 삭제까지 기간</td><td>📋 논의 필요</td><td>6개월? 12개월?</td></tr>
<tr><td>0명 세션 유지 시간</td><td>✅ 결정됨</td><td>10분 유예 후 파기</td></tr>
<tr><td>호스트 퇴장 후 유예 시간</td><td>✅ 결정됨</td><td>10분 유예 후 호스트 이전 또는 파기</td></tr>
<tr><td>Cold Storage 구현 방식</td><td>📋 논의 필요</td><td>Firebase 외 옵션 검토</td></tr>
</tbody></table>
<hr>
<h2 id="9-향후-확장-가능성">9. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>자동 아카이브 시스템</strong></td><td>비활성 데이터 자동 이동</td><td>높음</td></tr>
<tr><td><strong>데이터 내보내기</strong></td><td>사용자 요청 시 전체 데이터 다운로드</td><td>중간</td></tr>
<tr><td><strong>삭제 알림 시스템</strong></td><td>삭제 예정 사전 이메일 알림</td><td>중간</td></tr>
<tr><td><strong>데이터 복원 UI</strong></td><td>아카이브 데이터 셀프 복원</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>라이선스 체계</li>
<li>계정 시스템</li>
<li>보안 시스템</li>
<li>리스크 관리</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_05_Risk_Management">
            <div class="section-header">
                <h2>🔒 리스크 관리</h2>
            </div>
            <h1>리스크 관리</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY 서비스 운영 시 막아야 할 위험(Risk)을 식별하고, 각 위험에 대한 대응 방안을 정의한다. 비용, 악용, 네트워크 품질, 신뢰 관련 리스크를 체계적으로 관리하여 서비스 안정성과 수익성을 확보한다.</p>
<hr>
<h2 id="2-리스크-분류">2. 리스크 분류</h2>
<table>
<thead><tr><th>분류</th><th>리스크 번호</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>비용 관련</strong></td><td>R1, R5</td><td>서버/스토리지 비용 폭주</td></tr>
<tr><td><strong>악용 관련</strong></td><td>R2, R3, R9</td><td>무료/저책임 계정의 시스템 악용</td></tr>
<tr><td><strong>UX 관련</strong></td><td>R4</td><td>정상 사용자 피해</td></tr>
<tr><td><strong>네트워크 품질</strong></td><td>R6, R7, R8, R11</td><td>동기화 품질 저하</td></tr>
<tr><td><strong>운영 관련</strong></td><td>R10</td><td>책임 소재 불명확</td></tr>
</tbody></table>
<hr>
<h2 id="3-리스크-상세">3. 리스크 상세</h2>
<h3>R1. 방 생성 남발로 인한 서버 및 네트워크 비용 폭주</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>방 생성/종료가 잦을 경우 Photon 및 서버 비용이 예측 불가능해짐</td></tr>
<tr><td><strong>시나리오</strong></td><td>"방 생성 후 이탈"을 반복하는 패턴 악용</td></tr>
<tr><td><strong>영향</strong></td><td>실제 사용 인원 대비 과도한 리소스 사용</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>플랜별 동시 방 생성 수 제한 (무료: 0, Pro: 1, Studio: 3, Enterprise: 10+)</li>
<li>방 생성 후 최소 유지 시간 설정 검토</li>
</ul>
<blockquote>상세 비용 시나리오 및 Worst Case 분석은 비용 분석 참조</blockquote>
<hr>
<h3>R2. 방 파주기(생성 후 이탈) 악용</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>방을 생성한 뒤 다른 사용자를 위해 남겨두고 이탈하는 행위 반복</td></tr>
<tr><td><strong>시나리오</strong></td><td>사실상 무제한 방 생성 효과 발생</td></tr>
<tr><td><strong>영향</strong></td><td>방 생성 제한이 무력화됨</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>✅ <strong>호스트 유예 정책</strong>: 호스트 퇴장 시 즉시 이전하지 않고 10분 유예</li>
<li>✅ <strong>재접속 우선</strong>: 유예 기간 내 호스트 복귀 시 그대로 호스트 유지</li>
<li>✅ <strong>호스트 이전 조건</strong>: 유예 종료 시 + 다른 유료 사용자가 있을 때만 호스트 자동 이전</li>
<li>✅ <strong>Free 사용자 "0명" 취급</strong>: Free 사용자만 남으면 10분 유예 후 월드 자동 종료</li>
<li>✅ <strong>새 월드 열기 시 이전</strong>: 호스트가 새 월드를 열면 기존 월드의 호스트가 남은 유저에게 이전</li>
<li>결론: 호스트 유예 정책 + 동시 월드 제한으로 악용 방지 및 재접속 편의성 확보</li>
</ul>
<hr>
<h3>R3. 무료/저책임 계정의 운영 기능 악용</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>비용·운영 책임을 지지 않는 계정이 운영 기능을 사용</td></tr>
<tr><td><strong>시나리오</strong></td><td>무료 계정이 방 생성 또는 운영 기능 악용</td></tr>
<tr><td><strong>영향</strong></td><td>시스템 악용, 품질 저하, 유료/무료 플랜 간 책임 구조 붕괴</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>Free 유저는 방생성이 불가능하기에 해당 이슈에서 제외</li>
<li>Session에 함께 있는 유저들은 상호간 신뢰를 바탕으로 함께 접속된 유저들, 그들간의 악용에 대한 이슈는 크게 없을 것으로 판단됨.</li>
<li>하지만 Session의 코드를 뚫고 들어오는 유저가 있을 수 있음. 코드 수 4자리 -> 더 늘리는 것 고려</li>
</ul>
<hr>
<h3>R4. 동시 방 제한으로 인한 정상 사용자 피해</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>이미 이탈한 방에 다른 사용자가 남아있어 새 방 생성이 제한됨</td></tr>
<tr><td><strong>시나리오</strong></td><td>개인 사용과 운영 목적 사용 구분 없이 제한 적용</td></tr>
<tr><td><strong>영향</strong></td><td>정상 사용자 불만 증가</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>✅ <strong>호스트 유예 정책</strong>: 퇴장 시 즉시 이전되지 않으므로, 재접속 시 월드 코드 없이 복귀 가능</li>
<li>✅ <strong>새 월드 열기 시 자동 이전</strong>: 기존 월드 닫기 → 남은 유저에게 호스트 이전 (모두 퇴장 X)</li>
<li>✅ <strong>0명 월드 자동 종료</strong>: 유료 사용자 0명 시 10분 유예 후 자동 종료</li>
<li>✅ <strong>플레이어 목록에 호스트 표시</strong>: 👑 왕관으로 현재 호스트 명확히 표시</li>
<li>📋 <strong>활성 월드 리스트 (검토 중)</strong>: 내 월드/친구 월드 관리 UI (UX 협의 필요)</li>
<li>결론: 호스트 유예 + 자동 이전 정책으로 재접속 편의성 확보, 불만 최소화</li>
</ul>
<hr>
<h3>R5. 구독 종료 후 데이터(월드/아바타) 비용 누적</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>구독 종료된 계정의 데이터가 장기 보관되어 비용 유발</td></tr>
<tr><td><strong>시나리오</strong></td><td>비활성 계정이 지속적인 스토리지 비용 발생</td></tr>
<tr><td><strong>영향</strong></td><td>정리 기준 없을 경우 비용 누적</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>데이터 생명주기 관리 정책 수립 (→ 데이터 생명주기 참조)</li>
<li>아카이브/Frozen 개념 도입</li>
<li>6~12개월 장기 미복귀 시 삭제</li>
</ul>
<hr>
<h3>R6. 네트워크 품질 미달로 인한 세션 성립 실패</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>특정 리전 또는 사용자 환경에서 RTT, 패킷 손실, 지터가 기준 이하</td></tr>
<tr><td><strong>시나리오</strong></td><td>멀티 세션이 불안정하거나 빈번히 끊김</td></tr>
<tr><td><strong>영향</strong></td><td>Live Sync조차 유지되지 않는 환경은 서비스 실패로 이어짐</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>네트워크 품질 측정 및 사전 경고 시스템</li>
<li>최소 품질 요구사항 명시 및 안내</li>
<li>리전 선택 옵션 제공 검토</li>
</ul>
<hr>
<h3>R7. Ultra Sync 유지 실패로 인한 Enterprise 신뢰 하락</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>Enterprise 플랜에서 Ultra Sync 선택 후 네트워크 조건 문제로 유지 불가</td></tr>
<tr><td><strong>시나리오</strong></td><td>고가 플랜 구매 후 약속된 품질 제공 실패</td></tr>
<tr><td><strong>영향</strong></td><td>"비싸게 팔고 안 된다"는 인식 형성</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>Ultra → Live 자동 전환 및 안내 시스템</li>
<li>사전 네트워크 테스트 도구 제공</li>
<li>적절한 보상 구조 검토 (크레딧, 환불 정책)</li>
</ul>
<hr>
<h3>R8. 세션 Sync Mode 혼선으로 인한 품질 불일치</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>Ultra / Live Sync가 명확한 세션 상태로 관리되지 않음</td></tr>
<tr><td><strong>시나리오</strong></td><td>참여자마다 서로 다른 동기화 방식이 섞임</td></tr>
<tr><td><strong>영향</strong></td><td>디버깅 불가, 품질 불균형, 사용자 불만</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>세션 생성 시 Sync Mode 명시적 설정</li>
<li>세션 참가 시 모드 확인 및 동의</li>
<li>모드 불일치 시 참가 거부 또는 경고</li>
</ul>
<hr>
<h3>R9. 클라이언트 분기 기반 Sync Mode 악용 가능성</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>Photon Shared 구조상 서버가 클라이언트 송신 데이터를 완전히 검증할 수 없음</td></tr>
<tr><td><strong>시나리오</strong></td><td>악의적 클라이언트가 Live 세션에서 Ultra 수준 패킷 송신, 비정상 고빈도 데이터 전송</td></tr>
<tr><td><strong>영향</strong></td><td>리소스 낭비 및 품질 교란</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>클라이언트 측 데이터 전송 빈도 제한</li>
<li>비정상 패턴 감지 및 경고</li>
<li>심각한 악용 시 세션에서 퇴장 처리</li>
</ul>
<hr>
<h3>R10. Sync Mode 결정 주체 불명확으로 인한 책임 붕괴</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>Ultra / Live Sync 전환 권한이 명확히 정의되지 않음</td></tr>
<tr><td><strong>시나리오</strong></td><td>임의 전환, 사용자 간 분쟁, CS 대응 혼선</td></tr>
<tr><td><strong>영향</strong></td><td>"누가 결정했는가"가 불명확해 운영 책임 붕괴</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>Sync Mode 결정 권한 명확화 (방장/세션 소유자)</li>
<li>변경 이력 로깅</li>
<li>변경 시 참여자 알림</li>
</ul>
<hr>
<h3>R11. 멀티 동기화 품질 저하로 인한 서비스 평판 악화</h3>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>위험</strong></td><td>글로벌 환경에서 멀티 품질 이슈가 반복됨</td></tr>
<tr><td><strong>시나리오</strong></td><td>"VIRDY는 멀티가 불안정하다"는 인식 고착</td></tr>
<tr><td><strong>영향</strong></td><td>실제 원인이 네트워크/환경이더라도 브랜드 신뢰에 직접적 타격</td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>품질 모니터링 대시보드 구축</li>
<li>문제 발생 시 원인 명확화 (VIRDY vs 네트워크 환경)</li>
<li>사용자 교육 및 가이드 제공</li>
<li>최소 요구사항 명시</li>
</ul>
<hr>
<h2 id="4-리스크-우선순위">4. 리스크 우선순위</h2>
<table>
<thead><tr><th>우선순위</th><th>리스크</th><th>이유</th></tr></thead>
<tbody>
<tr><td><strong>높음</strong></td><td>R1, R5</td><td>직접적인 비용 영향</td></tr>
<tr><td><strong>높음</strong></td><td>R7, R11</td><td>브랜드 신뢰 및 Enterprise 고객 이탈</td></tr>
<tr><td><strong>중간</strong></td><td>R2, R3, R4</td><td>악용 방지 및 UX</td></tr>
<tr><td><strong>중간</strong></td><td>R6, R8</td><td>서비스 품질</td></tr>
<tr><td><strong>낮음</strong></td><td>R9, R10</td><td>운영 복잡도</td></tr>
</tbody></table>
<hr>
<h2 id="5-설계-시-고려사항">5. 설계 시 고려사항</h2>
<h3>5.1 비용 관점</h3>
<ul>
<li>비용 산정은 항상 <strong>Worst Case</strong> 기준</li>
<li>주요 비용 요소: Photon 서버, 다운로드 트래픽, 스토리지</li>
<li>다운로드 트래픽이 가장 큰 비용 요소</li>
</ul>
<h3>5.2 악용 방지 관점</h3>
<ul>
<li>기능 제한은 클라이언트 + 서버 양쪽에서 검증</li>
<li>로깅 및 모니터링으로 비정상 패턴 감지</li>
<li>점진적 제재 (경고 → 기능 제한 → 계정 정지)</li>
</ul>
<h3>5.3 사용자 경험 관점</h3>
<ul>
<li>정상 사용자가 피해받지 않도록 제한 설계</li>
<li>명확한 안내 및 업그레이드 유도</li>
<li>제한에 걸렸을 때 해결 방법 제공</li>
</ul>
<hr>
<h2 id="6-미결정-쟁점">6. 미결정 쟁점</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>방 생성 후 최소 유지 시간</td><td>📋 논의 필요</td><td>-</td></tr>
<tr><td>0명 월드 자동 종료 시간</td><td>✅ 결정됨</td><td>10분 유예 후 종료</td></tr>
<tr><td>호스트 퇴장 후 유예 시간</td><td>✅ 결정됨</td><td>10분 유예 후 이전 또는 종료</td></tr>
<tr><td>Ultra Sync 실패 시 보상 정책</td><td>📋 논의 필요</td><td>-</td></tr>
<tr><td>비정상 클라이언트 감지 기준</td><td>📋 논의 필요</td><td>-</td></tr>
<tr><td>활성 월드 리스트 UI</td><td>📋 UX 협의 필요</td><td>유수진님과 논의 필요</td></tr>
</tbody></table>
<hr>
<h2 id="7-향후-확장-가능성">7. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>실시간 모니터링 대시보드</strong></td><td>비용/품질 실시간 추적</td><td>높음</td></tr>
<tr><td><strong>자동 제재 시스템</strong></td><td>비정상 패턴 자동 감지 및 조치</td><td>중간</td></tr>
<tr><td><strong>네트워크 품질 테스트 도구</strong></td><td>사전 환경 검증</td><td>중간</td></tr>
<tr><td><strong>리스크 리포트 자동화</strong></td><td>주간/월간 리스크 현황 리포트</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>라이선스 체계</li>
<li>데이터 생명주기</li>
<li>계정 시스템</li>
<li>네트워크 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_06_Account_System">
            <div class="section-header">
                <h2>🔒 계정 시스템</h2>
            </div>
            <h1>계정 시스템</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY의 계정 생성, 인증, 연동, 삭제에 대한 정책을 정의한다. Steam을 포함한 외부 인증 수단과 VIRDY 내부 계정의 관계, 계정 생명주기, 데이터 귀속 정책을 명확히 한다.</p>
<blockquote>🚧 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에 따라 인증 흐름이 변경될 수 있다. 전환 검토 내용은 본 문서 2.5절 참조.</blockquote>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 계정 구조</h3>
<p>VIRDY는 <strong>내부 계정</strong>과 <strong>외부 인증 수단</strong>을 분리하여 관리한다.</p>
<table>
<thead><tr><th>구분</th><th>역할</th><th>예시</th></tr></thead>
<tbody>
<tr><td><strong>VIRDY 계정</strong></td><td>서비스 데이터의 소유 주체</td><td>아바타, 월드, 설정, 친구 목록</td></tr>
<tr><td><strong>외부 인증 수단</strong></td><td>로그인 방법</td><td>Steam, 이메일/비밀번호, (향후) Google</td></tr>
</tbody></table>
<p><strong>핵심 원칙:</strong></p>
<ul>
<li>외부 계정은 <strong>인증 수단일 뿐</strong>, 서비스 데이터의 소유는 VIRDY 계정에 귀속</li>
<li>Steam 연동 해제, 로그인 불가 상황에서도 VIRDY 계정으로 데이터 복구 가능</li>
</ul>
<h3>2.2 Steam 연동</h3>
<h4>최초 접속 시 자동 계정 생성</h4>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Steam으로 VIRDY 최초 실행</td></tr>
<tr><td>2</td><td>Steam ID 확인</td></tr>
<tr><td>3</td><td>VIRDY 계정 자동 생성</td></tr>
<tr><td>4</td><td>저장 데이터: Steam ID, 생성 시각, 접속 지역(국가)</td></tr>
</tbody></table>
<h4>저장해야 하는 데이터</h4>
<p>계정 복구 및 분쟁 해결을 위해 다음 데이터를 저장한다:</p>
<table>
<thead><tr><th>데이터</th><th>용도</th></tr></thead>
<tbody>
<tr><td>최초 생성 시 Steam ID</td><td>계정 소유권 확인</td></tr>
<tr><td>최초 생성 시각</td><td>계정 생성 시점 증명</td></tr>
<tr><td>최초 접속 지역(국가)</td><td>분쟁 시 참고 자료</td></tr>
</tbody></table>
<h4>Steam 연동 해제 시</h4>
<table>
<thead><tr><th>상황</th><th>처리</th></tr></thead>
<tbody>
<tr><td>연동 해제 요청</td><td>VIRDY 계정은 유지, Steam 연동만 해제</td></tr>
<tr><td>연동 끊긴 계정</td><td>삭제 대상 아님, 복구 가능 상태 유지</td></tr>
<tr><td>재연동</td><td>동일 Steam ID로 재연동 가능</td></tr>
</tbody></table>
<h3>2.3 이메일 연동</h3>
<h4>유료 결제 시 이메일 필수</h4>
<table>
<thead><tr><th>상황</th><th>이메일 연동</th></tr></thead>
<tbody>
<tr><td>무료 사용 (Steam만)</td><td>선택</td></tr>
<tr><td>유료 결제/구독</td><td><strong>필수</strong></td></tr>
</tbody></table>
<p><strong>이유:</strong></p>
<ul>
<li>결제 영수증 발송</li>
<li>구독 상태 알림</li>
<li>계정 복구 수단 확보</li>
<li>법적 커뮤니케이션 채널</li>
</ul>
<h3>2.4 인증 방식 우선순위</h3>
<table>
<thead><tr><th>우선순위</th><th>인증 방식</th><th>상태</th></tr></thead>
<tbody>
<tr><td>1</td><td>Steam 로그인</td><td>✅ 지원 예정</td></tr>
<tr><td>2</td><td>이메일/비밀번호</td><td>✅ 현재 지원</td></tr>
<tr><td>3</td><td>Google OAuth</td><td>📋 계획</td></tr>
</tbody></table>
<h3>2.5 인증 흐름 전환 검토 (서버 개발자 회의 기반)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시 인증 흐름이 다음과 같이 변경될 수 있다.</p>
<h4>전환 후 인증 흐름 (검토 중)</h4>
<p>Steam → Firebase Auth → Backend JWT 방식으로 3단계 인증을 거치는 구조이다.</p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Steam SDK로 로그인하여 Steam Token 획득</td></tr>
<tr><td>2</td><td>Firebase Auth에 Custom Token 요청 → Firebase Token 수신</td></tr>
<tr><td>3</td><td>Backend `/api/v1/auth/login`에 Firebase Token 전달</td></tr>
<tr><td>4</td><td>Backend에서 Firebase Token 검증 후 JWT (Access + Refresh) 발급</td></tr>
<tr><td>5</td><td>신규 사용자인 경우: VIRDY Account 자동 생성 + Default Tenant 생성 + Owner 권한 부여</td></tr>
</tbody></table>
<h4>전환 후 토큰 관리 (검토 중)</h4>
<table>
<thead><tr><th>토큰</th><th>만료</th><th>용도</th><th>저장 위치</th></tr></thead>
<tbody>
<tr><td>Access Token</td><td>1시간</td><td>API 호출 인증 (Authorization: Bearer)</td><td>메모리 (Unity)</td></tr>
<tr><td>Refresh Token</td><td>7~30일 (미확정)</td><td>Access Token 갱신</td><td>로컬 안전 저장소</td></tr>
</tbody></table>
<h4>전환 후 계정 복구 흐름 (검토 중)</h4>
<p>유료 구독자는 구독 전환 시 이메일 인증이 필수이므로, Steam 계정 분실 시에도 이메일 본인인증을 통해 새 Steam 계정을 연동하여 구독을 복구할 수 있다.</p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>Steam 계정 분실 발생</td></tr>
<tr><td>2</td><td>VIRDY 복구 페이지에서 복구 요청</td></tr>
<tr><td>3</td><td>등록된 이메일로 본인인증</td></tr>
<tr><td>4</td><td>새 Steam 계정과 기존 VIRDY Account 연동</td></tr>
<tr><td>5</td><td>구독 및 데이터 복구 완료</td></tr>
</tbody></table>
<h4>전환 후 Tenant 개념 도입 (검토 중)</h4>
<table>
<thead><tr><th>개념</th><th>정의</th></tr></thead>
<tbody>
<tr><td>VIRDY Account</td><td>VIRDY 내부 계정 (사용자에게 비노출)</td></tr>
<tr><td>Tenant</td><td>사용자/조직의 논리적 작업 공간</td></tr>
<tr><td>Display Name</td><td>사용자가 설정하는 표시 이름 (닉네임)</td></tr>
</tbody></table>
<p>신규 사용자 생성 시 자동으로 Default Tenant가 생성되며, 모든 에셋과 설정은 Tenant 단위로 격리된다. 향후 기업 사용자가 여러 Tenant에 소속될 수 있도록 Tenant 전환 기능을 검토 중이다.</p>
<hr>
<h2 id="3-계정-생명주기">3. 계정 생명주기</h2>
<h3>3.1 생성 시점</h3>
<table>
<thead><tr><th>방법</th><th>동작</th></tr></thead>
<tbody>
<tr><td>Steam 첫 로그인</td><td>VIRDY 계정 자동 생성</td></tr>
<tr><td>이메일 회원가입</td><td>이메일 인증 후 계정 생성</td></tr>
</tbody></table>
<h3>3.2 활성 상태</h3>
<p>정상적으로 로그인하여 서비스를 사용하는 상태.</p>
<h3>3.3 비활성 시점</h3>
<table>
<thead><tr><th>조건</th><th>상태</th></tr></thead>
<tbody>
<tr><td>로그인 수단 전부 끊김</td><td>비활성 (복구 대기)</td></tr>
<tr><td>장기 미접속</td><td>비활성 (데이터 생명주기 정책 적용)</td></tr>
</tbody></table>
<h3>3.4 완전 삭제 시점</h3>
<table>
<thead><tr><th>조건</th><th>처리</th></tr></thead>
<tbody>
<tr><td>유저 명시적 삭제 요청</td><td>즉시 접근 차단, 유예 기간 후 삭제</td></tr>
<tr><td>장기 미접속 + 구독 종료</td><td>데이터 생명주기 정책에 따라 삭제</td></tr>
</tbody></table>
<p><strong>삭제 정책:</strong></p>
<ul>
<li>즉시 삭제 ❌ → 일정 기간 유예 후 삭제</li>
<li>유예 기간 내 로그인 시 삭제 취소 가능</li>
<li>법적/보안 로그는 별도 보관</li>
</ul>
<hr>
<h2 id="4-외부-연동-생명주기">4. 외부 연동 생명주기</h2>
<h3>4.1 핵심 원칙</h3>
<ul>
<li>외부 계정(Steam 등)은 <strong>인증 수단일 뿐</strong></li>
<li>서비스 데이터의 소유는 <strong>VIRDY 계정</strong>에 귀속</li>
<li>연동 해제/재연동에도 데이터는 VIRDY 계정에 유지</li>
</ul>
<h3>4.2 연동 상태 변화</h3>
<table>
<thead><tr><th>상태</th><th>설명</th><th>데이터 영향</th></tr></thead>
<tbody>
<tr><td>연동</td><td>외부 계정으로 로그인 가능</td><td>없음</td></tr>
<tr><td>연동 해제</td><td>해당 방법으로 로그인 불가</td><td>없음 (데이터 유지)</td></tr>
<tr><td>재연동</td><td>동일 계정으로 다시 연동</td><td>없음 (데이터 복구)</td></tr>
</tbody></table>
<h3>4.3 복구 시나리오</h3>
<table>
<thead><tr><th>시나리오</th><th>복구 방법</th></tr></thead>
<tbody>
<tr><td>Steam 계정 분실</td><td>이메일/비밀번호로 로그인 → Steam 재연동</td></tr>
<tr><td>이메일 분실</td><td>Steam으로 로그인 → 이메일 변경</td></tr>
<tr><td>모든 연동 끊김</td><td>CS 문의 → 본인 확인 후 복구</td></tr>
</tbody></table>
<hr>
<h2 id="5-구독과-계정의-관계">5. 구독과 계정의 관계</h2>
<h3>5.1 구독 시작</h3>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>1</td><td>이메일 연동 확인 (필수)</td></tr>
<tr><td>2</td><td>결제 수단 등록</td></tr>
<tr><td>3</td><td>구독 시작</td></tr>
<tr><td>4</td><td>플랜에 따른 스토리지 할당</td></tr>
</tbody></table>
<h3>5.2 구독 중단</h3>
<table>
<thead><tr><th>단계</th><th>기간</th><th>동작</th></tr></thead>
<tbody>
<tr><td>유예 기간</td><td>N일</td><td>데이터 다운로드 가능 (아바타, 월드)</td></tr>
<tr><td>아카이브</td><td>유예 후</td><td>데이터 Cold Storage 이동</td></tr>
<tr><td>삭제 대기</td><td>6~12개월</td><td>로그인 시 기간 리셋</td></tr>
<tr><td>완전 삭제</td><td>삭제 대기 종료</td><td>복구 불가</td></tr>
</tbody></table>
<blockquote>상세 정책은 데이터 생명주기 참조</blockquote>
<hr>
<h2 id="6-설계-시-고려사항">6. 설계 시 고려사항</h2>
<h3>6.1 계정 복구 용이성</h3>
<table>
<thead><tr><th>원칙</th><th>설명</th></tr></thead>
<tbody>
<tr><td>다중 인증 수단 권장</td><td>Steam + 이메일 연동 권장</td></tr>
<tr><td>복구 정보 저장</td><td>최초 생성 정보로 소유권 확인</td></tr>
<tr><td>CS 복구 프로세스</td><td>본인 확인 절차 정의 필요</td></tr>
</tbody></table>
<h3>6.2 보안 고려사항</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>Steam ID 검증</td><td>Steam Web API로 정품 확인</td></tr>
<tr><td>이메일 인증</td><td>Firebase Auth 이메일 인증 필수</td></tr>
<tr><td>세션 관리</td><td>Firebase Auth 토큰 기반</td></tr>
</tbody></table>
<h3>6.3 법적 요구사항</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>개인정보 보호</td><td>최소한의 개인정보만 수집</td></tr>
<tr><td>계정 삭제권</td><td>사용자 요청 시 삭제 가능</td></tr>
<tr><td>데이터 이동권</td><td>사용자 데이터 내보내기 기능 검토</td></tr>
</tbody></table>
<hr>
<h2 id="7-엣지-케이스-및-예외-처리">7. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>Steam 계정 해킹/도용</td><td>CS 문의 → 본인 확인 → Steam 연동 해제</td></tr>
<tr><td>이메일 접근 불가</td><td>Steam으로 로그인 → 이메일 변경</td></tr>
<tr><td>계정 삭제 후 복구 요청</td><td>유예 기간 내: 복구 가능 / 이후: 불가</td></tr>
<tr><td>Steam VAC Ban</td><td>VIRDY 계정에 영향 없음 (별도 정책 검토)</td></tr>
<tr><td>미성년자 계정</td><td>법적 요구사항에 따라 처리 (추가 검토 필요)</td></tr>
<tr><td>계정 양도 요청</td><td>원칙적으로 불가 (정책 정의 필요)</td></tr>
</tbody></table>
<hr>
<h2 id="8-미결정-쟁점">8. 미결정 쟁점</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Steam 로그인 시 받아올 수 있는 데이터 범위</td><td>📋 확인 필요</td><td>Steam Web API 검토</td></tr>
<tr><td>계정 양도 정책</td><td>📋 논의 필요</td><td>-</td></tr>
<tr><td>미성년자 계정 정책</td><td>📋 논의 필요</td><td>법적 검토 필요</td></tr>
<tr><td>CS 본인 확인 절차</td><td>📋 정의 필요</td><td>-</td></tr>
<tr><td>다중 기기 로그인 정책</td><td>📋 논의 필요</td><td>동시 로그인 허용 vs 기존 세션 만료</td></tr>
<tr><td>Refresh Token 만료 기간</td><td>📋 미확정</td><td>7일 vs 30일</td></tr>
<tr><td>Tenant 전환 기능 범위</td><td>📋 미확정</td><td>개인 사용자는 단일 Tenant, 기업 사용자는 복수</td></tr>
</tbody></table>
<hr>
<h2 id="9-향후-확장-가능성">9. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>Steam 로그인 구현</strong></td><td>Steam Web API 연동</td><td>높음</td></tr>
<tr><td><strong>Google OAuth</strong></td><td>Google 계정 로그인</td><td>중간</td></tr>
<tr><td><strong>2단계 인증</strong></td><td>OTP 또는 인증 앱</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>보안 시스템</li>
<li>라이선스 체계</li>
<li>데이터 생명주기</li>
<li>사용자 역할</li>
</ul>
        </div>
        
        <div class="page-content" id="page-03_Operations_07_Cost_Analysis">
            <div class="section-header">
                <h2>🔒 비용 분석 및 수익성</h2>
            </div>
            <h1>비용 분석 및 수익성</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY의 비용 구조는 <strong>로컬 퍼스트 아키텍처</strong>를 기반으로 설계되어, 전통적인 클라우드 기반 솔루션 대비 <strong>네트워크 전송 비용을 99% 절감</strong>하는 것을 목표로 한다. 이 문서는 실제 운영 시 발생하는 비용을 사용자 플랜별로 분석하고, 수익성과 손익분기점을 산출한다.</p>
<h3>1.1 비용 산출 전제 조건</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>비용 산정 원칙</strong></td><td>최악의 경우(Worst Case)를 기준으로 산정</td></tr>
<tr><td><strong>플랜 구조</strong></td><td>Free / Starter / Pro / Studio / Enterprise (5단계)</td></tr>
<tr><td><strong>가격 정책</strong></td><td>Steam 수수료 30% 반영</td></tr>
<tr><td><strong>환율</strong></td><td>원화 기준 (USD 환산 시 별도 명시)</td></tr>
</tbody></table>
<h3>1.2 비용 구성 요소 개요</h3>
<table>
<thead><tr><th>구성 요소</th><th>역할</th><th>비용 발생 시점</th></tr></thead>
<tbody>
<tr><td><strong>GCP Cloud Run</strong></td><td>Spring Boot API 서버</td><td>항상</td></tr>
<tr><td><strong>PostgreSQL (GCP)</strong></td><td>사용자/세션 데이터</td><td>항상</td></tr>
<tr><td><strong>Cloudflare R2</strong></td><td>아바타/월드 스토리지</td><td>업로드/다운로드 시</td></tr>
<tr><td><strong>Firebase Auth</strong></td><td>사용자 인증</td><td>로그인 시</td></tr>
<tr><td><strong>Photon Fusion</strong></td><td>실시간 네트워크 동기화</td><td>세션(합방) 시</td></tr>
</tbody></table>
<hr>
<h2 id="2-비용-구성-요소-상세">2. 비용 구성 요소 상세</h2>
<h3>2.1 인프라 비용 (GCP/R2/Firebase)</h3>
<h4>GCP Cloud Run (Spring Boot API)</h4>
<table>
<thead><tr><th>항목</th><th>사양</th><th>월 예상 비용</th></tr></thead>
<tbody>
<tr><td>vCPU</td><td>1 core</td><td>~50,000원</td></tr>
<tr><td>Memory</td><td>2GB</td><td>~30,000원</td></tr>
<tr><td>Request</td><td>1M requests/월</td><td>~20,000원</td></tr>
<tr><td><strong>합계</strong></td><td>-</td><td><strong>~100,000원</strong></td></tr>
</tbody></table>
<h4>PostgreSQL (GCP Cloud SQL)</h4>
<table>
<thead><tr><th>항목</th><th>사양</th><th>월 예상 비용</th></tr></thead>
<tbody>
<tr><td>Instance</td><td>db-f1-micro</td><td>~30,000원</td></tr>
<tr><td>Storage</td><td>10GB SSD</td><td>~10,000원</td></tr>
<tr><td><strong>합계</strong></td><td>-</td><td><strong>~40,000원</strong></td></tr>
</tbody></table>
<h4>Cloudflare R2 (S3 호환 스토리지)</h4>
<table>
<thead><tr><th>항목</th><th>단가</th><th>비고</th></tr></thead>
<tbody>
<tr><td>저장 용량</td><td>$0.015/GB/월</td><td>~20원/GB/월</td></tr>
<tr><td>Class A 작업 (업로드)</td><td>$4.50/1M requests</td><td>~6,000원/1M</td></tr>
<tr><td>Class B 작업 (다운로드)</td><td>$0.36/1M requests</td><td>~500원/1M</td></tr>
<tr><td><strong>전송료 (Egress)</strong></td><td><strong>무료</strong></td><td>✅ 핵심 절감 요소</td></tr>
</tbody></table>
<p><strong>사용자별 R2 비용 추정:</strong></p>
<table>
<thead><tr><th>플랜</th><th>저장 용량</th><th>월 비용</th></tr></thead>
<tbody>
<tr><td>Free</td><td>로컬만</td><td>0원</td></tr>
<tr><td>Starter</td><td>5GB</td><td>~100원</td></tr>
<tr><td>Pro</td><td>50GB</td><td>~1,000원</td></tr>
<tr><td>Studio</td><td>200GB</td><td>~4,000원</td></tr>
</tbody></table>
<h4>Firebase Authentication</h4>
<table>
<thead><tr><th>항목</th><th>무료 한도</th><th>초과 시</th></tr></thead>
<tbody>
<tr><td>인증 요청</td><td>50,000/월</td><td>$0.0055/인증</td></tr>
<tr><td><strong>예상 비용</strong></td><td>-</td><td><strong>무료 한도 내</strong></td></tr>
</tbody></table>
<hr>
<h3>2.2 네트워크 비용 (Photon Fusion)</h3>
<p>Photon Fusion은 <strong>CCU(동시 접속자) 기반 요금제</strong>를 사용한다.</p>
<h4>Photon 요금제</h4>
<table>
<thead><tr><th>플랜</th><th>월 비용</th><th>CCU 한도</th><th>초과 시</th></tr></thead>
<tbody>
<tr><td>Free</td><td>$0</td><td>20 CCU</td><td>불가</td></tr>
<tr><td>Photon 100</td><td>$95 (~127,000원)</td><td>100 CCU</td><td>$0.99/CCU</td></tr>
<tr><td>Photon 500</td><td>$355 (~475,000원)</td><td>500 CCU</td><td>$0.75/CCU</td></tr>
</tbody></table>
<h4>트래픽 기반 추가 비용</h4>
<p>세션당 트래픽은 다음과 같이 계산된다:</p>
<pre><code class="">트래픽(GB) = (인원 × Tickrate × 데이터 크기 × 시간) / 1024^3</code></pre>
<p><strong>예시: 6인 풀방, 60Hz, 1시간</strong></p>
<table>
<thead><tr><th>항목</th><th>값</th></tr></thead>
<tbody>
<tr><td>동기화 데이터</td><td>본(22개) + 표정(100개) + 손가락(40개) ≈ 2KB/frame</td></tr>
<tr><td>Tickrate</td><td>60Hz</td></tr>
<tr><td>초당 전송량</td><td>2KB × 60 = 120KB/s</td></tr>
<tr><td>6인 × 1시간</td><td>120KB × 6 × 3600s ≈ <strong>2.5GB</strong></td></tr>
</tbody></table>
<p><strong>월 20시간 합방 시:</strong></p>
<ul>
<li>트래픽: 2.5GB × 20h = <strong>50GB</strong></li>
<li>Photon 초과 요금 (100GB 무료 후): 없음</li>
</ul>
<p><strong>Worst Case (720시간 풀방):</strong></p>
<ul>
<li>트래픽: 2.5GB × 720h = <strong>1,800GB</strong></li>
<li>Photon 초과 요금: <strong>폭주</strong> 🚨</li>
</ul>
<hr>
<h3>2.3 고정 비용 (서버 유지비)</h3>
<table>
<thead><tr><th>항목</th><th>월 비용</th></tr></thead>
<tbody>
<tr><td>GCP Cloud Run</td><td>~100,000원</td></tr>
<tr><td>PostgreSQL</td><td>~40,000원</td></tr>
<tr><td>기타 (모니터링, 백업)</td><td>~10,000원</td></tr>
<tr><td><strong>합계</strong></td><td><strong>~150,000원</strong></td></tr>
</tbody></table>
<hr>
<h2 id="3-사용자별-월간-원가">3. 사용자별 월간 원가</h2>
<h3>3.1 Light User (Starter 플랜)</h3>
<p><strong>사용 패턴:</strong></p>
<ul>
<li>아바타 3개 (5GB 저장)</li>
<li>월드 1개</li>
<li>합방 거의 안 함 (월 2시간 미만)</li>
</ul>
<table>
<thead><tr><th>비용 항목</th><th>금액</th></tr></thead>
<tbody>
<tr><td>R2 저장</td><td>~100원</td></tr>
<tr><td>R2 다운로드</td><td>~20원</td></tr>
<tr><td>Photon (거의 0)</td><td>~5원</td></tr>
<tr><td><strong>총 원가</strong></td><td><strong>~125원</strong></td></tr>
</tbody></table>
<hr>
<h3>3.2 Heavy User (Pro 플랜)</h3>
<p><strong>사용 패턴:</strong></p>
<ul>
<li>아바타 10개 (50GB 저장)</li>
<li>월드 5개</li>
<li>합방 월 20시간 (주 5시간)</li>
<li>6인 풀방 60Hz</li>
</ul>
<table>
<thead><tr><th>비용 항목</th><th>금액</th></tr></thead>
<tbody>
<tr><td>R2 저장</td><td>~1,000원</td></tr>
<tr><td>R2 다운로드</td><td>~100원</td></tr>
<tr><td>Photon 트래픽 (50GB)</td><td>~3,500원</td></tr>
<tr><td><strong>총 원가</strong></td><td><strong>~4,600원</strong></td></tr>
</tbody></table>
<hr>
<h3>3.3 Worst Case 시나리오</h3>
<p><strong>극단적 악용 케이스:</strong></p>
<ul>
<li>24시간 × 30일 = <strong>720시간</strong> 동안 6인 풀방 60Hz 유지</li>
<li>트래픽: 약 <strong>1,800GB</strong> 발생</li>
</ul>
<table>
<thead><tr><th>비용 항목</th><th>금액</th></tr></thead>
<tbody>
<tr><td>R2 저장</td><td>~10,000원</td></tr>
<tr><td>R2 다운로드</td><td>~500원</td></tr>
<tr><td><strong>Photon 트래픽</strong></td><td><strong>~141,500원</strong> 🚨</td></tr>
<tr><td><strong>총 원가</strong></td><td><strong>~152,000원</strong></td></tr>
</tbody></table>
<p><strong>대응 방안:</strong></p>
<ul>
<li>Session Timeout (4시간 자동 종료)</li>
<li>일 10GB 초과 시 알림 및 제한</li>
<li>약관에 비정상 사용 제재 명시</li>
</ul>
<hr>
<h2 id="4-플랜별-수익성-분석">4. 플랜별 수익성 분석</h2>
<h3>4.1 가격 정책 (검토 중)</h3>
<table>
<thead><tr><th>플랜</th><th>월 구독료</th><th>연간 구독료</th><th>Steam 정산 후</th><th>타겟</th></tr></thead>
<tbody>
<tr><td><strong>Free</strong></td><td>0원</td><td>-</td><td>-</td><td>입문자</td></tr>
<tr><td><strong>Starter</strong></td><td>3,900원</td><td>39,000원 (17% 할인)</td><td>~2,730원</td><td>개인 방송</td></tr>
<tr><td><strong>Pro</strong></td><td>14,900원</td><td>149,000원 (17% 할인)</td><td>~10,430원</td><td>고품질 합방</td></tr>
<tr><td><strong>Studio</strong></td><td>📋 미정</td><td>📋 미정</td><td>📋 미정</td><td>프로덕션</td></tr>
<tr><td><strong>Enterprise</strong></td><td>📋 협의</td><td>📋 협의</td><td>📋 협의</td><td>기업</td></tr>
</tbody></table>
<blockquote><strong>주의:</strong> Steam 수수료 30% 적용 기준. VAT 별도.</blockquote>
<hr>
<h3>4.2 Starter 플랜 마진</h3>
<table>
<thead><tr><th>항목</th><th>금액</th></tr></thead>
<tbody>
<tr><td>구독료 (Steam 정산 후)</td><td>2,730원</td></tr>
<tr><td>예상 원가</td><td>-125원</td></tr>
<tr><td><strong>순이익</strong></td><td><strong>2,605원</strong> ✅</td></tr>
<tr><td><strong>마진율</strong></td><td><strong>~95%</strong></td></tr>
</tbody></table>
<hr>
<h3>4.3 Pro 플랜 마진</h3>
<table>
<thead><tr><th>항목</th><th>금액</th></tr></thead>
<tbody>
<tr><td>구독료 (Steam 정산 후)</td><td>10,430원</td></tr>
<tr><td>예상 원가 (월 20h 합방)</td><td>-4,600원</td></tr>
<tr><td><strong>순이익</strong></td><td><strong>5,830원</strong> ✅</td></tr>
<tr><td><strong>마진율</strong></td><td><strong>~56%</strong></td></tr>
</tbody></table>
<hr>
<h3>4.4 Studio/Enterprise 플랜 (검토 중)</h3>
<p>현재 가격 미정. 다음 요소를 고려하여 산정 필요:</p>
<table>
<thead><tr><th>고려 사항</th><th>내용</th></tr></thead>
<tbody>
<tr><td>아바타/월드 슬롯</td><td>대용량 스토리지 비용</td></tr>
<tr><td>동시 세션 수</td><td>3개 이상 동시 방 유지 시 Photon 비용 증가</td></tr>
<tr><td>Ultra Sync 모드</td><td>고품질 동기화로 트래픽 2배 증가 가능</td></tr>
<tr><td>시트(Seat) 기반</td><td>팀원 수에 비례한 비용 구조</td></tr>
</tbody></table>
<hr>
<h2 id="5-손익분기점bep-분석">5. 손익분기점(BEP) 분석</h2>
<h3>5.1 고정비 추정</h3>
<table>
<thead><tr><th>항목</th><th>월 비용</th></tr></thead>
<tbody>
<tr><td>서버 유지비 (GCP + DB)</td><td>~150,000원</td></tr>
<tr><td>인건비</td><td>(별도 산정)</td></tr>
<tr><td>기타 운영비</td><td>~50,000원</td></tr>
<tr><td><strong>합계</strong></td><td><strong>~200,000원</strong></td></tr>
</tbody></table>
<blockquote><strong>주의:</strong> 인건비 제외 시 서버 운영비만 기준</blockquote>
<hr>
<h3>5.2 BEP 달성 조건 (서버 비용 기준)</h3>
<p><strong>목표:</strong> 월 200,000원 고정비 회수</p>
<h4>Case 1: Starter Only</h4>
<pre><code class="">필요 사용자 수 = 200,000원 / 2,605원 ≈ 77명</code></pre>
<h4>Case 2: Pro Only</h4>
<pre><code class="">필요 사용자 수 = 200,000원 / 5,830원 ≈ 35명</code></pre>
<h4>Case 3: Mixed (Starter 70% : Pro 30%)</h4>
<pre><code class="">평균 순이익 = (2,605 × 0.7) + (5,830 × 0.3) = 3,572원
<p>필요 사용자 수 = 200,000원 / 3,572원 ≈ 56명</code></pre></p>
<hr>
<h3>5.3 Photon CCU 고려</h3>
<p>Photon Free 플랜(20 CCU)을 벗어나면:</p>
<table>
<thead><tr><th>Photon 플랜</th><th>월 비용</th><th>필요 BEP</th></tr></thead>
<tbody>
<tr><td>Photon 100</td><td>~127,000원</td><td>+49명 추가</td></tr>
<tr><td>Photon 500</td><td>~475,000원</td><td>+182명 추가</td></tr>
</tbody></table>
<p><strong>결론:</strong> 초기에는 Free 플랜(20 CCU) 내에서 운영하고, 점진적 확장 필요</p>
<hr>
<h2 id="6-비용-방어-체계">6. 비용 방어 체계</h2>
<h3>6.1 5단계 방어 구조</h3>
<h4>1차 방어: Config API 강제 제어</h4>
<table>
<thead><tr><th>플랜</th><th>Tickrate</th><th>Bone 수</th><th>제어 방법</th></tr></thead>
<tbody>
<tr><td>Free</td><td>20Hz</td><td>15개</td><td>서버에서 강제 제한</td></tr>
<tr><td>Starter</td><td>30Hz</td><td>22개</td><td>Config API 응답</td></tr>
<tr><td>Pro</td><td>60Hz</td><td>22개</td><td>Config API 응답</td></tr>
<tr><td>Enterprise</td><td>Ultra 모드</td><td>전체</td><td>별도 계약</td></tr>
</tbody></table>
<p><strong>구현:</strong></p>
<ul>
<li>클라이언트가 세션 시작 시 서버에 Config 요청</li>
<li>서버가 플랜에 따라 동적으로 제한값 응답</li>
<li>클라이언트는 서버 응답값으로만 동작</li>
</ul>
<hr>
<h4>2차 방어: Rate Limiting</h4>
<table>
<thead><tr><th>대상</th><th>제한</th></tr></thead>
<tbody>
<tr><td>아바타 업로드</td><td>5분당 1회</td></tr>
<tr><td>월드 업로드</td><td>10분당 1회</td></tr>
<tr><td>API 요청</td><td>1,000회/분</td></tr>
<tr><td>세션 생성</td><td>플랜별 동시 제한</td></tr>
</tbody></table>
<hr>
<h4>3차 방어: Session Timeout</h4>
<table>
<thead><tr><th>조건</th><th>동작</th></tr></thead>
<tbody>
<tr><td>4시간 유지</td><td>자동 경고</td></tr>
<tr><td>유료 유저 0명</td><td>10분 유예 후 종료</td></tr>
<tr><td>호스트 이탈</td><td>10분 유예 + 자동 이전</td></tr>
</tbody></table>
<hr>
<h4>4차 방어: 트래픽 모니터링</h4>
<table>
<thead><tr><th>조건</th><th>동작</th></tr></thead>
<tbody>
<tr><td>일 10GB 초과</td><td>이메일 알림</td></tr>
<tr><td>월 300GB 초과</td><td>계정 제한 검토</td></tr>
<tr><td>Worst Case 감지</td><td>강제 세션 종료</td></tr>
</tbody></table>
<hr>
<h4>5차 방어: 약관 및 제재</h4>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td>비정상 사용 정의</td><td>24시간 연속 세션, 매크로 의심 패턴</td></tr>
<tr><td>제재 수위</td><td>경고 → 일시 정지 → 영구 정지</td></tr>
<tr><td>환불 정책</td><td>약관 위반 시 환불 불가</td></tr>
</tbody></table>
<hr>
<h3>6.2 기술적 제약 설계</h3>
<table>
<thead><tr><th>제약</th><th>목적</th><th>구현 방법</th></tr></thead>
<tbody>
<tr><td><strong>압축 기술</strong></td><td>트래픽 1/10 축소</td><td>Draco + KTX2</td></tr>
<tr><td><strong>P2P 최적화</strong></td><td>서버 부하 감소</td><td>Photon Fusion Shared Mode</td></tr>
<tr><td><strong>Signed URL</strong></td><td>직접 다운로드</td><td>R2 egress 무료 활용</td></tr>
<tr><td><strong>변경 감지</strong></td><td>불필요한 전송 제거</td><td>Delta Compression</td></tr>
</tbody></table>
<hr>
<h2 id="7-시나리오별-비용-시뮬레이션">7. 시나리오별 비용 시뮬레이션</h2>
<h3>7.1 정상 사용 패턴</h3>
<p><strong>시나리오:</strong> Pro 플랜 사용자, 주 3회 합방 (각 2시간)</p>
<table>
<thead><tr><th>항목</th><th>값</th></tr></thead>
<tbody>
<tr><td>월 합방 시간</td><td>24시간</td></tr>
<tr><td>트래픽</td><td>~60GB</td></tr>
<tr><td>원가</td><td>~5,000원</td></tr>
<tr><td>수익</td><td>10,430원 - 5,000원 = <strong>5,430원</strong> ✅</td></tr>
</tbody></table>
<hr>
<h3>7.2 헤비 유저 패턴</h3>
<p><strong>시나리오:</strong> Pro 플랜, 매일 2시간 합방</p>
<table>
<thead><tr><th>항목</th><th>값</th></tr></thead>
<tbody>
<tr><td>월 합방 시간</td><td>60시간</td></tr>
<tr><td>트래픽</td><td>~150GB</td></tr>
<tr><td>원가</td><td>~8,500원</td></tr>
<tr><td>수익</td><td>10,430원 - 8,500원 = <strong>1,930원</strong> ⚠️</td></tr>
</tbody></table>
<p><strong>대응:</strong> 세션 타임아웃 정책으로 제한</p>
<hr>
<h3>7.3 악용 패턴</h3>
<p><strong>시나리오:</strong> 24시간 연속 세션 유지 시도</p>
<table>
<thead><tr><th>항목</th><th>값</th></tr></thead>
<tbody>
<tr><td>의도</td><td>720시간</td></tr>
<tr><td><strong>실제 (4시간 제한)</strong></td><td><strong>120시간</strong></td></tr>
<tr><td>트래픽</td><td>~300GB (제한 적용)</td></tr>
<tr><td>원가</td><td>~15,000원</td></tr>
<tr><td>수익</td><td>10,430원 - 15,000원 = <strong>-4,570원</strong> 🚨</td></tr>
</tbody></table>
<p><strong>대응:</strong></p>
<ul>
<li>4시간 세션 타임아웃</li>
<li>일 10GB 초과 알림</li>
<li>월 300GB 초과 시 계정 제한</li>
</ul>
<hr>
<h2 id="8-설계-시-고려사항">8. 설계 시 고려사항</h2>
<h3>8.1 Steam 정산 수수료 (30%)</h3>
<p>모든 가격에 Steam 수수료 30% 반영 필요:</p>
<table>
<thead><tr><th>표시 가격</th><th>Steam 정산 후</th></tr></thead>
<tbody>
<tr><td>3,900원</td><td>2,730원 (30% 차감)</td></tr>
<tr><td>14,900원</td><td>10,430원 (30% 차감)</td></tr>
</tbody></table>
<hr>
<h3>8.2 VAT 및 환율 변동</h3>
<table>
<thead><tr><th>고려 사항</th><th>내용</th></tr></thead>
<tbody>
<tr><td>VAT</td><td>한국 10%, 지역별 상이</td></tr>
<tr><td>환율 변동</td><td>USD 기반 Photon/GCP 비용 영향</td></tr>
<tr><td>리전별 차이</td><td>Firebase Storage 다운로드 비용 차이</td></tr>
</tbody></table>
<hr>
<h3>8.3 결제 시스템 미구현</h3>
<p>향후 구현 필요:</p>
<ul>
<li>Stripe/Steam 결제 연동</li>
<li>구독 상태 관리</li>
<li>라이선스 검증</li>
<li>평가판 로직</li>
</ul>
<hr>
<h2 id="9-향후-검토-사항">9. 향후 검토 사항</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td>Studio/Enterprise 플랜 가격 확정</td><td>📋 논의 필요</td><td>높음</td></tr>
<tr><td>Photon 비용 최적화 (Delta Sync)</td><td>🚧 검토 중</td><td>높음</td></tr>
<tr><td>Ultra Sync 모드 비용 산출</td><td>📋 미정</td><td>중간</td></tr>
<tr><td>마켓플레이스 수수료 정책</td><td>📋 미정</td><td>낮음</td></tr>
<tr><td>리전별 서버 증설 비용</td><td>📋 미정</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="10-참고-자료">10. 참고 자료</h2>
<ul>
<li><strong>원본 산출 자료</strong>: VIRDY 사업 종합 기획서 v1.0 (HTML, 박성술 작성)</li>
<li><strong>라이선스 체계</strong>: 라이선스 체계</li>
<li><strong>리스크 관리</strong>: 리스크 관리</li>
<li><strong>네트워크 시스템</strong>: 네트워크 시스템</li>
<li><strong>데이터 생명주기</strong>: 데이터 생명주기</li>
</ul>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>제품 개요</li>
<li>라이선스 체계</li>
<li>리스크 관리</li>
<li>네트워크 시스템</li>
</ul>
        </div>
        
        <div class="page-content" id="page-04_Design_01_UI_Specification">
            <div class="section-header">
                <h2>🎨 UI 기획</h2>
            </div>
            <h1>UI 기획</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY의 UI는 씬 기반 계층 구조로 구성되며, 전역 UI(GlobalUI)와 씬별 UI(Sign/Lobby/World)로 나뉜다. Creator와 Manager 역할에 따라 표시되는 패널이 다르며, 다국어(한국어/영어)를 지원한다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 UI 아키텍처</h3>
<table>
<thead><tr><th>계층</th><th>범위</th><th>역할</th></tr></thead>
<tbody>
<tr><td><strong>GlobalUI</strong></td><td>전역 (모든 씬)</td><td>알림, 에러 다이얼로그, 로딩, 토스트 메시지, 캘리브레이션</td></tr>
<tr><td><strong>SignScene UI</strong></td><td>인증 씬</td><td>로그인, 회원가입, 비밀번호 리셋</td></tr>
<tr><td><strong>LobbyScene UI</strong></td><td>로비 씬</td><td>액터, 아바타, 트래커, 월드 설정</td></tr>
<tr><td><strong>WorldScene UI</strong></td><td>월드 씬</td><td>카메라, 채팅, 조명, 플레이어 목록</td></tr>
</tbody></table>
<p>모든 UI 패널은 UIController 기본 클래스를 상속하며, OnInitialize(첫 활성화), OnActivate(표시), OnDeactivate(숨김) 생명주기를 따른다.</p>
<h3>2.2 Sign Scene UI</h3>
<h4>화면 목록</h4>
<table>
<thead><tr><th>화면</th><th>설명</th><th>주요 요소</th></tr></thead>
<tbody>
<tr><td>언어 선택</td><td>최초 실행 시</td><td>한국어/영어 선택</td></tr>
<tr><td>로그인</td><td>사용자 인증</td><td>사용자명, 비밀번호, 로그인 버튼</td></tr>
<tr><td>회원가입 1단계</td><td>이메일 인증</td><td>이메일 입력, 인증코드 확인</td></tr>
<tr><td>회원가입 2단계</td><td>닉네임 설정</td><td>닉네임 입력</td></tr>
<tr><td>회원가입 3단계</td><td>비밀번호 설정</td><td>비밀번호, 비밀번호 확인</td></tr>
<tr><td>회원가입 4단계</td><td>역할 선택</td><td>Creator/Manager 토글</td></tr>
<tr><td>회원가입 5단계</td><td>약관 동의</td><td>체크박스, 동의 버튼</td></tr>
<tr><td>비밀번호 리셋</td><td>비밀번호 복구</td><td>이메일 또는 사용자명 입력</td></tr>
</tbody></table>
<h3>2.3 Lobby Scene UI</h3>
<p>로비 UI는 사이드바를 통해 패널 간 이동한다.</p>
<h4>패널 목록</h4>
<table>
<thead><tr><th>패널</th><th>설명</th><th>Creator</th><th>Manager</th></tr></thead>
<tbody>
<tr><td>사이드바</td><td>패널 간 네비게이션</td><td>✅</td><td>✅ (제한)</td></tr>
<tr><td>액터 패널</td><td>액터 슬롯 관리 (최대 6개)</td><td>✅</td><td>❌</td></tr>
<tr><td>아바타 패널</td><td>VRM 아바타 업로드/선택</td><td>✅</td><td>❌</td></tr>
<tr><td>트래커 패널</td><td>Facial/Body/Hand 장비 설정</td><td>✅</td><td>❌</td></tr>
<tr><td>월드 패널</td><td>월드 검색, 업로드, 공유 설정</td><td>✅</td><td>✅</td></tr>
<tr><td>설정 패널</td><td>그래픽, 사운드, 키바인딩, 언어</td><td>✅</td><td>✅</td></tr>
<tr><td>친구 패널</td><td>친구 검색, 추가, 온라인 상태</td><td>✅</td><td>✅</td></tr>
</tbody></table>
<h4>액터 패널 구성</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>액터 카드</td><td>아바타 썸네일, 이름, 연결된 트래커 표시</td></tr>
<tr><td>슬롯 탭</td><td>최대 6개 액터 슬롯 전환</td></tr>
<tr><td>추가/삭제</td><td>슬롯 추가 (MaxActorSize 미만일 때), 삭제</td></tr>
<tr><td>편집/복제</td><td>기존 액터 설정 수정 또는 복제</td></tr>
</tbody></table>
<h4>아바타 패널 구성</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>아바타 리스트</td><td>업로드한 VRM 아바타 썸네일 목록</td></tr>
<tr><td>업로드 버튼</td><td>로컬 VRM 파일 선택 → 업로드</td></tr>
<tr><td>아바타 상세</td><td>선택한 아바타 이름, 파일 크기</td></tr>
<tr><td>선택/삭제</td><td>액터에 아바타 할당 또는 삭제</td></tr>
</tbody></table>
<h4>트래커 패널 구성</h4>
<table>
<thead><tr><th>섹션</th><th>요소</th></tr></thead>
<tbody>
<tr><td>페이셜 트래커</td><td>장비 드롭다운, 연결 상태, IP/포트 설정</td></tr>
<tr><td>바디 트래커</td><td>장비 드롭다운, 연결 상태, 트래커 매핑</td></tr>
<tr><td>핸드 트래커</td><td>장비 드롭다운, 연결 상태</td></tr>
<tr><td>민감도 설정</td><td>시선/눈썹/입 강도 슬라이더</td></tr>
<tr><td>캘리브레이션</td><td>T-Pose / I-Pose 캘리브레이션 버튼</td></tr>
</tbody></table>
<h4>월드 패널 구성</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>월드 리스트</td><td>공개/내/공유 월드 탭, 썸네일 카드</td></tr>
<tr><td>검색</td><td>Algolia 기반 월드 검색</td></tr>
<tr><td>정렬</td><td>최신순/인기순/오래된순</td></tr>
<tr><td>월드 카드</td><td>썸네일, 제목, 제작자, 방문수, 공개설정</td></tr>
<tr><td>월드 상세</td><td>설명, 공유설정, 편집, 삭제</td></tr>
<tr><td>월드 업로드</td><td>AssetBundle 파일 선택 + 메타데이터 입력</td></tr>
<tr><td>월드 진입</td><td>"세션 생성" 또는 "세션 참가" (코드 입력)</td></tr>
</tbody></table>
<h4>설정 패널 구성</h4>
<table>
<thead><tr><th>섹션</th><th>항목</th></tr></thead>
<tbody>
<tr><td>그래픽</td><td>해상도, 품질, 프레임 제한, 안티앨리어싱</td></tr>
<tr><td>사운드</td><td>마스터/음악/효과음/월드 볼륨</td></tr>
<tr><td>키바인딩</td><td>커스텀 키 설정</td></tr>
<tr><td>언어</td><td>한국어/영어 전환</td></tr>
</tbody></table>
<h3>2.4 World Scene UI</h3>
<p>월드 진입 후 표시되는 UI 패널:</p>
<table>
<thead><tr><th>패널</th><th>설명</th></tr></thead>
<tbody>
<tr><td>카메라 패널</td><td>10개 카메라 슬롯, 프리셋 저장, Channel Link</td></tr>
<tr><td>채팅 패널</td><td>메시지 표시, 입력 필드, 전체/팀 전환</td></tr>
<tr><td>플레이어 목록</td><td>접속자 이름, 역할 색상, 호스트 👑, ME 라벨</td></tr>
<tr><td>조명 제어</td><td>방향광 강도/회전, 포스트 프로세싱</td></tr>
<tr><td>설정 오버레이</td><td>카메라 속도, 줌 속도, 회전 민감도</td></tr>
</tbody></table>
<h4>카메라 패널</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>FreeCam 프리뷰</td><td>자유 카메라 미리보기</td></tr>
<tr><td>카메라 슬롯 [1]~[9]</td><td>고정 카메라 선택/전환</td></tr>
<tr><td>FOV 슬라이더</td><td>초점 거리 조절</td></tr>
<tr><td>DoF 설정</td><td>포커스 거리, 자동 포커스 대상</td></tr>
<tr><td>Follow/LookAt</td><td>대상 Actor 선택</td></tr>
<tr><td>Channel Link</td><td>접속자 목록, 송출/수신 제어</td></tr>
<tr><td>프리셋 저장</td><td>현재 카메라 Transform 프리셋 저장</td></tr>
</tbody></table>
<h4>채팅 패널</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>채팅 모드 탭</td><td>[All] / [Creator] / [Manager] 전환</td></tr>
<tr><td>메시지 표시</td><td>역할별 색상 코딩, 팀 접두사</td></tr>
<tr><td>입력 필드</td><td>텍스트 입력, 전송 버튼</td></tr>
</tbody></table>
<h4>플레이어 목록</h4>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>이름</td><td>최대 16자 표시 (초과 시 ... 처리)</td></tr>
<tr><td>역할 색상</td><td>Creator/Manager 별도 색상</td></tr>
<tr><td><strong>호스트 표시</strong></td><td>👑 왕관 아이콘 (호스트 옆에 표시)</td></tr>
<tr><td>ME 라벨</td><td>본인 식별</td></tr>
<tr><td>초대/따라가기</td><td>소셜 기능 버튼</td></tr>
</tbody></table>
<p><strong>호스트 표시 동작:</strong></p>
<ul>
<li>월드를 연 사용자에게 👑 왕관 아이콘 표시</li>
<li>호스트 이전 시 왕관도 실시간으로 이동</li>
<li>호스트 변경 시 "호스트가 변경되었습니다" 토스트 메시지</li>
</ul>
<h3>2.5 GlobalUI</h3>
<p>모든 씬에서 공통으로 표시되는 전역 UI:</p>
<table>
<thead><tr><th>요소</th><th>설명</th></tr></thead>
<tbody>
<tr><td>알림 팝업</td><td>초대, 따라가기 요청 등</td></tr>
<tr><td>에러 다이얼로그</td><td>연결 실패, 오류 메시지</td></tr>
<tr><td>로딩 인디케이터</td><td>비동기 작업 진행 표시</td></tr>
<tr><td>토스트 메시지</td><td>짧은 알림 (복사 완료, 저장 완료 등)</td></tr>
<tr><td>캘리브레이션 UI</td><td>T-Pose/I-Pose 안내, 카운트다운</td></tr>
</tbody></table>
<h3>2.6 View 모드별 레이아웃</h3>
<p>월드 진입 후 4가지 View 모드에 따라 화면 레이아웃이 달라진다.</p>
<table>
<thead><tr><th>모드</th><th>레이아웃</th></tr></thead>
<tbody>
<tr><td>Default</td><td>Main Screen만 전체 화면</td></tr>
<tr><td>Manager</td><td>Main Screen + Spectator (9분할) + Manager CAM</td></tr>
<tr><td>Studio</td><td>9분할 모니터링 전체 화면</td></tr>
<tr><td>Spout</td><td>Main Screen → Spout 텍스처 출력 (UI 제외)</td></tr>
</tbody></table>
<h3>2.7 다국어 지원</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>지원 언어</td><td>한국어, 영어</td></tr>
<tr><td>선택 시점</td><td>최초 실행 시 + 설정에서 변경 가능</td></tr>
<tr><td>적용 방식</td><td>Localization 키 기반 텍스트 치환</td></tr>
</tbody></table>
<h3>2.8 Figma 디자인 화면 목록</h3>
<p>Figma에서 관리되는 주요 디자인 화면:</p>
<table>
<thead><tr><th>카테고리</th><th>화면</th><th>수량</th></tr></thead>
<tbody>
<tr><td>런처</td><td>대기, 토큰, 업데이트, 에러 등</td><td>9개</td></tr>
<tr><td>로그인</td><td>기본, 비밀번호 표시</td><td>2개</td></tr>
<tr><td>회원가입</td><td>이메일 인증 ~ 가입 완료</td><td>9개</td></tr>
<tr><td>액터 설정</td><td>메인, 아바타, 트래커, 표정</td><td>4개</td></tr>
<tr><td>월드 설정</td><td>리스트, 상세, 생성, 편집</td><td>4개</td></tr>
<tr><td>월드 진입</td><td>로딩, 메인 뷰, 설정 오버레이</td><td>3개</td></tr>
<tr><td>카메라</td><td>모드별 레이아웃, Channel Link</td><td>복수</td></tr>
</tbody></table>
<blockquote>Figma 디자인은 별도로 관리되며, 이 문서에서는 화면 구성과 기능 정의만 다룬다.</blockquote>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 역할별 UI 분기</h3>
<p>Creator와 Manager는 로비에서 표시되는 패널이 다르다. Manager에게는 아바타/트래커 패널이 표시되지 않는다. 세션 생성은 역할과 무관하게 가능하며, Free 플랜만 제한된다. 이를 위한 UI 분기 처리가 필요하다.</p>
<h3>3.2 반응형 레이아웃</h3>
<p>해상도 변경 시 UI가 적절히 대응해야 한다. 특히 Manager 모드의 3분할 레이아웃(Main + Spectator + Manager CAM)은 해상도에 따라 비율 조정이 필요하다.</p>
<h3>3.3 키바인딩 커스터마이징</h3>
<p>카메라 전환(R+1~9), 이동(WASD), 기타 단축키는 사용자가 커스터마이즈할 수 있어야 한다. KeyBinder 시스템을 통해 가상 키를 물리 키에 매핑한다.</p>
<h3>3.4 Spout 모드 UI 제외</h3>
<p>Spout 출력 시 UI가 포함되지 않아야 한다. 이를 위해 Main Screen 렌더링과 UI 렌더링이 분리되어야 한다.</p>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>사용자명 16자 초과</td><td>말줄임 처리 (앞 16자 + "...")</td></tr>
<tr><td>네트워크 오류 시 로딩</td><td>타임아웃 후 에러 다이얼로그 표시</td></tr>
<tr><td>월드 로딩 중 UI 인터랙션</td><td>로딩 중 다른 조작 차단</td></tr>
<tr><td>채팅 메시지 폭주 (스팸)</td><td>스크롤 처리, 최대 메시지 수 제한</td></tr>
<tr><td>다국어 텍스트 길이 차이</td><td>레이아웃이 텍스트 길이에 적응</td></tr>
<tr><td>키바인딩 충돌</td><td>동일 키 중복 할당 시 경고</td></tr>
</tbody></table>
<hr>
<h2 id="5-검토-중인-기능">5. 검토 중인 기능</h2>
<h3>5.1 활성 월드 리스트 (검토 중)</h3>
<blockquote>⚠️ <strong>상태:</strong> 고민 중. UX 담당 유수진님과 협의 필요.</blockquote>
<p>현재 별도의 "내 월드" 관리 패널이 없어, <strong>활성 월드 리스트</strong> 기능을 검토 중이다.</p>
<p><strong>검토 중인 기능:</strong></p>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td><strong>활성 월드 리스트</strong></td><td>현재 열려있는 월드 목록 표시</td></tr>
<tr><td><strong>내가 호스트인 월드</strong></td><td>본인이 호스트인 활성 월드 관리</td></tr>
<tr><td><strong>친구의 월드</strong></td><td>친구가 접속 중인 월드 목록</td></tr>
<tr><td><strong>재접속 / 월드 닫기</strong></td><td>호스트인 월드에 대한 관리 기능</td></tr>
</tbody></table>
<p><strong>고려사항:</strong></p>
<table>
<thead><tr><th>항목</th><th>내용</th></tr></thead>
<tbody>
<tr><td><strong>장점</strong></td><td>내 월드와 친구 월드를 한 곳에서 확인 가능, 재접속 편의성 향상</td></tr>
<tr><td><strong>단점</strong></td><td>기존 월드 패널과 역할이 중복될 수 있음</td></tr>
<tr><td><strong>연계 이슈</strong></td><td>이 기능 도입 시 기존 월드 패널 개편이 필요할 수 있음</td></tr>
</tbody></table>
<p><strong>결정 필요 사항:</strong> 1. 활성 월드 리스트를 별도 패널로 분리할지, 기존 월드 패널에 통합할지 2. 친구 월드 표시 시 프라이버시 설정 필요 여부 3. 월드 패널 전체 UX 재설계 필요 여부</p>
<blockquote>📋 <strong>다음 단계:</strong> UX 담당 유수진님과 논의 후 방향 결정</blockquote>
<hr>
<h2 id="6-향후-확장-가능성">6. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>활성 월드 리스트</strong></td><td>내 월드/친구 월드 관리 (검토 중)</td><td>높음</td></tr>
<tr><td><strong>튜토리얼</strong></td><td>최초 실행 시 가이드 투어</td><td>중간</td></tr>
<tr><td><strong>프로필 페이지</strong></td><td>프로필 이미지, 자기소개, 포트폴리오</td><td>낮음</td></tr>
<tr><td><strong>알림 센터</strong></td><td>공지사항, 친구 접속, 월드 업데이트 알림</td><td>중간</td></tr>
<tr><td><strong>다크 모드</strong></td><td>UI 테마 전환</td><td>낮음</td></tr>
<tr><td><strong>추가 언어</strong></td><td>일본어, 중국어 등</td><td>장기</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>사용자 플로우</li>
<li>카메라 시스템</li>
<li>사용자 역할</li>
<li>데이터 생명주기</li>
</ul>
        </div>
        
        <div class="page-content" id="page-05_Technical_01_Architecture">
            <div class="section-header">
                <h2>🛠️ 기술 아키텍처</h2>
            </div>
            <h1>기술 아키텍처</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>VIRDY는 Unity 2022.3 LTS 기반의 Windows x64 전용 클라이언트 애플리케이션이다. 클라이언트는 3개 씬 구조(Sign → Lobby → World)와 Context 서비스 로케이터 패턴을 중심으로 설계된다.</p>
<p>서버 아키텍처는 현재 Firebase 기반(Auth, Firestore, Storage, Functions)으로 구현되어 있으며, 서버 개발자 회의(2026.02)를 통해 <strong>Spring Boot 기반 자체 백엔드로의 전환을 검토 중</strong>이다. 전환 방향은 비용, 확장성, 기술적 타당성에 따라 변동될 수 있다.</p>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 기술 스택</h3>
<h4>핵심 기술</h4>
<table>
<thead><tr><th>영역</th><th>기술</th><th>버전/모드</th></tr></thead>
<tbody>
<tr><td>게임 엔진</td><td>Unity</td><td>2022.3.62f3 LTS</td></tr>
<tr><td>렌더 파이프라인</td><td>Universal Render Pipeline (URP)</td><td>14.0.12</td></tr>
<tr><td>렌더링 모드</td><td>Forward+</td><td>-</td></tr>
<tr><td>네트워킹</td><td>Photon Fusion</td><td>Shared Mode</td></tr>
<tr><td>백엔드 (현행)</td><td>Firebase</td><td>Auth, Firestore, Storage, Functions</td></tr>
<tr><td>백엔드 (전환 검토)</td><td>Java Spring Boot 4.0</td><td>GCP Cloud Run, PostgreSQL, Cloudflare R2</td></tr>
<tr><td>채팅</td><td>Photon Chat</td><td>-</td></tr>
</tbody></table>
<h4>주요 패키지</h4>
<table>
<thead><tr><th>패키지</th><th>용도</th></tr></thead>
<tbody>
<tr><td>UniTask</td><td>비동기/await 유틸리티</td></tr>
<tr><td>UniVRM</td><td>VRM 아바타 로딩</td></tr>
<tr><td>Cinemachine</td><td>카메라 시스템</td></tr>
<tr><td>Final IK</td><td>인버스 키네마틱스</td></tr>
<tr><td>Animancer</td><td>애니메이션 상태 머신</td></tr>
<tr><td>MessagePack</td><td>직렬화</td></tr>
<tr><td>Newtonsoft.Json</td><td>JSON 파싱</td></tr>
<tr><td>Klak.Spout</td><td>Spout 텍스처 공유 (Windows)</td></tr>
<tr><td>DOTween</td><td>트윈 애니메이션</td></tr>
</tbody></table>
<h4>외부 플러그인</h4>
<table>
<thead><tr><th>플러그인</th><th>용도</th></tr></thead>
<tbody>
<tr><td>ParrelSync</td><td>멀티 인스턴스 테스팅</td></tr>
<tr><td>RuntimeTransformHandle</td><td>월드 내 오브젝트 조작</td></tr>
<tr><td>uOSC</td><td>OSC 프로토콜 (VMC, VRChat OSC)</td></tr>
<tr><td>uWindowCapture</td><td>가상 배경용 윈도우 캡처</td></tr>
<tr><td>VSF SDK</td><td>VSeeFace 통합</td></tr>
</tbody></table>
<h3>2.2 서비스 로케이터 패턴 (Context)</h3>
<p>VIRDY는 Context 싱글톤을 통해 전역 서비스에 접근하는 서비스 로케이터 패턴을 사용한다.</p>
<h4>Context에 등록된 서비스</h4>
<table>
<thead><tr><th>서비스</th><th>역할</th></tr></thead>
<tbody>
<tr><td>SceneService</td><td>씬 수명주기 관리, 씬 전환</td></tr>
<tr><td>FirebaseService</td><td>Firebase 인증/데이터/스토리지 통합</td></tr>
<tr><td>FusionService</td><td>Photon Fusion 세션 관리</td></tr>
<tr><td>Database</td><td>로컬 데이터 캐시</td></tr>
<tr><td>ActorManager</td><td>액터 생성/삭제/관리</td></tr>
<tr><td>ChatService</td><td>Photon Chat 메시징</td></tr>
<tr><td>Cache</td><td>에셋(아바타, 월드) 캐싱</td></tr>
<tr><td>KeyBinder</td><td>전역 키보드 단축키</td></tr>
<tr><td>AppSettings</td><td>앱 설정 (그래픽, 사운드 등)</td></tr>
<tr><td>HubSettings</td><td>모션캡처 허브 설정</td></tr>
</tbody></table>
<p>모든 서비스는 Context의 static 필드로 접근하며, 씬 전환과 무관하게 유지된다.</p>
<h3>2.3 씬 구조</h3>
<p>VIRDY는 3개의 핵심 씬과 추가 로드(Additive)되는 월드 씬으로 구성된다.</p>
<table>
<thead><tr><th>씬</th><th>빌드 인덱스</th><th>역할</th></tr></thead>
<tbody>
<tr><td>SignScene</td><td>0</td><td>인증 (로그인, 회원가입, 비밀번호 리셋)</td></tr>
<tr><td>LobbyScene</td><td>1</td><td>설정 (액터, 아바타, 트래커, 월드 선택)</td></tr>
<tr><td>WorldScene</td><td>2</td><td>실시간 방송 (카메라, 채팅, 멀티유저)</td></tr>
<tr><td>AssetBundle 월드</td><td>Additive</td><td>WorldScene 위에 Additive 로드되는 사용자 월드</td></tr>
</tbody></table>
<h4>씬 전환 이벤트</h4>
<table>
<thead><tr><th>이벤트</th><th>발생 시점</th></tr></thead>
<tbody>
<tr><td>OnLobbyConnected</td><td>로비 씬 로드 완료</td></tr>
<tr><td>OnWorldConnected</td><td>월드 씬 + 네트워크 접속 완료</td></tr>
<tr><td>OnWorldDisconnected</td><td>월드에서 로비로 복귀</td></tr>
<tr><td>OnWorldConnectionFailed</td><td>월드 접속 실패</td></tr>
</tbody></table>
<h3>2.4 엔티티 시스템</h3>
<p>VIRDY 내부의 데이터 모델은 3개 계층으로 구성된다.</p>
<table>
<thead><tr><th>계층</th><th>역할</th><th>주요 클래스</th></tr></thead>
<tbody>
<tr><td>Entity</td><td>GUID 기반 식별, 생명주기 관리</td><td>EntityManager 자동 등록</td></tr>
<tr><td>StructuredData</td><td>복잡한 런타임 데이터</td><td>AvatarData, TrackerData, ChannelData</td></tr>
<tr><td>Asset</td><td>직렬화 가능한 씬 오브젝트</td><td>ActorAsset (JSON 저장/로드)</td></tr>
</tbody></table>
<h4>StructuredData 세부 구조</h4>
<table>
<thead><tr><th>데이터 클래스</th><th>하위 클래스</th></tr></thead>
<tbody>
<tr><td>TrackerData (추상)</td><td>FacialTrackerData, MotionTrackerData, HandTrackerData</td></tr>
<tr><td>FacialTrackerData</td><td>iFacialMocap, VTubeStudio, Facemotion3D, OpenSeeFace</td></tr>
<tr><td>MotionTrackerData</td><td>SteamVR, VMCProtocol, Xsens, Vicon, MOVIN</td></tr>
<tr><td>HandTrackerData</td><td>LeapMotion, Manus, Mollisen, StretchSense</td></tr>
</tbody></table>
<h4>FieldData 시스템</h4>
<p>StructuredData는 리플렉션 기반 속성 시스템(FieldData)을 사용한다. `[FieldData]` 어트리뷰트가 적용된 필드는 동적 get/set이 가능하며, 값 변경 시 `OnFieldDataChanged` 이벤트가 트리거된다.</p>
<h3>2.5 네트워크 오브젝트 계층</h3>
<p>Photon Fusion Shared Mode로 동작하며, 네트워크 오브젝트는 아래 구조를 따른다.</p>
<table>
<thead><tr><th>네트워크 오브젝트</th><th>역할</th><th>주요 데이터</th></tr></thead>
<tbody>
<tr><td>NetworkGame</td><td>세션 루트</td><td>Players[255], Channels[255], Actors[]</td></tr>
<tr><td>NetworkPlayer</td><td>사용자당 1개</td><td>UserId, Username, IsCreator, HandlePosition/Rotation</td></tr>
<tr><td>NetworkChannel</td><td>사용자당 1개</td><td>10개 가상 카메라 데이터, Channel Link 상태, 포스트 프로세싱</td></tr>
<tr><td>NetworkActor</td><td>아바타당 1개</td><td>22개 본 회전, 40개 손가락 포즈, 100개 BlendShape, Props</td></tr>
</tbody></table>
<h4>데이터 압축</h4>
<table>
<thead><tr><th>데이터</th><th>원본 크기</th><th>압축 후</th><th>절감률</th></tr></thead>
<tbody>
<tr><td>Quaternion</td><td>16 bytes (float×4)</td><td>8 bytes (short×4)</td><td>50%</td></tr>
<tr><td>BlendShape</td><td>4 bytes (float)</td><td>1 byte (sbyte)</td><td>75%</td></tr>
<tr><td>Position</td><td>float3</td><td>Accuracy(0.1f) 양자화</td><td>가변</td></tr>
</tbody></table>
<h4>네트워크 최적화 기법</h4>
<table>
<thead><tr><th>기법</th><th>설명</th></tr></thead>
<tbody>
<tr><td>분산 업데이트</td><td>프레임당 최대 3명 액터만 업데이트 (라운드 로빈)</td></tr>
<tr><td>히스토리 보간</td><td>2프레임 히스토리 버퍼를 사용한 보간</td></tr>
<tr><td>변경 감지</td><td>변경된 데이터만 전송</td></tr>
<tr><td>양자화</td><td>[Networked, Accuracy()] 속성으로 데이터 양자화</td></tr>
</tbody></table>
<h3>2.6 Firebase 통합 구조 (현행)</h3>
<p>Firebase 서비스는 4개 하위 모듈로 구성된다.</p>
<table>
<thead><tr><th>모듈</th><th>역할</th><th>주요 기능</th></tr></thead>
<tbody>
<tr><td>Auth (FBAuth)</td><td>인증</td><td>이메일 로그인, 사용자명 로그인, 회원가입, 비밀번호 리셋</td></tr>
<tr><td>Firestore (FBFirestore)</td><td>데이터</td><td>사용자/월드 데이터 CRUD, 친구 관리, 실시간 리스너</td></tr>
<tr><td>Storage (FBStorage)</td><td>파일 저장</td><td>아바타/월드 업로드/다운로드</td></tr>
<tr><td>Functions</td><td>서버 로직</td><td>signUpV2, resetPasswordV2, saveWorld, deleteWorld, getEmailByUsername</td></tr>
</tbody></table>
<h4>Firestore 데이터 구조</h4>
<table>
<thead><tr><th>컬렉션</th><th>주요 필드</th></tr></thead>
<tbody>
<tr><td>users/{userId}</td><td>username, email, isCreator</td></tr>
<tr><td>users/{userId}/avatars/{avatarId}</td><td>아바타 메타데이터</td></tr>
<tr><td>users/{userId}/friends/{friendId}</td><td>친구 관계</td></tr>
<tr><td>users/{userId}/requests/{requestId}</td><td>친구 요청</td></tr>
<tr><td>users/{userId}/favorites/{worldId}</td><td>즐겨찾기 월드</td></tr>
<tr><td>users/{userId}/shared/{worldId}</td><td>공유받은 월드</td></tr>
<tr><td>users/{userId}/worlds_private/{worldId}</td><td>비공개 월드</td></tr>
<tr><td>worlds_public/{worldId}</td><td>title, author, authorId, description, sceneName, isPublic, sharedWith, version, visits, urls[]</td></tr>
</tbody></table>
<h3>2.7 서버 아키텍처 전환 검토 (서버 개발자 회의 기반)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<h4>전환 배경</h4>
<p>현행 Firebase 아키텍처는 빠른 프로토타이핑에 적합하나, 상용화 단계에서 다음과 같은 한계가 예상된다:</p>
<table>
<thead><tr><th>한계</th><th>설명</th></tr></thead>
<tbody>
<tr><td>서버 측 검증 부재</td><td>Firebase는 클라이언트 측 제한에 의존, 라이선스/권한의 서버 검증 불가</td></tr>
<tr><td>Egress 비용</td><td>Firebase Storage 다운로드 트래픽 비용이 규모 확대 시 부담</td></tr>
<tr><td>비즈니스 로직 제약</td><td>Firebase Functions만으로는 복잡한 비즈니스 로직 구현에 한계</td></tr>
<tr><td>테넌트/Seat 관리</td><td>멀티 테넌트 구조를 Firebase로 구현하기 어려움</td></tr>
</tbody></table>
<h4>검토 중인 전환 구성</h4>
<table>
<thead><tr><th>영역</th><th>현행 (Firebase)</th><th>전환 검토안 (Spring Boot)</th></tr></thead>
<tbody>
<tr><td>백엔드 프레임워크</td><td>Firebase Functions</td><td>Java Spring Boot 4.0</td></tr>
<tr><td>인프라</td><td>Firebase Hosting</td><td>GCP Cloud Run</td></tr>
<tr><td>인증</td><td>Firebase Auth (이메일/비밀번호)</td><td>Steam OAuth → Firebase Auth → Spring Security JWT</td></tr>
<tr><td>데이터베이스</td><td>Firestore (NoSQL)</td><td>PostgreSQL (RDB)</td></tr>
<tr><td>파일 저장</td><td>Firebase Storage</td><td>Cloudflare R2 (Signed URL)</td></tr>
<tr><td>토큰 관리</td><td>Firebase Auth 토큰 (자동 갱신)</td><td>자체 JWT (Access 1h + Refresh 7~30d)</td></tr>
<tr><td>Photon 연동</td><td>클라이언트 직접 연결</td><td>Backend Webhook 기반 상태 동기화</td></tr>
</tbody></table>
<h4>전환 시 JWT 토큰 구조 (검토 중)</h4>
<table>
<thead><tr><th>토큰</th><th>만료</th><th>용도</th><th>저장 위치</th></tr></thead>
<tbody>
<tr><td>Access Token</td><td>1시간</td><td>API 호출 인증</td><td>메모리 (Unity)</td></tr>
<tr><td>Refresh Token</td><td>7~30일 (미확정)</td><td>Access Token 갱신</td><td>로컬 안전한 저장소</td></tr>
</tbody></table>
<p>JWT Payload에는 userId, tenantId, role, subscriptionPlan을 포함하여 API 호출마다 권한 검증이 가능하도록 설계한다.</p>
<h4>전환 시 데이터 흐름</h4>
<p>인증: Steam 로그인 → Firebase Custom Auth → Backend JWT 발급 파일 업로드: Backend에서 R2 Signed URL 발급 → 클라이언트가 R2에 직접 업로드 (Egress 비용 0원) 세션 관리: Photon Webhook → Backend로 Room 이벤트 전달 → 세션 상태 DB 저장</p>
<h4>미확정 사항</h4>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Refresh Token 만료 기간</td><td>📋 미확정</td><td>7일 vs 30일</td></tr>
<tr><td>Firebase 유지 범위</td><td>📋 미확정</td><td>Auth만 유지 vs 완전 탈피</td></tr>
<tr><td>DB 마이그레이션 전략</td><td>📋 미확정</td><td>Firestore → PostgreSQL 데이터 이전</td></tr>
<tr><td>전환 시점 및 단계</td><td>📋 미확정</td><td>점진적 전환 vs 일괄 전환</td></tr>
</tbody></table>
<h3>2.8 빌드 변형</h3>
<table>
<thead><tr><th>스크립팅 심볼</th><th>설명</th></tr></thead>
<tbody>
<tr><td>VIRDY_CORE</td><td>프레임워크 빌드</td></tr>
<tr><td>VIRDY_DOTWEEN</td><td>DOTween 애니메이션 활성화</td></tr>
</tbody></table>
<h3>2.9 프로젝트 폴더 구조</h3>
<table>
<thead><tr><th>폴더</th><th>역할</th></tr></thead>
<tbody>
<tr><td>Assets/Repack/Scripts/Data/</td><td>데이터 모델 (Entity, StructuredData, Asset)</td></tr>
<tr><td>Assets/Repack/Scripts/Database/</td><td>로컬 캐시</td></tr>
<tr><td>Assets/Repack/Scripts/Lobby/</td><td>로비 씬 로직</td></tr>
<tr><td>Assets/Repack/Scripts/Network/Firebase/</td><td>Firebase 통합</td></tr>
<tr><td>Assets/Repack/Scripts/Network/Photon/</td><td>Photon Fusion/Chat</td></tr>
<tr><td>Assets/Repack/Scripts/Scene/</td><td>씬 관리</td></tr>
<tr><td>Assets/Repack/Scripts/Sign/</td><td>인증 UI</td></tr>
<tr><td>Assets/Repack/Scripts/Utility/</td><td>유틸리티 (Context 포함)</td></tr>
<tr><td>Assets/Repack/Scripts/World/</td><td>월드 씬 로직</td></tr>
<tr><td>Assets/VIRDY-SDK/</td><td>SDK (Editor, Runtime, Samples)</td></tr>
<tr><td>Assets/ExternalPlugins/</td><td>외부 플러그인</td></tr>
</tbody></table>
<h3>2.10 배포 플랫폼</h3>
<table>
<thead><tr><th>플랫폼</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Windows x64</td><td>✅ 지원</td><td>주요 플랫폼</td></tr>
<tr><td>Steam</td><td>📋 계획</td><td>상용화 시 출시 예정</td></tr>
<tr><td>macOS</td><td>❌ 미지원</td><td>Spout, 일부 트래커 미지원</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 성능 최적화</h3>
<h4>아바타</h4>
<table>
<thead><tr><th>항목</th><th>권장 사항</th></tr></thead>
<tbody>
<tr><td>BlendShape 수</td><td>제한 권장 (프레임당 CPU 비용 높음)</td></tr>
<tr><td>메시 LOD</td><td>원거리 액터에 적용 검토</td></tr>
<tr><td>애니메이션</td><td>절차적 IK 대신 베이킹 우선</td></tr>
</tbody></table>
<h4>네트워크 대역폭</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>주요 소비</td><td>액터 본 업데이트</td></tr>
<tr><td>대규모 세션</td><td>액터 수 감소 권장</td></tr>
<tr><td>고정 카메라</td><td>FreeCam보다 전송 빈도 낮음</td></tr>
</tbody></table>
<h4>렌더링</h4>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>렌더 스케일</td><td>카메라별 조절 가능</td></tr>
<tr><td>포스트 프로세싱</td><td>모니터링 카메라에서는 비활성화 권장</td></tr>
<tr><td>Spout 모드</td><td>별도 렌더 타겟 사용 (메모리 집약적)</td></tr>
</tbody></table>
<h4>메모리 관리</h4>
<table>
<thead><tr><th>항목</th><th>조치</th></tr></thead>
<tbody>
<tr><td>AssetBundle</td><td>월드 퇴장 후 Unload(true) 호출</td></tr>
<tr><td>아바타 캐시</td><td>주기적 정리</td></tr>
<tr><td>텍스처 메모리</td><td>모니터링 필요 (아바타 텍스처 용량이 큼)</td></tr>
</tbody></table>
<h3>3.2 Context 패턴의 장단점</h3>
<table>
<thead><tr><th>장점</th><th>단점</th></tr></thead>
<tbody>
<tr><td>서비스 접근이 간편</td><td>테스트 시 mock 주입 어려움</td></tr>
<tr><td>씬 전환 시에도 서비스 유지</td><td>의존성이 명시적이지 않음</td></tr>
<tr><td>초기 설정이 단순</td><td>서비스 간 순환 참조 가능성</td></tr>
</tbody></table>
<p>향후 의존성 주입(DI) 컨테이너로의 전환을 고려할 수 있다.</p>
<h3>3.3 Shared Mode의 특성</h3>
<p>Photon Fusion Shared Mode는 서버 권한(Server Authority) 없이 클라이언트 간 데이터를 동기화한다. 각 클라이언트가 자신의 NetworkObject에 대한 State Authority를 갖는다.</p>
<table>
<thead><tr><th>특성</th><th>설명</th></tr></thead>
<tbody>
<tr><td>서버 권한</td><td>없음 (각 클라이언트가 자체 객체 권한)</td></tr>
<tr><td>장점</td><td>구현 단순, 지연 시간 낮음</td></tr>
<tr><td>단점</td><td>치트 방지 어려움, 서버 측 검증 불가</td></tr>
<tr><td>적합</td><td>협업/방송 환경 (경쟁적 요소 적음)</td></tr>
</tbody></table>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>Context 초기화 전 서비스 접근</td><td>null 체크 또는 초기화 순서 보장</td></tr>
<tr><td>씬 전환 중 비동기 작업</td><td>UniTask CancellationToken으로 취소 처리</td></tr>
<tr><td>AssetBundle 로드 실패</td><td>에러 다이얼로그 표시, 로비로 복귀</td></tr>
<tr><td>Photon 세션 연결 실패</td><td>재시도 로직 + 사용자 알림</td></tr>
<tr><td>Firebase 서비스 장애</td><td>오프라인 캐시 활용 (제한적), 에러 안내</td></tr>
<tr><td>네트워크 오브젝트 소유권 충돌</td><td>State Authority 기반 충돌 해소</td></tr>
<tr><td>대규모 세션에서 성능 저하</td><td>프레임당 액터 업데이트 수 제한 (라운드 로빈)</td></tr>
</tbody></table>
<hr>
<h2 id="5-향후-확장-가능성">5. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>서버 아키텍처 전환</strong></td><td>Firebase → Spring Boot + PostgreSQL + R2 전환</td><td>높음</td></tr>
<tr><td><strong>DI 컨테이너 도입</strong></td><td>Context 서비스 로케이터를 DI 컨테이너로 교체</td><td>중간</td></tr>
<tr><td><strong>ECS 전환</strong></td><td>대규모 액터 처리를 위한 Entity Component System 검토</td><td>장기</td></tr>
<tr><td><strong>서버 권한 모드</strong></td><td>경쟁적 기능 추가 시 Host Mode 전환 검토</td><td>장기</td></tr>
<tr><td><strong>자동 테스트 파이프라인</strong></td><td>CI/CD 연동 자동 빌드 및 테스트</td><td>중간</td></tr>
<tr><td><strong>코드 모듈화</strong></td><td>패키지 매니저 기반 모듈 분리</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>개발 현황</li>
<li>API 명세</li>
<li>네트워크 시스템</li>
<li>보안 시스템</li>
<li>제품 개요</li>
</ul>
        </div>
        
        <div class="page-content" id="page-05_Technical_02_Development_Status">
            <div class="section-header">
                <h2>🛠️ 개발 현황</h2>
            </div>
            <h1>개발 현황</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY의 기능별 개발 진행 상태, 알려진 제한사항, 기술 부채, 로드맵을 정리한다. 기획/개발/운영 전반에서 현재 상태를 파악하고 우선순위를 판단하는 기준 문서로 활용한다.</p>
        </div>
        
        <div class="page-content" id="page-05_Technical_03_API_Specification">
            <div class="section-header">
                <h2>🛠️ API 명세</h2>
            </div>
            <h1>API 명세</h1>
<hr>
<h2 id="1-개요">1. 개요</h2>
<p>이 문서는 VIRDY 서버 아키텍처 전환 검토(서버 개발자 회의, 2026.02)에서 논의된 API 엔드포인트를 정리한다. 현행 Firebase Functions 기반 API와 전환 검토 중인 Spring Boot REST API를 모두 포함한다.</p>
<blockquote>🚧 전환 검토 중인 API는 비용 및 기술적 타당성에 따라 변동될 수 있다. 확정 시 본 문서를 최종 명세로 갱신한다.</blockquote>
<hr>
<h2 id="2-핵심-기획">2. 핵심 기획</h2>
<h3>2.1 현행 API (Firebase Functions)</h3>
<p>현재 클라이언트에서 사용 중인 Firebase Functions 기반 서버 함수이다.</p>
<table>
<thead><tr><th>함수명</th><th>용도</th><th>호출 방식</th></tr></thead>
<tbody>
<tr><td>signUpV2</td><td>회원가입 (계정 생성 + Firestore 저장)</td><td>Firebase Functions 직접 호출</td></tr>
<tr><td>getEmailByUsername</td><td>사용자명 → 이메일 조회</td><td>Firebase Functions 직접 호출</td></tr>
<tr><td>saveWorld</td><td>월드 메타데이터 저장</td><td>Firebase Functions 직접 호출</td></tr>
<tr><td>deleteWorld</td><td>월드 삭제 (Firestore + Storage 정리)</td><td>Firebase Functions 직접 호출</td></tr>
<tr><td>getWorldData</td><td>월드 메타데이터 조회</td><td>Firebase Functions 직접 호출</td></tr>
<tr><td>resetPasswordV2</td><td>비밀번호 리셋 이메일 발송</td><td>Firebase Functions 직접 호출</td></tr>
</tbody></table>
<h3>2.2 전환 검토 중인 API (Spring Boot REST)</h3>
<blockquote>🚧 아래 내용은 서버 개발자 회의(2026.02) 기반 검토 사항이다. 비용 및 기술적 타당성에 따라 변동될 수 있다.</blockquote>
<p>서버 아키텍처 전환 시 도입 예정인 REST API 목록이다. 모든 API는 `Authorization: Bearer {access_token}` 헤더로 인증한다 (인증 API 제외).</p>
<h4>2.2.1 인증 API</h4>
<table>
<thead><tr><th>Method</th><th>Endpoint</th><th>설명</th><th>인증</th></tr></thead>
<tbody>
<tr><td>POST</td><td>`/api/v1/auth/login`</td><td>로그인 (Firebase Token → JWT 발급)</td><td>Firebase Token</td></tr>
<tr><td>POST</td><td>`/api/v1/auth/refresh`</td><td>Access Token 갱신</td><td>Refresh Token</td></tr>
<tr><td>POST</td><td>`/api/v1/auth/logout`</td><td>로그아웃 (토큰 무효화)</td><td>JWT</td></tr>
</tbody></table>
<p><strong>로그인 요청/응답 흐름:</strong></p>
<table>
<thead><tr><th>단계</th><th>동작</th></tr></thead>
<tbody>
<tr><td>요청</td><td>Firebase Token을 Body에 포함하여 전송</td></tr>
<tr><td>Backend 처리</td><td>Firebase에 Token 검증 요청 → 신규 사용자면 Account/Tenant 자동 생성</td></tr>
<tr><td>응답</td><td>JWT (Access Token + Refresh Token) 반환</td></tr>
</tbody></table>
<p><strong>JWT Payload 포함 정보:</strong></p>
<ul>
<li>userId (VIRDY 내부 ID)</li>
<li>tenantId</li>
<li>role (Owner / Admin / Member)</li>
<li>subscriptionPlan</li>
</ul>
<h4>2.2.2 아바타 API</h4>
<table>
<thead><tr><th>Method</th><th>Endpoint</th><th>설명</th></tr></thead>
<tbody>
<tr><td>GET</td><td>`/api/v1/avatars`</td><td>아바타 목록 조회 (이름, 크기, hash, 수정일)</td></tr>
<tr><td>POST</td><td>`/api/v1/avatars/upload/init`</td><td>업로드 Signed URL 발급 요청</td></tr>
<tr><td>POST</td><td>`/api/v1/avatars/upload/complete`</td><td>업로드 완료 알림 → 메타데이터 DB 저장</td></tr>
<tr><td>POST</td><td>`/api/v1/avatars/download`</td><td>다운로드 Signed URL 발급 (배치, avatarId 목록)</td></tr>
<tr><td>DELETE</td><td>`/api/v1/avatars/{id}`</td><td>아바타 삭제</td></tr>
</tbody></table>
<p><strong>아바타 목록 응답 구조 (검토 중):</strong></p>
<table>
<thead><tr><th>필드</th><th>타입</th><th>설명</th></tr></thead>
<tbody>
<tr><td>id</td><td>Long</td><td>아바타 고유 ID</td></tr>
<tr><td>name</td><td>String</td><td>아바타 이름</td></tr>
<tr><td>fileSize</td><td>Long</td><td>파일 크기 (bytes)</td></tr>
<tr><td>fileHash</td><td>String</td><td>캐시 비교용 해시</td></tr>
<tr><td>createdAt</td><td>DateTime</td><td>생성일</td></tr>
<tr><td>updatedAt</td><td>DateTime</td><td>수정일</td></tr>
</tbody></table>
<p><strong>향후 최적화: Resolve API (검토 중)</strong></p>
<table>
<thead><tr><th>Method</th><th>Endpoint</th><th>설명</th></tr></thead>
<tbody>
<tr><td>POST</td><td>`/api/v1/avatars/resolve`</td><td>클라이언트 캐시 hash 목록 전송 → 변경분만 Signed URL 반환</td></tr>
</tbody></table>
<p>클라이언트가 보유한 `[avatarId: hash]` 목록을 서버에 전송하면, 서버가 변경된 아바타만 Signed URL과 함께 반환한다. 불필요한 URL 발급과 조회를 줄이는 최적화 방안이다.</p>
<h4>2.2.3 세션 API</h4>
<table>
<thead><tr><th>Method</th><th>Endpoint</th><th>설명</th></tr></thead>
<tbody>
<tr><td>POST</td><td>`/api/v1/sessions`</td><td>세션 생성 (joinCode 발급)</td></tr>
<tr><td>GET</td><td>`/api/v1/sessions/{joinCode}`</td><td>세션 정보 조회</td></tr>
<tr><td>POST</td><td>`/api/v1/sessions/{id}/close`</td><td>세션 종료 요청</td></tr>
</tbody></table>
<h4>2.2.4 Photon Webhook 수신</h4>
<p>Backend가 Photon으로부터 수신하는 Webhook 엔드포인트이다. Webhook Secret으로 요청 무결성을 검증한다.</p>
<table>
<thead><tr><th>Method</th><th>Endpoint</th><th>설명</th></tr></thead>
<tbody>
<tr><td>POST</td><td>`/webhook/photon/room-created`</td><td>Room 생성 이벤트 → photonRoomId 매핑 저장</td></tr>
<tr><td>POST</td><td>`/webhook/photon/room-closed`</td><td>Room 종료 이벤트 → 세션 상태 CLOSED</td></tr>
<tr><td>POST</td><td>`/webhook/photon/player-joined`</td><td>플레이어 입장 → currentParticipants 증가</td></tr>
<tr><td>POST</td><td>`/webhook/photon/player-left`</td><td>플레이어 퇴장 → currentParticipants 감소</td></tr>
</tbody></table>
<h4>2.2.5 기타 API (향후 추가 예정)</h4>
<table>
<thead><tr><th>영역</th><th>예상 엔드포인트</th><th>상태</th></tr></thead>
<tbody>
<tr><td>친구 관리</td><td>`/api/v1/friends`</td><td>📋 미설계</td></tr>
<tr><td>구독 관리</td><td>`/api/v1/subscription`</td><td>📋 미설계</td></tr>
<tr><td>Actor 설정</td><td>`/api/v1/actors`</td><td>📋 미설계</td></tr>
<tr><td>장비 프리셋</td><td>`/api/v1/presets`</td><td>📋 미설계</td></tr>
<tr><td>월드 관리</td><td>`/api/v1/worlds`</td><td>📋 미설계</td></tr>
<tr><td>테넌트 전환</td><td>`/api/v1/auth/switch-tenant`</td><td>📋 미설계</td></tr>
<tr><td>로비 통합</td><td>`/api/v1/lobby/init`</td><td>📋 미설계 (로비 진입 시 병렬 호출 최적화)</td></tr>
</tbody></table>
<hr>
<h2 id="3-설계-시-고려사항">3. 설계 시 고려사항</h2>
<h3>3.1 API 버전 관리</h3>
<p>모든 API는 `/api/v1/` 접두사를 사용하여 버전 관리한다. 호환성이 깨지는 변경 시 `/api/v2/`로 새 버전을 추가하고, 기존 버전은 일정 기간 유지한다.</p>
<h3>3.2 인증 및 권한 검증</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>인증 방식</td><td>JWT Bearer Token (Authorization 헤더)</td></tr>
<tr><td>권한 검증</td><td>JWT Payload의 role, subscriptionPlan으로 엔드포인트별 접근 제어</td></tr>
<tr><td>테넌트 격리</td><td>JWT의 tenantId로 데이터 격리 보장</td></tr>
</tbody></table>
<h3>3.3 에러 응답 형식</h3>
<table>
<thead><tr><th>필드</th><th>설명</th></tr></thead>
<tbody>
<tr><td>success</td><td>false</td></tr>
<tr><td>error.code</td><td>에러 코드 (예: AUTH_EXPIRED, FORBIDDEN)</td></tr>
<tr><td>error.message</td><td>사용자 표시용 메시지</td></tr>
</tbody></table>
<h3>3.4 Signed URL 보안</h3>
<table>
<thead><tr><th>항목</th><th>설명</th></tr></thead>
<tbody>
<tr><td>유효 기간</td><td>시간 제한 (업로드: 30분, 다운로드: 1시간 등)</td></tr>
<tr><td>단방향</td><td>업로드용 URL로 다운로드 불가, 그 반대도 불가</td></tr>
<tr><td>권한 확인</td><td>URL 발급 전 JWT로 소유권 확인</td></tr>
</tbody></table>
<hr>
<h2 id="4-엣지-케이스-및-예외-처리">4. 엣지 케이스 및 예외 처리</h2>
<table>
<thead><tr><th>상황</th><th>대응</th></tr></thead>
<tbody>
<tr><td>Access Token 만료</td><td>401 응답 → 클라이언트가 Refresh Token으로 갱신</td></tr>
<tr><td>Refresh Token 만료</td><td>401 응답 → Steam 재로그인 유도</td></tr>
<tr><td>권한 부족 (무료 플랜에서 세션 생성)</td><td>403 응답 + 업그레이드 안내</td></tr>
<tr><td>Signed URL 만료 후 업로드 시도</td><td>403 응답 → 새 URL 발급 요청 유도</td></tr>
<tr><td>Webhook Secret 불일치</td><td>401 응답 → 이벤트 무시</td></tr>
<tr><td>동시 세션 한도 초과</td><td>429 응답 → 기존 세션 종료 유도</td></tr>
</tbody></table>
<hr>
<h2 id="5-미결정-쟁점">5. 미결정 쟁점</h2>
<table>
<thead><tr><th>항목</th><th>상태</th><th>비고</th></tr></thead>
<tbody>
<tr><td>Access Token 만료 시 자동 갱신 타이밍</td><td>📋 논의 필요</td><td>만료 5분 전 자동 갱신 vs 만료 후 갱신</td></tr>
<tr><td>Resolve API 도입 시점</td><td>📋 논의 필요</td><td>MVP에서 도입 vs 이후 최적화</td></tr>
<tr><td>로비 통합 API 도입 여부</td><td>📋 논의 필요</td><td>개별 API 병렬 호출 vs 통합 API</td></tr>
<tr><td>월드 관리 API 상세 설계</td><td>📋 미설계</td><td>월드 기획 확정 후</td></tr>
<tr><td>장비 프리셋 저장 방식</td><td>📋 논의 필요</td><td>서버 저장 vs 로컬 저장</td></tr>
<tr><td>Rate Limiting 정책</td><td>📋 미설계</td><td>API별 호출 제한</td></tr>
</tbody></table>
<hr>
<h2 id="6-향후-확장-가능성">6. 향후 확장 가능성</h2>
<table>
<thead><tr><th>항목</th><th>설명</th><th>우선순위</th></tr></thead>
<tbody>
<tr><td><strong>인증/아바타/세션 API 구현</strong></td><td>서버 개발자 회의에서 확정된 핵심 API</td><td>높음</td></tr>
<tr><td><strong>Webhook 연동 구현</strong></td><td>Photon Webhook 수신 및 처리</td><td>높음</td></tr>
<tr><td><strong>친구/소셜 API</strong></td><td>친구 관리, 온라인 상태</td><td>중간</td></tr>
<tr><td><strong>구독/결제 API</strong></td><td>Stripe 연동, 구독 상태 관리</td><td>중간</td></tr>
<tr><td><strong>월드 관리 API</strong></td><td>월드 업로드/다운로드/공유</td><td>중간</td></tr>
<tr><td><strong>Resolve API</strong></td><td>아바타 캐시 최적화</td><td>낮음</td></tr>
<tr><td><strong>로비 통합 API</strong></td><td>로비 진입 시 단일 호출로 필요 데이터 수신</td><td>낮음</td></tr>
</tbody></table>
<hr>
<h2 id="관련-문서">관련 문서</h2>
<ul>
<li>기술 아키텍처</li>
<li>개발 현황</li>
<li>아바타 시스템</li>
<li>네트워크 시스템</li>
<li>보안 시스템</li>
<li>계정 시스템</li>
</ul>
        </div>
        
                </main>

                <aside class="toc-wrapper">
                    <div class="toc">
                        <div class="toc-title">📑 이 페이지</div>
                        <div id="toc-content"></div>
                    </div>
                </aside>
            </div>
        </div>
    </div>
</body>
</html>
